{
  "version": 3,
  "sources": ["browser-external:fs", "browser-external:stream", "../../@loaders.gl/loader-utils/src/lib/env-utils/assert.ts", "../../@babel/runtime/helpers/esm/typeof.js", "../../@babel/runtime/helpers/esm/toPrimitive.js", "../../@babel/runtime/helpers/esm/toPropertyKey.js", "../../@babel/runtime/helpers/esm/defineProperty.js", "../../@loaders.gl/loader-utils/node_modules/@probe.gl/stats/src/utils/hi-res-timestamp.ts", "../../@loaders.gl/loader-utils/node_modules/@probe.gl/stats/src/lib/stat.ts", "../../@loaders.gl/loader-utils/node_modules/@probe.gl/stats/src/lib/stats.ts", "../../@loaders.gl/loader-utils/src/lib/request-utils/request-scheduler.ts", "../../@loaders.gl/loader-utils/src/lib/path-utils/path.ts", "../../@loaders.gl/loader-utils/src/lib/path-utils/get-cwd.ts", "../../@loaders.gl/loader-utils/src/lib/env-utils/globals.ts", "../../@loaders.gl/loader-utils/src/lib/option-utils/merge-loader-options.ts", "../../@loaders.gl/worker-utils/src/lib/env-utils/version.ts", "../../@loaders.gl/worker-utils/src/lib/env-utils/assert.ts", "../../@loaders.gl/worker-utils/src/lib/env-utils/globals.ts", "../../@loaders.gl/worker-utils/src/lib/worker-farm/worker-job.ts", "../../@loaders.gl/worker-utils/src/lib/node/worker_threads-browser.ts", "../../@loaders.gl/worker-utils/src/lib/worker-utils/get-loadable-worker-url.ts", "../../@loaders.gl/worker-utils/src/lib/worker-utils/get-transfer-list.ts", "../../@loaders.gl/worker-utils/src/lib/worker-farm/worker-thread.ts", "../../@loaders.gl/worker-utils/src/lib/worker-farm/worker-pool.ts", "../../@loaders.gl/worker-utils/src/lib/worker-farm/worker-farm.ts", "../../@loaders.gl/worker-utils/src/lib/worker-farm/worker-body.ts", "../../@loaders.gl/worker-utils/src/lib/worker-api/get-worker-url.ts", "../../@loaders.gl/worker-utils/src/lib/async-queue/async-queue.ts", "../../@loaders.gl/worker-utils/src/lib/worker-api/validate-worker-version.ts", "../../@loaders.gl/worker-utils/src/lib/library-utils/library-utils.ts", "../../@loaders.gl/worker-utils/src/index.ts", "../../@loaders.gl/loader-utils/src/lib/worker-loader-utils/parse-with-worker.ts", "../../@loaders.gl/loader-utils/src/lib/binary-utils/get-first-characters.ts", "../../@loaders.gl/loader-utils/src/lib/parser-utils/parse-json.ts", "../../@loaders.gl/loader-utils/src/lib/binary-utils/array-buffer-utils.ts", "../../@loaders.gl/loader-utils/src/lib/binary-utils/memory-copy-utils.ts", "../../@loaders.gl/loader-utils/src/lib/binary-utils/dataview-copy-utils.ts", "../../@loaders.gl/loader-utils/src/lib/iterators/async-iteration.ts", "../../@loaders.gl/loader-utils/src/lib/path-utils/file-aliases.ts", "../../@loaders.gl/loader-utils/src/lib/node/buffer.browser.ts", "../../@loaders.gl/loader-utils/src/lib/binary-utils/memory-conversion-utils.ts", "../../@loaders.gl/loader-utils/src/lib/node/promisify.ts", "../../@loaders.gl/loader-utils/src/lib/node/fs.ts", "../../@loaders.gl/loader-utils/src/lib/node/stream.ts", "../../@loaders.gl/core/src/javascript-utils/is-type.ts", "../../@loaders.gl/core/src/lib/utils/mime-type-utils.ts", "../../@loaders.gl/core/src/lib/utils/url-utils.ts", "../../@loaders.gl/core/src/lib/utils/resource-utils.ts", "../../@loaders.gl/core/src/lib/utils/response-utils.ts", "../../@loaders.gl/core/src/lib/fetch/fetch-file.ts", "../../@loaders.gl/core/src/lib/loader-utils/normalize-loader.ts", "../../@loaders.gl/core/node_modules/@probe.gl/env/src/lib/is-electron.ts", "../../@loaders.gl/core/node_modules/@probe.gl/env/src/lib/is-browser.ts", "../../@loaders.gl/core/node_modules/@probe.gl/env/src/lib/globals.ts", "../../@loaders.gl/core/node_modules/@probe.gl/env/src/utils/globals.ts", "../../@loaders.gl/core/node_modules/@probe.gl/log/src/utils/local-storage.ts", "../../@loaders.gl/core/node_modules/@probe.gl/log/src/utils/formatters.ts", "../../@loaders.gl/core/node_modules/@probe.gl/log/src/utils/color.ts", "../../@loaders.gl/core/node_modules/@probe.gl/log/src/utils/autobind.ts", "../../@loaders.gl/core/node_modules/@probe.gl/log/src/utils/assert.ts", "../../@loaders.gl/core/node_modules/@probe.gl/log/src/utils/hi-res-timestamp.ts", "../../@loaders.gl/core/node_modules/@probe.gl/log/src/log.ts", "../../@loaders.gl/core/node_modules/@probe.gl/log/src/init.ts", "../../@loaders.gl/core/node_modules/@probe.gl/log/src/index.ts", "../../@loaders.gl/core/src/lib/loader-utils/loggers.ts", "../../@loaders.gl/core/src/lib/loader-utils/option-defaults.ts", "../../@loaders.gl/core/src/lib/loader-utils/option-utils.ts", "../../@loaders.gl/core/src/lib/api/register-loaders.ts", "../../@loaders.gl/core/src/lib/loader-utils/get-fetch-function.ts", "../../@loaders.gl/core/src/iterators/make-iterator/make-string-iterator.ts", "../../@loaders.gl/core/src/iterators/make-iterator/make-array-buffer-iterator.ts", "../../@loaders.gl/core/src/iterators/make-iterator/make-blob-iterator.ts", "../../@loaders.gl/core/src/iterators/make-iterator/make-stream-iterator.ts", "../../@loaders.gl/core/src/iterators/make-iterator/make-iterator.ts", "../../@loaders.gl/core/src/lib/loader-utils/get-data.ts", "../../@loaders.gl/core/src/lib/loader-utils/loader-context.ts", "../../@loaders.gl/core/src/lib/utils/log.ts", "../../@loaders.gl/core/src/lib/api/select-loader.ts", "../../@loaders.gl/core/src/lib/api/parse.ts", "../../@loaders.gl/core/src/lib/api/load.ts", "../../@loaders.gl/images/src/lib/utils/version.ts", "../../@loaders.gl/images/src/lib/category-api/image-type.ts", "../../@loaders.gl/images/src/lib/category-api/parsed-image-api.ts", "../../@loaders.gl/images/src/lib/parsers/svg-utils.ts", "../../@loaders.gl/images/src/lib/parsers/parse-to-image.ts", "../../@loaders.gl/images/src/lib/parsers/parse-to-image-bitmap.ts", "../../@loaders.gl/images/src/lib/category-api/parse-isobmff-binary.ts", "../../@loaders.gl/images/src/lib/category-api/binary-image-api.ts", "../../@loaders.gl/images/src/lib/parsers/parse-to-node-image.ts", "../../@loaders.gl/images/src/lib/parsers/parse-image.ts", "../../@loaders.gl/images/src/image-loader.ts", "../../@loaders.gl/images/src/lib/encoders/encode-image.ts", "../../@loaders.gl/images/src/lib/category-api/image-format.ts", "../../@math.gl/core/src/lib/assert.ts", "../../@math.gl/core/src/lib/common.ts", "../../gl-matrix/esm/common.js", "../../gl-matrix/esm/vec2.js", "../../gl-matrix/esm/vec3.js", "../../@math.gl/core/src/classes/base/math-array.ts", "../../@math.gl/core/src/lib/validators.ts", "../../@math.gl/core/src/classes/base/vector.ts", "../../@math.gl/core/src/lib/gl-matrix-extras.ts", "../../@math.gl/core/src/classes/vector3.ts", "../../gl-matrix/esm/mat4.js", "../../gl-matrix/esm/vec4.js", "../../@math.gl/core/src/classes/base/matrix.ts", "../../@math.gl/core/src/classes/matrix4.ts", "../../@math.gl/core/src/classes/spherical-coordinates.ts", "../../@math.gl/core/src/classes/vector2.ts", "../../@math.gl/core/src/classes/vector4.ts", "../../gl-matrix/esm/mat3.js", "../../@math.gl/core/src/classes/matrix3.ts", "../../gl-matrix/esm/quat.js", "../../@math.gl/core/src/classes/quaternion.ts", "../../@math.gl/core/src/classes/euler.ts", "../../@math.gl/core/src/lib/math-utils.ts"],
  "sourcesContent": ["module.exports = Object.create(new Proxy({}, {\n  get(_, key) {\n    if (\n      key !== '__esModule' &&\n      key !== '__proto__' &&\n      key !== 'constructor' &&\n      key !== 'splice'\n    ) {\n      console.warn(`Module \"fs\" has been externalized for browser compatibility. Cannot access \"fs.${key}\" in client code. See http://vitejs.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)\n    }\n  }\n}))", "module.exports = Object.create(new Proxy({}, {\n  get(_, key) {\n    if (\n      key !== '__esModule' &&\n      key !== '__proto__' &&\n      key !== 'constructor' &&\n      key !== 'splice'\n    ) {\n      console.warn(`Module \"stream\" has been externalized for browser compatibility. Cannot access \"stream.${key}\" in client code. See http://vitejs.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)\n    }\n  }\n}))", "/**\n * Throws an `Error` with the optional `message` if `condition` is falsy\n * @note Replacement for the external assert method to reduce bundle size\n */\nexport function assert(condition: any, message?: string): void {\n  if (!condition) {\n    throw new Error(message || 'loader assertion failed.');\n  }\n}\n", "export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}", "import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}", "import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}", "import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}", "// Copyright (c) 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nexport default function getHiResTimestamp(): number {\n  let timestamp;\n  // Get best timer available.\n  if (typeof window !== 'undefined' && window.performance) {\n    timestamp = window.performance.now();\n  } else if (typeof process !== 'undefined' && process.hrtime) {\n    const timeParts = process.hrtime();\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n", "import getHiResTimestamp from '../utils/hi-res-timestamp';\n\nexport default class Stat {\n  readonly name: string;\n  readonly type: string | undefined;\n  sampleSize: number = 1;\n  time: number = 0;\n  count: number = 0;\n  samples: number = 0;\n  lastTiming: number = 0;\n  lastSampleTime: number = 0;\n  lastSampleCount: number = 0;\n\n  _count: number = 0;\n  _time: number = 0;\n  _samples: number = 0;\n  _startTime: number = 0;\n  _timerPending: boolean = false;\n\n  constructor(name: string, type?: string) {\n    this.name = name;\n    this.type = type;\n    this.reset();\n  }\n\n  reset(): this {\n    this.time = 0;\n    this.count = 0;\n    this.samples = 0;\n    this.lastTiming = 0;\n    this.lastSampleTime = 0;\n    this.lastSampleCount = 0;\n    this._count = 0;\n    this._time = 0;\n    this._samples = 0;\n    this._startTime = 0;\n    this._timerPending = false;\n\n    return this;\n  }\n\n  setSampleSize(samples: number): this {\n    this.sampleSize = samples;\n    return this;\n  }\n\n  /** Call to increment count (+1) */\n  incrementCount(): this {\n    this.addCount(1);\n\n    return this;\n  }\n\n  /** Call to decrement count (-1) */\n  decrementCount(): this {\n    this.subtractCount(1);\n\n    return this;\n  }\n\n  /** Increase count */\n  addCount(value: number): this {\n    this._count += value;\n    this._samples++;\n    this._checkSampling();\n\n    return this;\n  }\n\n  /** Decrease count */\n  subtractCount(value: number): this {\n    this._count -= value;\n    this._samples++;\n    this._checkSampling();\n\n    return this;\n  }\n\n  /** Add an arbitrary timing and bump the count */\n  addTime(time: number): this {\n    this._time += time;\n    this.lastTiming = time;\n    this._samples++;\n    this._checkSampling();\n\n    return this;\n  }\n\n  /** Start a timer */\n  timeStart(): this {\n    this._startTime = getHiResTimestamp();\n    this._timerPending = true;\n\n    return this;\n  }\n\n  /** End a timer. Adds to time and bumps the timing count. */\n  timeEnd(): this {\n    if (!this._timerPending) {\n      return this;\n    }\n    this.addTime(getHiResTimestamp() - this._startTime);\n    this._timerPending = false;\n    this._checkSampling();\n\n    return this;\n  }\n\n  getSampleAverageCount(): number {\n    return this.sampleSize > 0 ? this.lastSampleCount / this.sampleSize : 0;\n  }\n\n  /** Calculate average time / count for the previous window */\n  getSampleAverageTime(): number {\n    return this.sampleSize > 0 ? this.lastSampleTime / this.sampleSize : 0;\n  }\n\n  /** Calculate counts per second for the previous window */\n  getSampleHz(): number {\n    return this.lastSampleTime > 0 ? this.sampleSize / (this.lastSampleTime / 1000) : 0;\n  }\n\n  getAverageCount(): number {\n    return this.samples > 0 ? this.count / this.samples : 0;\n  }\n\n  /** Calculate average time / count */\n  getAverageTime(): number {\n    return this.samples > 0 ? this.time / this.samples : 0;\n  }\n\n  /** Calculate counts per second */\n  getHz(): number {\n    return this.time > 0 ? this.samples / (this.time / 1000) : 0;\n  }\n\n  _checkSampling(): void {\n    if (this._samples === this.sampleSize) {\n      this.lastSampleTime = this._time;\n      this.lastSampleCount = this._count;\n      this.count += this._count;\n      this.time += this._time;\n      this.samples += this._samples;\n      this._time = 0;\n      this._count = 0;\n      this._samples = 0;\n    }\n  }\n}\n", "// probe.gl, MIT license\n\nimport Stat from './stat';\n\ntype TableEntry = {\n  time: number;\n  count: number;\n  average: number;\n  hz: number;\n};\n\n/** A \"bag\" of `Stat` objects, can be visualized using `StatsWidget` */\nexport default class Stats {\n  readonly id: string;\n  readonly stats: Record<string, Stat> = {};\n\n  constructor(options: {id: string; stats?: Stats | Stat[] | {name: string; type?: string}[]}) {\n    this.id = options.id;\n    this.stats = {};\n\n    this._initializeStats(options.stats);\n\n    Object.seal(this);\n  }\n\n  /** Acquire a stat. Create if it doesn't exist. */\n  get(name: string, type: string = 'count'): Stat {\n    return this._getOrCreate({name, type});\n  }\n\n  get size(): number {\n    return Object.keys(this.stats).length;\n  }\n\n  /** Reset all stats */\n  reset(): this {\n    for (const stat of Object.values(this.stats)) {\n      stat.reset();\n    }\n\n    return this;\n  }\n\n  forEach(fn: (stat: Stat) => void): void {\n    for (const stat of Object.values(this.stats)) {\n      fn(stat);\n    }\n  }\n\n  getTable(): Record<string, TableEntry> {\n    const table: Record<string, TableEntry> = {};\n    this.forEach(stat => {\n      table[stat.name] = {\n        time: stat.time || 0,\n        count: stat.count || 0,\n        average: stat.getAverageTime() || 0,\n        hz: stat.getHz() || 0\n      };\n    });\n\n    return table;\n  }\n\n  _initializeStats(stats: Stats | Stat[] | {name: string; type?: string}[] = []): void {\n    stats.forEach(stat => this._getOrCreate(stat));\n  }\n\n  _getOrCreate(stat: Stat | {name: string, type?: string}): Stat {\n    const {name, type} = stat;\n    let result = this.stats[name];\n    if (!result) {\n      if (stat instanceof Stat) {\n        result = stat;\n      } else {\n        result = new Stat(name, type);\n      }\n      this.stats[name] = result;\n    }\n    return result;\n  }\n}\n", "import {Stats} from '@probe.gl/stats';\n\ntype Handle = any;\ntype DoneFunction = () => any;\ntype GetPriorityFunction = () => number;\ntype RequestResult = {\n  done: DoneFunction;\n} | null;\n\n/** RequestScheduler Options */\nexport type RequestSchedulerProps = {\n  id?: string;\n  throttleRequests?: boolean;\n  maxRequests?: number;\n};\n\nconst STAT_QUEUED_REQUESTS = 'Queued Requests';\nconst STAT_ACTIVE_REQUESTS = 'Active Requests';\nconst STAT_CANCELLED_REQUESTS = 'Cancelled Requests';\nconst STAT_QUEUED_REQUESTS_EVER = 'Queued Requests Ever';\nconst STAT_ACTIVE_REQUESTS_EVER = 'Active Requests Ever';\n\nconst DEFAULT_PROPS: Required<RequestSchedulerProps> = {\n  id: 'request-scheduler',\n  // Specifies if the request scheduler should throttle incoming requests, mainly for comparative testing\n  throttleRequests: true,\n  // The maximum number of simultaneous active requests. Un-throttled requests do not observe this limit.\n  maxRequests: 6\n};\n\n/** Tracks one request */\ntype Request = {\n  handle: Handle;\n  priority: number;\n  getPriority: GetPriorityFunction;\n  resolve?: (value: any) => any;\n};\n\n/**\n * Used to issue a request, without having them \"deeply queued\" by the browser.\n * @todo - Track requests globally, across multiple servers\n */\nexport default class RequestScheduler {\n  readonly props: Required<RequestSchedulerProps>;\n  readonly stats: Stats;\n  activeRequestCount: number = 0;\n\n  /** Tracks the number of active requests and prioritizes/cancels queued requests. */\n  private requestQueue: Request[] = [];\n  private requestMap: Map<Handle, Promise<RequestResult>> = new Map();\n  private deferredUpdate: any = null;\n\n  constructor(props: RequestSchedulerProps = {}) {\n    this.props = {...DEFAULT_PROPS, ...props};\n\n    // Returns the statistics used by the request scheduler.\n    this.stats = new Stats({id: this.props.id});\n    this.stats.get(STAT_QUEUED_REQUESTS);\n    this.stats.get(STAT_ACTIVE_REQUESTS);\n    this.stats.get(STAT_CANCELLED_REQUESTS);\n    this.stats.get(STAT_QUEUED_REQUESTS_EVER);\n    this.stats.get(STAT_ACTIVE_REQUESTS_EVER);\n  }\n\n  /**\n   * Called by an application that wants to issue a request, without having it deeply queued by the browser\n   *\n   * When the returned promise resolved, it is OK for the application to issue a request.\n   * The promise resolves to an object that contains a `done` method.\n   * When the application's request has completed (or failed), the application must call the `done` function\n   *\n   * @param handle\n   * @param getPriority will be called when request \"slots\" open up,\n   *    allowing the caller to update priority or cancel the request\n   *    Highest priority executes first, priority < 0 cancels the request\n   * @returns a promise\n   *   - resolves to a object (with a `done` field) when the request can be issued without queueing,\n   *   - resolves to `null` if the request has been cancelled (by the callback return < 0).\n   *     In this case the application should not issue the request\n   */\n  scheduleRequest(\n    handle: Handle,\n    getPriority: GetPriorityFunction = () => 0\n  ): Promise<RequestResult> {\n    // Allows throttling to be disabled\n    if (!this.props.throttleRequests) {\n      return Promise.resolve({done: () => {}});\n    }\n\n    // dedupe\n    if (this.requestMap.has(handle)) {\n      return this.requestMap.get(handle) as Promise<any>;\n    }\n\n    const request: Request = {handle, priority: 0, getPriority};\n    const promise = new Promise<RequestResult>((resolve) => {\n      // @ts-ignore\n      request.resolve = resolve;\n      return request;\n    });\n\n    this.requestQueue.push(request);\n    this.requestMap.set(handle, promise);\n    this._issueNewRequests();\n    return promise;\n  }\n\n  // PRIVATE\n\n  _issueRequest(request: Request): Promise<any> {\n    const {handle, resolve} = request;\n    let isDone = false;\n\n    const done = () => {\n      // can only be called once\n      if (!isDone) {\n        isDone = true;\n\n        // Stop tracking a request - it has completed, failed, cancelled etc\n        this.requestMap.delete(handle);\n        this.activeRequestCount--;\n        // A slot just freed up, see if any queued requests are waiting\n        this._issueNewRequests();\n      }\n    };\n\n    // Track this request\n    this.activeRequestCount++;\n\n    return resolve ? resolve({done}) : Promise.resolve({done});\n  }\n\n  /** We check requests asynchronously, to prevent multiple updates */\n  _issueNewRequests(): void {\n    if (!this.deferredUpdate) {\n      this.deferredUpdate = setTimeout(() => this._issueNewRequestsAsync(), 0);\n    }\n  }\n\n  /** Refresh all requests  */\n  _issueNewRequestsAsync() {\n    // TODO - shouldn't we clear the timeout?\n    this.deferredUpdate = null;\n\n    const freeSlots = Math.max(this.props.maxRequests - this.activeRequestCount, 0);\n\n    if (freeSlots === 0) {\n      return;\n    }\n\n    this._updateAllRequests();\n\n    // Resolve pending promises for the top-priority requests\n    for (let i = 0; i < freeSlots; ++i) {\n      const request = this.requestQueue.shift();\n      if (request) {\n        this._issueRequest(request); // eslint-disable-line @typescript-eslint/no-floating-promises\n      }\n    }\n\n    // Uncomment to debug\n    // console.log(`${freeSlots} free slots, ${this.requestQueue.length} queued requests`);\n  }\n\n  /** Ensure all requests have updated priorities, and that no longer valid requests are cancelled */\n  _updateAllRequests() {\n    const requestQueue = this.requestQueue;\n    for (let i = 0; i < requestQueue.length; ++i) {\n      const request = requestQueue[i];\n      if (!this._updateRequest(request)) {\n        // Remove the element and make sure to adjust the counter to account for shortened array\n        requestQueue.splice(i, 1);\n        this.requestMap.delete(request.handle);\n        i--;\n      }\n    }\n\n    // Sort the remaining requests based on priority\n    requestQueue.sort((a, b) => a.priority - b.priority);\n  }\n\n  /** Update a single request by calling the callback */\n  _updateRequest(request) {\n    request.priority = request.getPriority(request.handle); // eslint-disable-line callback-return\n\n    // by returning a negative priority, the callback cancels the request\n    if (request.priority < 0) {\n      request.resolve(null);\n      return false;\n    }\n    return true;\n  }\n}\n", "// Beginning of a minimal implementation of the Node.js path API, that doesn't pull in big polyfills.\n\nimport {getCWD} from './get-cwd';\n\n/**\n * Replacement for Node.js path.filename\n * @param url\n */\nexport function filename(url: string): string {\n  const slashIndex = url ? url.lastIndexOf('/') : -1;\n  return slashIndex >= 0 ? url.substr(slashIndex + 1) : '';\n}\n\n/**\n * Replacement for Node.js path.dirname\n * @param url\n */\nexport function dirname(url: string): string {\n  const slashIndex = url ? url.lastIndexOf('/') : -1;\n  return slashIndex >= 0 ? url.substr(0, slashIndex) : '';\n}\n\n/**\n * Replacement for Node.js path.join\n * @param parts\n */\nexport function join(...parts: string[]): string {\n  const separator = '/';\n  parts = parts.map((part, index) => {\n    if (index) {\n      part = part.replace(new RegExp(`^${separator}`), '');\n    }\n    if (index !== parts.length - 1) {\n      part = part.replace(new RegExp(`${separator}$`), '');\n    }\n    return part;\n  });\n  return parts.join(separator);\n}\n\n/* eslint-disable no-continue */\n\n/**\n * https://nodejs.org/api/path.html#path_path_resolve_paths\n * @param paths A sequence of paths or path segments.\n * @return resolved path\n * Forked from BTOdell/path-resolve under MIT license\n * @see https://github.com/BTOdell/path-resolve/blob/master/LICENSE\n */\nexport function resolve(...components: string[]): string {\n  const paths: string[] = [];\n  for (let _i = 0; _i < components.length; _i++) {\n    paths[_i] = components[_i];\n  }\n  let resolvedPath = '';\n  let resolvedAbsolute = false;\n  let cwd: string | undefined;\n  for (let i = paths.length - 1; i >= -1 && !resolvedAbsolute; i--) {\n    let path: string | undefined;\n    if (i >= 0) {\n      path = paths[i];\n    } else {\n      if (cwd === undefined) {\n        cwd = getCWD();\n      }\n      path = cwd;\n    }\n    // Skip empty entries\n    if (path.length === 0) {\n      continue;\n    }\n    resolvedPath = `${path}/${resolvedPath}`;\n    resolvedAbsolute = path.charCodeAt(0) === SLASH;\n  }\n  // At this point the path should be resolved to a full absolute path, but\n  // handle relative paths to be safe (might happen when process.cwd() fails)\n  // Normalize the path (removes leading slash)\n  resolvedPath = normalizeStringPosix(resolvedPath, !resolvedAbsolute);\n  if (resolvedAbsolute) {\n    return `/${resolvedPath}`;\n  } else if (resolvedPath.length > 0) {\n    return resolvedPath;\n  }\n  return '.';\n}\n\nconst SLASH = 47;\nconst DOT = 46;\n\n/**\n * Resolves . and .. elements in a path with directory names\n * Forked from BTOdell/path-resolve under MIT license\n * @see https://github.com/BTOdell/path-resolve/blob/master/LICENSE\n */\n/* eslint-disable max-depth */\n// eslint-disable-next-line complexity, max-statements\nfunction normalizeStringPosix(path: string, allowAboveRoot: boolean): string {\n  let res = '';\n  let lastSlash = -1;\n  let dots = 0;\n  let code: number | undefined;\n  let isAboveRoot = false;\n\n  for (let i = 0; i <= path.length; ++i) {\n    if (i < path.length) {\n      code = path.charCodeAt(i);\n    } else if (code === SLASH) {\n      break;\n    } else {\n      code = SLASH;\n    }\n    if (code === SLASH) {\n      if (lastSlash === i - 1 || dots === 1) {\n        // NOOP\n      } else if (lastSlash !== i - 1 && dots === 2) {\n        if (\n          res.length < 2 ||\n          !isAboveRoot ||\n          res.charCodeAt(res.length - 1) !== DOT ||\n          res.charCodeAt(res.length - 2) !== DOT\n        ) {\n          if (res.length > 2) {\n            const start = res.length - 1;\n            let j = start;\n            for (; j >= 0; --j) {\n              if (res.charCodeAt(j) === SLASH) {\n                break;\n              }\n            }\n            if (j !== start) {\n              res = j === -1 ? '' : res.slice(0, j);\n              lastSlash = i;\n              dots = 0;\n              isAboveRoot = false;\n              continue;\n            }\n          } else if (res.length === 2 || res.length === 1) {\n            res = '';\n            lastSlash = i;\n            dots = 0;\n            isAboveRoot = false;\n            continue;\n          }\n        }\n        if (allowAboveRoot) {\n          if (res.length > 0) {\n            res += '/..';\n          } else {\n            res = '..';\n          }\n          isAboveRoot = true;\n        }\n      } else {\n        const slice = path.slice(lastSlash + 1, i);\n        if (res.length > 0) {\n          res += `/${slice}`;\n        } else {\n          res = slice;\n        }\n        isAboveRoot = false;\n      }\n      lastSlash = i;\n      dots = 0;\n    } else if (code === DOT && dots !== -1) {\n      ++dots;\n    } else {\n      dots = -1;\n    }\n  }\n  return res;\n}\n", "// loaders.gl MIT license\n\nexport function getCWD() {\n  if (typeof process !== 'undefined' && typeof process.cwd !== 'undefined') {\n    return process.cwd();\n  }\n  const pathname = window.location?.pathname;\n  return pathname?.slice(0, pathname.lastIndexOf('/') + 1) || '';\n}\n", "// Purpose: include this in your module to avoid\n// dependencies on micro modules like 'global' and 'is-browser';\n\n/* eslint-disable no-restricted-globals */\nconst globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\n\ntype obj = {[key: string]: any};\nconst self_: obj = globals.self || globals.window || globals.global || {};\nconst window_: obj = globals.window || globals.self || globals.global || {};\nconst global_: obj = globals.global || globals.self || globals.window || {};\nconst document_: obj = globals.document || {};\n\nexport {self_ as self, window_ as window, global_ as global, document_ as document};\n\n/** true if running in a browser */\nexport const isBrowser: boolean =\n  // @ts-ignore process does not exist on browser\n  Boolean(typeof process !== 'object' || String(process) !== '[object process]' || process.browser);\n\n/** true if running in a worker thread */\nexport const isWorker: boolean = typeof importScripts === 'function';\n\n// Extract node major version\nconst matches =\n  typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\n/** Major Node version (as a number) */\nexport const nodeVersion: number = (matches && parseFloat(matches[1])) || 0;\n", "// loaders.gl, MIT license\n\nimport {LoaderOptions} from '../../types';\n\n/**\n *\n * @param baseOptions Can be undefined, in which case a fresh options object will be minted\n * @param newOptions\n * @returns\n */\nexport function mergeLoaderOptions<Options extends LoaderOptions>(\n  baseOptions: Options | undefined,\n  newOptions: Options\n): Options {\n  const options = {...baseOptions};\n  for (const [key, newValue] of Object.entries(newOptions)) {\n    if (newValue && typeof newValue === 'object') {\n      options[key] = options[key] || {};\n      Object.assign(options[key] as object, newOptions[key]);\n    } else {\n      options[key] = newOptions[key];\n    }\n  }\n  return options as Options;\n}\n", "// Version constant cannot be imported, it needs to correspond to the build version of **this** module.\n// __VERSION__ is injected by babel-plugin-version-inline\n\n// Change to `latest` on production branches\nconst DEFAULT_VERSION = 'latest';\ndeclare let __VERSION__: string;\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : DEFAULT_VERSION;\nif (typeof __VERSION__ === 'undefined') {\n  // eslint-disable-next-line\n  console.error(\n    'loaders.gl: The __VERSION__ variable is not injected using babel plugin. Latest unstable workers would be fetched from the CDN.'\n  );\n}\n", "// Replacement for the external assert method to reduce bundle size\n// Note: We don't use the second \"message\" argument in calling code,\n// so no need to support it here\n\n/** Throws an `Error` with the optional `message` if `condition` is falsy */\nexport function assert(condition: any, message?: string): void {\n  if (!condition) {\n    throw new Error(message || 'loaders.gl assertion failed.');\n  }\n}\n", "// Purpose: include this in your module to avoids adding dependencies on\n// micro modules like 'global' and 'is-browser';\n\n/* eslint-disable no-restricted-globals */\nconst globals = {\n  self: typeof self !== 'undefined' && self,\n  window: typeof window !== 'undefined' && window,\n  global: typeof global !== 'undefined' && global,\n  document: typeof document !== 'undefined' && document\n};\n\nconst self_: {[key: string]: any} = globals.self || globals.window || globals.global || {};\nconst window_: {[key: string]: any} = globals.window || globals.self || globals.global || {};\nconst global_: {[key: string]: any} = globals.global || globals.self || globals.window || {};\nconst document_: {[key: string]: any} = globals.document || {};\n\nexport {self_ as self, window_ as window, global_ as global, document_ as document};\n\n/** true if running in the browser, false if running in Node.js */\nexport const isBrowser: boolean =\n  // @ts-ignore process.browser\n  typeof process !== 'object' || String(process) !== '[object process]' || process.browser;\n\n/** true if running on a worker thread */\nexport const isWorker: boolean = typeof importScripts === 'function';\n\n/** true if running on a mobile device */\nexport const isMobile: boolean =\n  typeof window !== 'undefined' && typeof window.orientation !== 'undefined';\n\n// Extract node major version\nconst matches =\n  typeof process !== 'undefined' && process.version && /v([0-9]*)/.exec(process.version);\n\n/** Version of Node.js if running under Node, otherwise 0 */\nexport const nodeVersion: number = (matches && parseFloat(matches[1])) || 0;\n", "import type {WorkerMessageType, WorkerMessagePayload} from '../../types';\nimport WorkerThread from './worker-thread';\nimport {assert} from '../env-utils/assert';\n\n/**\n * Represents one Job handled by a WorkerPool or WorkerFarm\n */\nexport default class WorkerJob {\n  readonly name: string;\n  readonly workerThread: WorkerThread;\n  isRunning: boolean = true;\n  /** Promise that resolves when Job is done */\n  readonly result: Promise<any>;\n\n  private _resolve: (value: any) => void = () => {};\n  private _reject: (reason?: any) => void = () => {};\n\n  constructor(jobName: string, workerThread: WorkerThread) {\n    this.name = jobName;\n    this.workerThread = workerThread;\n    this.result = new Promise((resolve, reject) => {\n      this._resolve = resolve;\n      this._reject = reject;\n    });\n  }\n\n  /**\n   * Send a message to the job's worker thread\n   * @param data any data structure, ideally consisting mostly of transferrable objects\n   */\n  postMessage(type: WorkerMessageType, payload: WorkerMessagePayload): void {\n    this.workerThread.postMessage({\n      source: 'loaders.gl', // Lets worker ignore unrelated messages\n      type,\n      payload\n    });\n  }\n\n  /**\n   * Call to resolve the `result` Promise with the supplied value\n   */\n  done(value: any): void {\n    assert(this.isRunning);\n    this.isRunning = false;\n    this._resolve(value);\n  }\n\n  /**\n   * Call to reject the `result` Promise with the supplied error\n   */\n  error(error: Error): void {\n    assert(this.isRunning);\n    this.isRunning = false;\n    this._reject(error);\n  }\n}\n", "// Browser fills for Node.js built-in `worker_threads` module.\n// These fills are non-functional, and just intended to ensure that\n// `import 'worker_threads` doesn't break browser builds.\n// The replacement is done in package.json browser field\nexport class Worker {\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  terminate() {}\n}\n\nexport {Worker as NodeWorker};\nexport {Worker as NodeWorkerType};\n\nexport const parentPort = null;\n", "import {assert} from '../env-utils/assert';\n\nconst workerURLCache = new Map();\n\n/**\n * Creates a loadable URL from worker source or URL\n * that can be used to create `Worker` instances.\n * Due to CORS issues it may be necessary to wrap a URL in a small importScripts\n * @param props\n * @param props.source Worker source\n * @param props.url Worker URL\n * @returns loadable url\n */\nexport function getLoadableWorkerURL(props: {source?: string; url?: string}) {\n  assert((props.source && !props.url) || (!props.source && props.url)); // Either source or url must be defined\n\n  let workerURL = workerURLCache.get(props.source || props.url);\n  if (!workerURL) {\n    // Differentiate worker urls from worker source code\n    if (props.url) {\n      workerURL = getLoadableWorkerURLFromURL(props.url);\n      workerURLCache.set(props.url, workerURL);\n    }\n\n    if (props.source) {\n      workerURL = getLoadableWorkerURLFromSource(props.source);\n      workerURLCache.set(props.source, workerURL);\n    }\n  }\n\n  assert(workerURL);\n  return workerURL;\n}\n\n/**\n * Build a loadable worker URL from worker URL\n * @param url\n * @returns loadable URL\n */\nfunction getLoadableWorkerURLFromURL(url: string): string {\n  // A local script url, we can use it to initialize a Worker directly\n  if (!url.startsWith('http')) {\n    return url;\n  }\n\n  // A remote script, we need to use `importScripts` to load from different origin\n  const workerSource = buildScriptSource(url);\n  return getLoadableWorkerURLFromSource(workerSource);\n}\n\n/**\n * Build a loadable worker URL from worker source\n * @param workerSource\n * @returns loadable url\n */\nfunction getLoadableWorkerURLFromSource(workerSource: string): string {\n  const blob = new Blob([workerSource], {type: 'application/javascript'});\n  return URL.createObjectURL(blob);\n}\n\n/**\n * Per spec, worker cannot be initialized with a script from a different origin\n * However a local worker script can still import scripts from other origins,\n * so we simply build a wrapper script.\n *\n * @param workerUrl\n * @returns source\n */\nfunction buildScriptSource(workerUrl: string): string {\n  return `\\\ntry {\n  importScripts('${workerUrl}');\n} catch (error) {\n  console.error(error);\n  throw error;\n}`;\n}\n", "// NOTE - there is a copy of this function is both in core and loader-utils\n// core does not need all the utils in loader-utils, just this one.\n\n/**\n * Returns an array of Transferrable objects that can be used with postMessage\n * https://developer.mozilla.org/en-US/docs/Web/API/Worker/postMessage\n * @param object data to be sent via postMessage\n * @param recursive - not for application use\n * @param transfers - not for application use\n * @returns a transfer list that can be passed to postMessage\n */\nexport function getTransferList(\n  object: any,\n  recursive: boolean = true,\n  transfers?: Set<any>\n): Transferable[] {\n  // Make sure that items in the transfer list is unique\n  const transfersSet = transfers || new Set();\n\n  if (!object) {\n    // ignore\n  } else if (isTransferable(object)) {\n    transfersSet.add(object);\n  } else if (isTransferable(object.buffer)) {\n    // Typed array\n    transfersSet.add(object.buffer);\n  } else if (ArrayBuffer.isView(object)) {\n    // object is a TypeArray viewing into a SharedArrayBuffer (not transferable)\n    // Do not iterate through the content in this case\n  } else if (recursive && typeof object === 'object') {\n    for (const key in object) {\n      // Avoid perf hit - only go one level deep\n      getTransferList(object[key], recursive, transfersSet);\n    }\n  }\n\n  // If transfers is defined, is internal recursive call\n  // Otherwise it's called by the user\n  return transfers === undefined ? Array.from(transfersSet) : [];\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/API/Transferable\nfunction isTransferable(object: unknown) {\n  if (!object) {\n    return false;\n  }\n  if (object instanceof ArrayBuffer) {\n    return true;\n  }\n  if (typeof MessagePort !== 'undefined' && object instanceof MessagePort) {\n    return true;\n  }\n  if (typeof ImageBitmap !== 'undefined' && object instanceof ImageBitmap) {\n    return true;\n  }\n  // @ts-ignore\n  if (typeof OffscreenCanvas !== 'undefined' && object instanceof OffscreenCanvas) {\n    return true;\n  }\n  return false;\n}\n\n/**\n * Recursively drop non serializable values like functions and regexps.\n * @param object\n */\nexport function getTransferListForWriter(object: object | null): object {\n  if (object === null) {\n    return {};\n  }\n  const clone = Object.assign({}, object);\n\n  Object.keys(clone).forEach((key) => {\n    // Typed Arrays and Arrays are passed with no change\n    if (\n      typeof object[key] === 'object' &&\n      !ArrayBuffer.isView(object[key]) &&\n      !(object[key] instanceof Array)\n    ) {\n      clone[key] = getTransferListForWriter(object[key]);\n    } else if (typeof clone[key] === 'function' || clone[key] instanceof RegExp) {\n      clone[key] = {};\n    } else {\n      clone[key] = object[key];\n    }\n  });\n\n  return clone;\n}\n", "// loaders.gl, MIT license\n\nimport {NodeWorker, NodeWorkerType} from '../node/worker_threads';\nimport {isBrowser} from '../env-utils/globals';\nimport {assert} from '../env-utils/assert';\nimport {getLoadableWorkerURL} from '../worker-utils/get-loadable-worker-url';\nimport {getTransferList} from '../worker-utils/get-transfer-list';\n\nconst NOOP = () => {};\n\nexport type WorkerThreadProps = {\n  name: string;\n  source?: string;\n  url?: string;\n};\n\n/**\n * Represents one worker thread\n */\nexport default class WorkerThread {\n  readonly name: string;\n  readonly source: string | undefined;\n  readonly url: string | undefined;\n  terminated: boolean = false;\n  worker: Worker | NodeWorkerType;\n  onMessage: (message: any) => void;\n  onError: (error: Error) => void;\n\n  private _loadableURL: string = '';\n\n  /** Checks if workers are supported on this platform */\n  static isSupported(): boolean {\n    return (\n      (typeof Worker !== 'undefined' && isBrowser) ||\n      (typeof NodeWorker !== 'undefined' && !isBrowser)\n    );\n  }\n\n  constructor(props: WorkerThreadProps) {\n    const {name, source, url} = props;\n    assert(source || url); // Either source or url must be defined\n    this.name = name;\n    this.source = source;\n    this.url = url;\n    this.onMessage = NOOP;\n    this.onError = (error) => console.log(error); // eslint-disable-line\n\n    this.worker = isBrowser ? this._createBrowserWorker() : this._createNodeWorker();\n  }\n\n  /**\n   * Terminate this worker thread\n   * @note Can free up significant memory\n   */\n  destroy(): void {\n    this.onMessage = NOOP;\n    this.onError = NOOP;\n    this.worker.terminate(); // eslint-disable-line @typescript-eslint/no-floating-promises\n    this.terminated = true;\n  }\n\n  get isRunning() {\n    return Boolean(this.onMessage);\n  }\n\n  /**\n   * Send a message to this worker thread\n   * @param data any data structure, ideally consisting mostly of transferrable objects\n   * @param transferList If not supplied, calculated automatically by traversing data\n   */\n  postMessage(data: any, transferList?: any[]): void {\n    transferList = transferList || getTransferList(data);\n    // @ts-ignore\n    this.worker.postMessage(data, transferList);\n  }\n\n  // PRIVATE\n\n  /**\n   * Generate a standard Error from an ErrorEvent\n   * @param event\n   */\n  _getErrorFromErrorEvent(event: ErrorEvent): Error {\n    // Note Error object does not have the expected fields if loading failed completely\n    // https://developer.mozilla.org/en-US/docs/Web/API/Worker#Event_handlers\n    // https://developer.mozilla.org/en-US/docs/Web/API/ErrorEvent\n    let message = 'Failed to load ';\n    message += `worker ${this.name} from ${this.url}. `;\n    if (event.message) {\n      message += `${event.message} in `;\n    }\n    // const hasFilename = event.filename && !event.filename.startsWith('blob:');\n    // message += hasFilename ? event.filename : this.source.slice(0, 100);\n    if (event.lineno) {\n      message += `:${event.lineno}:${event.colno}`;\n    }\n    return new Error(message);\n  }\n\n  /**\n   * Creates a worker thread on the browser\n   */\n  _createBrowserWorker(): Worker {\n    this._loadableURL = getLoadableWorkerURL({source: this.source, url: this.url});\n    const worker = new Worker(this._loadableURL, {name: this.name});\n\n    worker.onmessage = (event) => {\n      if (!event.data) {\n        this.onError(new Error('No data received'));\n      } else {\n        this.onMessage(event.data);\n      }\n    };\n    // This callback represents an uncaught exception in the worker thread\n    worker.onerror = (error: ErrorEvent): void => {\n      this.onError(this._getErrorFromErrorEvent(error));\n      this.terminated = true;\n    };\n    // TODO - not clear when this would be called, for now just log in case it happens\n    worker.onmessageerror = (event) => console.error(event); // eslint-disable-line\n\n    return worker;\n  }\n\n  /**\n   * Creates a worker thread in node.js\n   * @todo https://nodejs.org/api/async_hooks.html#async-resource-worker-pool\n   */\n  _createNodeWorker(): NodeWorkerType {\n    let worker: NodeWorkerType;\n    if (this.url) {\n      // Make sure relative URLs start with './'\n      const absolute = this.url.includes(':/') || this.url.startsWith('/');\n      const url = absolute ? this.url : `./${this.url}`;\n      // console.log('Starting work from', url);\n      worker = new NodeWorker(url, {eval: false});\n    } else if (this.source) {\n      worker = new NodeWorker(this.source, {eval: true});\n    } else {\n      throw new Error('no worker');\n    }\n    worker.on('message', (data) => {\n      // console.error('message', data);\n      this.onMessage(data);\n    });\n    worker.on('error', (error) => {\n      // console.error('error', error);\n      this.onError(error);\n    });\n    worker.on('exit', (code) => {\n      // console.error('exit', code);\n    });\n    return worker;\n  }\n}\n", "import type {WorkerMessageType, WorkerMessagePayload} from '../../types';\nimport {isMobile} from '../env-utils/globals';\nimport WorkerThread from './worker-thread';\nimport WorkerJob from './worker-job';\n\n/** WorkerPool onDebug Callback Parameters */\ntype OnDebugParameters = {\n  message: string;\n  worker: string;\n  name: string;\n  job: string;\n  backlog: number;\n  workerThread: WorkerThread;\n};\n\n/** WorkerPool Properties */\nexport type WorkerPoolProps = {\n  name?: string;\n  source?: string; // | Function;\n  url?: string;\n  maxConcurrency?: number;\n  maxMobileConcurrency?: number;\n  onDebug?: (options: OnDebugParameters) => any;\n  reuseWorkers?: boolean;\n};\n\n/** Private helper types */\ntype OnMessage = (job: WorkerJob, type: WorkerMessageType, payload: WorkerMessagePayload) => void;\ntype OnError = (job: WorkerJob, error: Error) => void;\n\ntype QueuedJob = {\n  name: string;\n  onMessage: OnMessage;\n  onError: OnError;\n  onStart: (value: any) => void; // Resolve job start promise\n};\n\n/**\n * Process multiple data messages with small pool of identical workers\n */\nexport default class WorkerPool {\n  name: string = 'unnamed';\n  source?: string; // | Function;\n  url?: string;\n  maxConcurrency: number = 1;\n  maxMobileConcurrency: number = 1;\n  onDebug: (options: OnDebugParameters) => any = () => {};\n  reuseWorkers: boolean = true;\n\n  private props: WorkerPoolProps = {};\n  private jobQueue: QueuedJob[] = [];\n  private idleQueue: WorkerThread[] = [];\n  private count = 0;\n  private isDestroyed = false;\n\n  /** Checks if workers are supported on this platform */\n  static isSupported(): boolean {\n    return WorkerThread.isSupported();\n  }\n\n  /**\n   * @param processor - worker function\n   * @param maxConcurrency - max count of workers\n   */\n  constructor(props: WorkerPoolProps) {\n    this.source = props.source;\n    this.url = props.url;\n    this.setProps(props);\n  }\n\n  /**\n   * Terminates all workers in the pool\n   * @note Can free up significant memory\n   */\n  destroy(): void {\n    // Destroy idle workers, active Workers will be destroyed on completion\n    this.idleQueue.forEach((worker) => worker.destroy());\n    this.isDestroyed = true;\n  }\n\n  setProps(props: WorkerPoolProps) {\n    this.props = {...this.props, ...props};\n\n    if (props.name !== undefined) {\n      this.name = props.name;\n    }\n    if (props.maxConcurrency !== undefined) {\n      this.maxConcurrency = props.maxConcurrency;\n    }\n    if (props.maxMobileConcurrency !== undefined) {\n      this.maxMobileConcurrency = props.maxMobileConcurrency;\n    }\n    if (props.reuseWorkers !== undefined) {\n      this.reuseWorkers = props.reuseWorkers;\n    }\n    if (props.onDebug !== undefined) {\n      this.onDebug = props.onDebug;\n    }\n  }\n\n  async startJob(\n    name: string,\n    onMessage: OnMessage = (job, type, data) => job.done(data),\n    onError: OnError = (job, error) => job.error(error)\n  ): Promise<WorkerJob> {\n    // Promise resolves when thread starts working on this job\n    const startPromise = new Promise<WorkerJob>((onStart) => {\n      // Promise resolves when thread completes or fails working on this job\n      this.jobQueue.push({name, onMessage, onError, onStart});\n      return this;\n    });\n    this._startQueuedJob(); // eslint-disable-line @typescript-eslint/no-floating-promises\n    return await startPromise;\n  }\n\n  // PRIVATE\n\n  /**\n   * Starts first queued job if worker is available or can be created\n   * Called when job is started and whenever a worker returns to the idleQueue\n   */\n  async _startQueuedJob(): Promise<void> {\n    if (!this.jobQueue.length) {\n      return;\n    }\n\n    const workerThread = this._getAvailableWorker();\n    if (!workerThread) {\n      return;\n    }\n\n    // We have a worker, dequeue and start the job\n    const queuedJob = this.jobQueue.shift();\n    if (queuedJob) {\n      // Emit a debug event\n      // @ts-ignore\n      this.onDebug({\n        message: 'Starting job',\n        name: queuedJob.name,\n        workerThread,\n        backlog: this.jobQueue.length\n      });\n\n      // Create a worker job to let the app access thread and manage job completion\n      const job = new WorkerJob(queuedJob.name, workerThread);\n\n      // Set the worker thread's message handlers\n      workerThread.onMessage = (data) => queuedJob.onMessage(job, data.type, data.payload);\n      workerThread.onError = (error) => queuedJob.onError(job, error);\n\n      // Resolve the start promise so that the app can start sending messages to worker\n      queuedJob.onStart(job);\n\n      // Wait for the app to signal that the job is complete, then return worker to queue\n      try {\n        await job.result;\n      } finally {\n        this.returnWorkerToQueue(workerThread);\n      }\n    }\n  }\n\n  /**\n   * Returns a worker to the idle queue\n   * Destroys the worker if\n   *  - pool is destroyed\n   *  - if this pool doesn't reuse workers\n   *  - if maxConcurrency has been lowered\n   * @param worker\n   */\n  returnWorkerToQueue(worker: WorkerThread) {\n    const shouldDestroyWorker =\n      this.isDestroyed || !this.reuseWorkers || this.count > this._getMaxConcurrency();\n\n    if (shouldDestroyWorker) {\n      worker.destroy();\n      this.count--;\n    } else {\n      this.idleQueue.push(worker);\n    }\n\n    if (!this.isDestroyed) {\n      this._startQueuedJob(); // eslint-disable-line @typescript-eslint/no-floating-promises\n    }\n  }\n\n  /**\n   * Returns idle worker or creates new worker if maxConcurrency has not been reached\n   */\n  _getAvailableWorker(): WorkerThread | null {\n    // If a worker has completed and returned to the queue, it can be used\n    if (this.idleQueue.length > 0) {\n      return this.idleQueue.shift() || null;\n    }\n\n    // Create fresh worker if we haven't yet created the max amount of worker threads for this worker source\n    if (this.count < this._getMaxConcurrency()) {\n      this.count++;\n      const name = `${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;\n      return new WorkerThread({name, source: this.source, url: this.url});\n    }\n\n    // No worker available, have to wait\n    return null;\n  }\n\n  _getMaxConcurrency() {\n    return isMobile ? this.maxMobileConcurrency : this.maxConcurrency;\n  }\n}\n", "import WorkerPool from './worker-pool';\nimport WorkerThread from './worker-thread';\n\n/**\n * @param maxConcurrency - max count of workers\n * @param maxMobileConcurrency - max count of workers on mobile\n * @param maxConcurrency - max count of workers\n * @param reuseWorkers - if false, destroys workers when task is completed\n * @param onDebug - callback intended to allow application to log worker pool activity\n */\nexport type WorkerFarmProps = {\n  maxConcurrency?: number;\n  maxMobileConcurrency?: number;\n  reuseWorkers?: boolean;\n  onDebug?: () => void;\n};\n\nconst DEFAULT_PROPS: Required<WorkerFarmProps> = {\n  maxConcurrency: 3,\n  maxMobileConcurrency: 1,\n  reuseWorkers: true,\n  onDebug: () => {}\n};\n\n/**\n * Process multiple jobs with a \"farm\" of different workers in worker pools.\n */\nexport default class WorkerFarm {\n  private props: WorkerFarmProps;\n  private workerPools = new Map<string, WorkerPool>();\n  // singleton\n  private static _workerFarm?: WorkerFarm;\n\n  /** Checks if workers are supported on this platform */\n  static isSupported(): boolean {\n    return WorkerThread.isSupported();\n  }\n\n  /** Get the singleton instance of the global worker farm */\n  static getWorkerFarm(props: WorkerFarmProps = {}): WorkerFarm {\n    WorkerFarm._workerFarm = WorkerFarm._workerFarm || new WorkerFarm({});\n    WorkerFarm._workerFarm.setProps(props);\n    return WorkerFarm._workerFarm;\n  }\n\n  /** get global instance with WorkerFarm.getWorkerFarm() */\n  private constructor(props: WorkerFarmProps) {\n    this.props = {...DEFAULT_PROPS};\n    this.setProps(props);\n    /** @type Map<string, WorkerPool>} */\n    this.workerPools = new Map();\n  }\n\n  /**\n   * Terminate all workers in the farm\n   * @note Can free up significant memory\n   */\n  destroy(): void {\n    for (const workerPool of this.workerPools.values()) {\n      workerPool.destroy();\n    }\n    this.workerPools = new Map<string, WorkerPool>();\n  }\n\n  /**\n   * Set props used when initializing worker pools\n   * @param props\n   */\n  setProps(props: WorkerFarmProps): void {\n    this.props = {...this.props, ...props};\n    // Update worker pool props\n    for (const workerPool of this.workerPools.values()) {\n      workerPool.setProps(this._getWorkerPoolProps());\n    }\n  }\n\n  /**\n   * Returns a worker pool for the specified worker\n   * @param options - only used first time for a specific worker name\n   * @param options.name - the name of the worker - used to identify worker pool\n   * @param options.url -\n   * @param options.source -\n   * @example\n   *   const job = WorkerFarm.getWorkerFarm().getWorkerPool({name, url}).startJob(...);\n   */\n  getWorkerPool(options: {name: string; source?: string; url?: string}): WorkerPool {\n    const {name, source, url} = options;\n    let workerPool = this.workerPools.get(name);\n    if (!workerPool) {\n      workerPool = new WorkerPool({\n        name,\n        source,\n        url\n      });\n      workerPool.setProps(this._getWorkerPoolProps());\n      this.workerPools.set(name, workerPool);\n    }\n    return workerPool;\n  }\n\n  _getWorkerPoolProps() {\n    return {\n      maxConcurrency: this.props.maxConcurrency,\n      maxMobileConcurrency: this.props.maxMobileConcurrency,\n      reuseWorkers: this.props.reuseWorkers,\n      onDebug: this.props.onDebug\n    };\n  }\n}\n", "import type {WorkerMessageData, WorkerMessageType, WorkerMessagePayload} from '../../types';\nimport {getTransferList} from '../worker-utils/get-transfer-list';\n\n/** Vile hack to defeat over-zealous bundlers from stripping out the require */\nfunction getParentPort() {\n  // const isNode = globalThis.process;\n  let parentPort;\n  try {\n    // prettier-ignore\n    eval('globalThis.parentPort = require(\\'worker_threads\\').parentPort'); // eslint-disable-line no-eval\n    parentPort = globalThis.parentPort;\n    // eslint-disable-next-line no-empty\n  } catch {}\n  return parentPort;\n}\n\nconst onMessageWrapperMap = new Map();\n\n/**\n * Type safe wrapper for worker code\n */\nexport default class WorkerBody {\n  /** Check that we are actually in a worker thread */\n  static inWorkerThread(): boolean {\n    return typeof self !== 'undefined' || Boolean(getParentPort());\n  }\n\n  /*\n   * (type: WorkerMessageType, payload: WorkerMessagePayload) => any\n   */\n  static set onmessage(onMessage: (type: WorkerMessageType, payload: WorkerMessagePayload) => any) {\n    function handleMessage(message) {\n      // Confusingly the message itself also has a 'type' field which is always set to 'message'\n      const parentPort = getParentPort();\n      const {type, payload} = parentPort ? message : message.data;\n      // if (!isKnownMessage(message)) {\n      //   return;\n      // }\n      onMessage(type, payload);\n    }\n\n    const parentPort = getParentPort();\n    if (parentPort) {\n      parentPort.on('message', handleMessage);\n      // if (message == 'exit') { parentPort.unref(); }\n      // eslint-disable-next-line\n      parentPort.on('exit', () => console.debug('Node worker closing'));\n    } else {\n      // eslint-disable-next-line no-restricted-globals\n      globalThis.onmessage = handleMessage;\n    }\n  }\n\n  static addEventListener(\n    onMessage: (type: WorkerMessageType, payload: WorkerMessagePayload) => any\n  ) {\n    let onMessageWrapper = onMessageWrapperMap.get(onMessage);\n\n    if (!onMessageWrapper) {\n      onMessageWrapper = (message: MessageEvent<any>) => {\n        if (!isKnownMessage(message)) {\n          return;\n        }\n\n        // Confusingly in the browser, the message itself also has a 'type' field which is always set to 'message'\n        const parentPort = getParentPort();\n        const {type, payload} = parentPort ? message : message.data;\n        onMessage(type, payload);\n      };\n    }\n\n    const parentPort = getParentPort();\n    if (parentPort) {\n      console.error('not implemented'); // eslint-disable-line\n    } else {\n      globalThis.addEventListener('message', onMessageWrapper);\n    }\n  }\n\n  static removeEventListener(\n    onMessage: (type: WorkerMessageType, payload: WorkerMessagePayload) => any\n  ) {\n    const onMessageWrapper = onMessageWrapperMap.get(onMessage);\n    onMessageWrapperMap.delete(onMessage);\n    const parentPort = getParentPort();\n    if (parentPort) {\n      console.error('not implemented'); // eslint-disable-line\n    } else {\n      globalThis.removeEventListener('message', onMessageWrapper);\n    }\n  }\n\n  /**\n   * Send a message from a worker to creating thread (main thread)\n   * @param type\n   * @param payload\n   */\n  static postMessage(type: WorkerMessageType, payload: WorkerMessagePayload): void {\n    const data: WorkerMessageData = {source: 'loaders.gl', type, payload};\n    // console.log('posting message', data);\n    const transferList = getTransferList(payload);\n\n    const parentPort = getParentPort();\n    if (parentPort) {\n      parentPort.postMessage(data, transferList);\n      // console.log('posted message', data);\n    } else {\n      // @ts-ignore\n      globalThis.postMessage(data, transferList);\n    }\n  }\n}\n\n// Filter out noise messages sent to workers\nfunction isKnownMessage(message: MessageEvent<any>) {\n  const {type, data} = message;\n  return (\n    type === 'message' &&\n    data &&\n    typeof data.source === 'string' &&\n    data.source.startsWith('loaders.gl')\n  );\n}\n", "// loaders.gl, MIT license\n\nimport type {WorkerObject, WorkerOptions} from '../../types';\nimport {assert} from '../env-utils/assert';\nimport {VERSION as __VERSION__} from '../env-utils/version';\n\nconst NPM_TAG = 'latest'; // 'beta', or 'latest' on release-branch\nconst VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : NPM_TAG;\n\n/**\n * Gets worker object's name (for debugging in Chrome thread inspector window)\n */\nexport function getWorkerName(worker: WorkerObject): string {\n  const warning = worker.version !== VERSION ? ` (worker-utils@${VERSION})` : '';\n  return `${worker.name}@${worker.version}${warning}`;\n}\n\n/**\n * Generate a worker URL based on worker object and options\n * @returns A URL to one of the following:\n * - a published worker on unpkg CDN\n * - a local test worker\n * - a URL provided by the user in options\n */\nexport function getWorkerURL(worker: WorkerObject, options: WorkerOptions = {}): string {\n  const workerOptions = options[worker.id] || {};\n\n  const workerFile = `${worker.id}-worker.js`;\n\n  let url = workerOptions.workerUrl;\n\n  // HACK: Allow for non-nested workerUrl for the CompressionWorker.\n  // For the compression worker, workerOptions is currently not nested correctly. For most loaders,\n  // you'd have options within an object, i.e. `{mvt: {coordinates: ...}}` but the CompressionWorker\n  // puts options at the top level, not within a `compression` key (its `id`). For this reason, the\n  // above `workerOptions` will always be a string (i.e. `'gzip'`) for the CompressionWorker. To not\n  // break backwards compatibility, we allow the CompressionWorker to have options at the top level.\n  if (!url && worker.id === 'compression') {\n    url = options.workerUrl;\n  }\n\n  // If URL is test, generate local loaders.gl url\n  // @ts-ignore _workerType\n  if (options._workerType === 'test') {\n    url = `modules/${worker.module}/dist/${workerFile}`;\n  }\n\n  // If url override is not provided, generate a URL to published version on npm CDN unpkg.com\n  if (!url) {\n    // GENERATE\n    let version = worker.version;\n    // On master we need to load npm alpha releases published with the `beta` tag\n    if (version === 'latest') {\n      // throw new Error('latest worker version specified');\n      version = NPM_TAG;\n    }\n    const versionTag = version ? `@${version}` : '';\n    url = `https://unpkg.com/@loaders.gl/${worker.module}${versionTag}/dist/${workerFile}`;\n  }\n\n  assert(url);\n\n  // Allow user to override location\n  return url;\n}\n", "// From https://github.com/rauschma/async-iter-demo/tree/master/src under MIT license\n// http://2ality.com/2016/10/asynchronous-iteration.html\n\n/**\n * Async Queue\n * - AsyncIterable: An async iterator can be\n * - Values can be pushed onto the queue\n * @example\n *   const asyncQueue = new AsyncQueue();\n *   setTimeout(() => asyncQueue.enqueue('tick'), 1000);\n *   setTimeout(() => asyncQueue.enqueue(new Error('done')), 10000);\n *   for await (const value of asyncQueue) {\n *     console.log(value); // tick\n *   }\n */\nexport default class AsyncQueue<T> {\n  private _values: any[];\n  private _settlers: any[];\n  private _closed: boolean;\n\n  constructor() {\n    this._values = []; // enqueues > dequeues\n    this._settlers = []; // dequeues > enqueues\n    this._closed = false;\n  }\n\n  /** Return an async iterator for this queue */\n  [Symbol.asyncIterator](): AsyncIterator<T> {\n    return this;\n  }\n\n  /** Push a new value - the async iterator will yield a promise resolved to this value */\n  push(value: T): void {\n    return this.enqueue(value);\n  }\n\n  /**\n   * Push a new value - the async iterator will yield a promise resolved to this value\n   * Add an error - the async iterator will yield a promise rejected with this value\n   */\n  enqueue(value: T | Error): void {\n    if (this._closed) {\n      throw new Error('Closed');\n    }\n\n    if (this._settlers.length > 0) {\n      if (this._values.length > 0) {\n        throw new Error('Illegal internal state');\n      }\n      const settler = this._settlers.shift();\n      if (value instanceof Error) {\n        settler.reject(value);\n      } else {\n        settler.resolve({value});\n      }\n    } else {\n      this._values.push(value);\n    }\n  }\n\n  /** Indicate that we not waiting for more values - The async iterator will be done */\n  close(): void {\n    while (this._settlers.length > 0) {\n      const settler = this._settlers.shift();\n      settler.resolve({done: true});\n    }\n    this._closed = true;\n  }\n\n  // ITERATOR IMPLEMENTATION\n\n  /** @returns a Promise for an IteratorResult */\n  next(): Promise<IteratorResult<T, any>> {\n    // If values in queue, yield the first value\n    if (this._values.length > 0) {\n      const value = this._values.shift();\n      if (value instanceof Error) {\n        return Promise.reject(value);\n      }\n      return Promise.resolve({done: false, value});\n    }\n\n    // If queue is closed, the iterator is done\n    if (this._closed) {\n      if (this._settlers.length > 0) {\n        throw new Error('Illegal internal state');\n      }\n      return Promise.resolve({done: true, value: undefined});\n    }\n\n    // Yield a promise that waits for new values to be enqueued\n    return new Promise((resolve, reject) => {\n      this._settlers.push({resolve, reject});\n    });\n  }\n}\n", "import type {WorkerObject} from '../../types';\nimport {assert} from '../env-utils/assert';\nimport {VERSION} from '../env-utils/version';\n\n/**\n * Check if worker is compatible with this library version\n * @param worker\n * @param libVersion\n * @returns `true` if the two versions are compatible\n */\nexport function validateWorkerVersion(\n  worker: WorkerObject,\n  coreVersion: string = VERSION\n): boolean {\n  assert(worker, 'no worker provided');\n\n  const workerVersion = worker.version;\n  if (!coreVersion || !workerVersion) {\n    return false;\n  }\n\n  // TODO enable when fix the __version__ injection\n  // const coreVersions = parseVersion(coreVersion);\n  // const workerVersions = parseVersion(workerVersion);\n  // assert(\n  //   coreVersion.major === workerVersion.major && coreVersion.minor <= workerVersion.minor,\n  //   `worker: ${worker.name} is not compatible. ${coreVersion.major}.${\n  //     coreVersion.minor\n  //   }+ is required.`\n  // );\n\n  return true;\n}\n\n// @ts-ignore\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nfunction parseVersion(version) {\n  const parts = version.split('.').map(Number);\n  return {major: parts[0], minor: parts[1]};\n}\n", "/* global importScripts */\nimport {global, isBrowser, isWorker} from '../env-utils/globals';\nimport * as node from '../node/require-utils.node';\nimport {assert} from '../env-utils/assert';\nimport {VERSION as __VERSION__} from '../env-utils/version';\n\n/**\n * TODO - unpkg.com doesn't seem to have a `latest` specifier for alpha releases...\n * 'beta' on beta branch, 'latest' on prod branch\n */\nconst LATEST = 'latest';\nconst VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : LATEST;\n\nconst loadLibraryPromises: Record<string, Promise<any>> = {}; // promises\n\n/**\n * Dynamically loads a library (\"module\")\n *\n * - wasm library: Array buffer is returned\n * - js library: Parse JS is returned\n *\n * Method depends on environment\n * - browser - script element is created and installed on document\n * - worker - eval is called on global context\n * - node - file is required\n *\n * @param libraryUrl\n * @param moduleName\n * @param options\n */\nexport async function loadLibrary(\n  libraryUrl: string,\n  moduleName: string | null = null,\n  options: object = {}\n): Promise<any> {\n  if (moduleName) {\n    libraryUrl = getLibraryUrl(libraryUrl, moduleName, options);\n  }\n\n  // Ensure libraries are only loaded once\n\n  loadLibraryPromises[libraryUrl] =\n    // eslint-disable-next-line @typescript-eslint/no-misused-promises\n    loadLibraryPromises[libraryUrl] || loadLibraryFromFile(libraryUrl);\n  return await loadLibraryPromises[libraryUrl];\n}\n\n// TODO - sort out how to resolve paths for main/worker and dev/prod\nexport function getLibraryUrl(library: string, moduleName?: string, options?: any): string {\n  // Check if already a URL\n  if (library.startsWith('http')) {\n    return library;\n  }\n\n  // Allow application to import and supply libraries through `options.modules`\n  const modules = options.modules || {};\n  if (modules[library]) {\n    return modules[library];\n  }\n\n  // Load from local files, not from CDN scripts in Node.js\n  // TODO - needs to locate the modules directory when installed!\n  if (!isBrowser) {\n    return `modules/${moduleName}/dist/libs/${library}`;\n  }\n\n  // In browser, load from external scripts\n  if (options.CDN) {\n    assert(options.CDN.startsWith('http'));\n    return `${options.CDN}/${moduleName}@${VERSION}/dist/libs/${library}`;\n  }\n\n  // TODO - loading inside workers requires paths relative to worker script location...\n  if (isWorker) {\n    return `../src/libs/${library}`;\n  }\n\n  return `modules/${moduleName}/src/libs/${library}`;\n}\n\nasync function loadLibraryFromFile(libraryUrl: string): Promise<any> {\n  if (libraryUrl.endsWith('wasm')) {\n    const response = await fetch(libraryUrl);\n    return await response.arrayBuffer();\n  }\n\n  if (!isBrowser) {\n    try {\n      return node && node.requireFromFile && (await node.requireFromFile(libraryUrl));\n    } catch {\n      return null;\n    }\n  }\n  if (isWorker) {\n    return importScripts(libraryUrl);\n  }\n  // TODO - fix - should be more secure than string parsing since observes CORS\n  // if (isBrowser) {\n  //   return await loadScriptFromFile(libraryUrl);\n  // }\n\n  const response = await fetch(libraryUrl);\n  const scriptSource = await response.text();\n  return loadLibraryFromString(scriptSource, libraryUrl);\n}\n\n/*\nasync function loadScriptFromFile(libraryUrl) {\n  const script = document.createElement('script');\n  script.src = libraryUrl;\n  return await new Promise((resolve, reject) => {\n    script.onload = data => {\n      resolve(data);\n    };\n    script.onerror = reject;\n  });\n}\n*/\n\n// TODO - Needs security audit...\n//  - Raw eval call\n//  - Potentially bypasses CORS\n// Upside is that this separates fetching and parsing\n// we could create a`LibraryLoader` or`ModuleLoader`\nfunction loadLibraryFromString(scriptSource: string, id: string): null | any {\n  if (!isBrowser) {\n    return node.requireFromString && node.requireFromString(scriptSource, id);\n  }\n\n  if (isWorker) {\n    // Use lvalue trick to make eval run in global scope\n    eval.call(global, scriptSource); // eslint-disable-line no-eval\n    // https://stackoverflow.com/questions/9107240/1-evalthis-vs-evalthis-in-javascript\n    // http://perfectionkills.com/global-eval-what-are-the-options/\n    return null;\n  }\n\n  const script = document.createElement('script');\n  script.id = id;\n  // most browsers like a separate text node but some throw an error. The second method covers those.\n  try {\n    script.appendChild(document.createTextNode(scriptSource));\n  } catch (e) {\n    script.text = scriptSource;\n  }\n  document.body.appendChild(script);\n  return null;\n}\n\n// TODO - technique for module injection into worker, from THREE.DracoLoader...\n/*\nfunction combineWorkerWithLibrary(worker, jsContent) {\n  var fn = wWorker.toString();\n  var body = [\n    '// injected',\n    jsContent,\n    '',\n    '// worker',\n    fn.substring(fn.indexOf('{') + 1, fn.lastIndexOf('}'))\n  ].join('\\n');\n  this.workerSourceURL = URL.createObjectURL(new Blob([body]));\n}\n*/\n", "import type {WorkerObject} from './types';\nimport {VERSION} from './lib/env-utils/version';\n\n// TYPES\nexport type {\n  WorkerObject,\n  WorkerOptions,\n  // Protocol\n  WorkerMessage,\n  WorkerMessageType,\n  WorkerMessageData,\n  WorkerMessagePayload\n} from './types';\n\n// GENERAL UTILS\nexport {assert} from './lib/env-utils/assert';\nexport {isBrowser, isWorker} from './lib/env-utils/globals';\n\n// WORKER UTILS - TYPES\nexport {default as WorkerJob} from './lib/worker-farm/worker-job';\nexport {default as WorkerThread} from './lib/worker-farm/worker-thread';\n\n// WORKER FARMS\nexport {default as WorkerFarm} from './lib/worker-farm/worker-farm';\nexport {default as WorkerPool} from './lib/worker-farm/worker-pool';\nexport {default as WorkerBody} from './lib/worker-farm/worker-body';\n\nexport {processOnWorker, canProcessOnWorker} from './lib/worker-api/process-on-worker';\nexport {createWorker} from './lib/worker-api/create-worker';\n\n// WORKER UTILS - EXPORTS\nexport {getWorkerURL} from './lib/worker-api/get-worker-url';\nexport {validateWorkerVersion} from './lib/worker-api/validate-worker-version';\nexport {getTransferList, getTransferListForWriter} from './lib/worker-utils/get-transfer-list';\n\n// LIBRARY UTILS\nexport {getLibraryUrl, loadLibrary} from './lib/library-utils/library-utils';\n\n// PARSER UTILS\nexport {default as AsyncQueue} from './lib/async-queue/async-queue';\n\n// PROCESS UTILS\nexport {default as ChildProcessProxy} from './lib/process-utils/child-process-proxy';\n\n// WORKER OBJECTS\n\n/** A null worker to test that worker processing is functional */\nexport const NullWorker: WorkerObject = {\n  id: 'null',\n  name: 'null',\n  module: 'worker-utils',\n  version: VERSION,\n  options: {\n    null: {}\n  }\n};\n", "import {\n  WorkerJob,\n  WorkerMessageType,\n  WorkerMessagePayload,\n  isBrowser\n} from '@loaders.gl/worker-utils';\nimport type {Loader, LoaderOptions, LoaderContext} from '../../types';\nimport {WorkerFarm, getWorkerURL} from '@loaders.gl/worker-utils';\n\n/**\n * Determines if a loader can parse with worker\n * @param loader\n * @param options\n */\nexport function canParseWithWorker(loader: Loader, options?: LoaderOptions) {\n  if (!WorkerFarm.isSupported()) {\n    return false;\n  }\n\n  // Node workers are still experimental\n  if (!isBrowser && !options?._nodeWorkers) {\n    return false;\n  }\n\n  return loader.worker && options?.worker;\n}\n\n/**\n * this function expects that the worker function sends certain messages,\n * this can be automated if the worker is wrapper by a call to createLoaderWorker in @loaders.gl/loader-utils.\n */\nexport async function parseWithWorker(\n  loader: Loader,\n  data: any,\n  options?: LoaderOptions,\n  context?: LoaderContext,\n  parseOnMainThread?: (arrayBuffer: ArrayBuffer, options: {[key: string]: any}) => Promise<void>\n) {\n  const name = loader.id; // TODO\n  const url = getWorkerURL(loader, options);\n\n  const workerFarm = WorkerFarm.getWorkerFarm(options);\n  const workerPool = workerFarm.getWorkerPool({name, url});\n\n  // options.log object contains functions which cannot be transferred\n  // context.fetch & context.parse functions cannot be transferred\n  // TODO - decide how to handle logging on workers\n  options = JSON.parse(JSON.stringify(options));\n  context = JSON.parse(JSON.stringify(context || {}));\n\n  const job = await workerPool.startJob(\n    'process-on-worker',\n    // @ts-expect-error\n    onMessage.bind(null, parseOnMainThread) // eslint-disable-line @typescript-eslint/no-misused-promises\n  );\n\n  job.postMessage('process', {\n    // @ts-ignore\n    input: data,\n    options,\n    context\n  });\n\n  const result = await job.result;\n  // TODO - what is going on here?\n  return await result.result;\n}\n\n/**\n * Handle worker's responses to the main thread\n * @param job\n * @param type\n * @param payload\n */\nasync function onMessage(\n  parseOnMainThread: (arrayBuffer: ArrayBuffer, options?: {[key: string]: any}) => Promise<void>,\n  job: WorkerJob,\n  type: WorkerMessageType,\n  payload: WorkerMessagePayload\n) {\n  switch (type) {\n    case 'done':\n      job.done(payload);\n      break;\n\n    case 'error':\n      job.error(new Error(payload.error));\n      break;\n\n    case 'process':\n      // Worker is asking for main thread to parseO\n      const {id, input, options} = payload;\n      try {\n        const result = await parseOnMainThread(input, options);\n        job.postMessage('done', {id, result});\n      } catch (error) {\n        const message = error instanceof Error ? error.message : 'unknown error';\n        job.postMessage('error', {id, error: message});\n      }\n      break;\n\n    default:\n      // eslint-disable-next-line\n      console.warn(`parse-with-worker unknown message ${type}`);\n  }\n}\n", "// loaders.gl, MIT license\n\n/**\n * Get the first characters from a binary file (interpret the first bytes as an ASCII string)\n * @param data\n * @param length\n * @returns\n */\nexport function getFirstCharacters(data: string | ArrayBuffer, length: number = 5): string {\n  if (typeof data === 'string') {\n    return data.slice(0, length);\n  } else if (ArrayBuffer.isView(data)) {\n    // Typed Arrays can have offsets into underlying buffer\n    return getMagicString(data.buffer, data.byteOffset, length);\n  } else if (data instanceof ArrayBuffer) {\n    const byteOffset = 0;\n    return getMagicString(data, byteOffset, length);\n  }\n  return '';\n}\n\n/**\n * Gets a magic string from a \"file\"\n * Typically used to check or detect file format\n * @param arrayBuffer\n * @param byteOffset\n * @param length\n * @returns\n */\nexport function getMagicString(\n  arrayBuffer: ArrayBuffer,\n  byteOffset: number,\n  length: number\n): string {\n  if (arrayBuffer.byteLength <= byteOffset + length) {\n    return '';\n  }\n  const dataView = new DataView(arrayBuffer);\n  let magic = '';\n  for (let i = 0; i < length; i++) {\n    magic += String.fromCharCode(dataView.getUint8(byteOffset + i));\n  }\n  return magic;\n}\n", "import {getFirstCharacters} from '../binary-utils/get-first-characters';\n\n/**\n * Minimal JSON parser that throws more meaningful error messages\n */\nexport function parseJSON(string: string): any {\n  try {\n    return JSON.parse(string);\n  } catch (_) {\n    throw new Error(`Failed to parse JSON from data starting with \"${getFirstCharacters(string)}\"`);\n  }\n}\n", "import {TypedArray} from '../../types';\n\n/**\n * compare two binary arrays for equality\n * @param a\n * @param b\n * @param byteLength\n */\nexport function compareArrayBuffers(\n  arrayBuffer1: ArrayBuffer,\n  arrayBuffer2: ArrayBuffer,\n  byteLength?: number\n): boolean {\n  byteLength = byteLength || arrayBuffer1.byteLength;\n  if (arrayBuffer1.byteLength < byteLength || arrayBuffer2.byteLength < byteLength) {\n    return false;\n  }\n  const array1 = new Uint8Array(arrayBuffer1);\n  const array2 = new Uint8Array(arrayBuffer2);\n  for (let i = 0; i < array1.length; ++i) {\n    if (array1[i] !== array2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Concatenate a sequence of ArrayBuffers\n * @return A concatenated ArrayBuffer\n */\nexport function concatenateArrayBuffers(...sources: (ArrayBuffer | Uint8Array)[]): ArrayBuffer {\n  // Make sure all inputs are wrapped in typed arrays\n  const sourceArrays = sources.map((source2) =>\n    source2 instanceof ArrayBuffer ? new Uint8Array(source2) : source2\n  );\n\n  // Get length of all inputs\n  const byteLength = sourceArrays.reduce((length, typedArray) => length + typedArray.byteLength, 0);\n\n  // Allocate array with space for all inputs\n  const result = new Uint8Array(byteLength);\n\n  // Copy the subarrays\n  let offset = 0;\n  for (const sourceArray of sourceArrays) {\n    result.set(sourceArray, offset);\n    offset += sourceArray.byteLength;\n  }\n\n  // We work with ArrayBuffers, discard the typed array wrapper\n  return result.buffer;\n}\n\n/**\n * Concatenate arbitrary count of typed arrays\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Typed_arrays\n * @param - list of arrays. All arrays should be the same type\n * @return A concatenated TypedArray\n */\nexport function concatenateTypedArrays<T>(...typedArrays: T[]): T {\n  // @ts-ignore\n  const arrays = typedArrays as TypedArray[];\n  // @ts-ignore\n  const TypedArrayConstructor = (arrays && arrays.length > 1 && arrays[0].constructor) || null;\n  if (!TypedArrayConstructor) {\n    throw new Error(\n      '\"concatenateTypedArrays\" - incorrect quantity of arguments or arguments have incompatible data types'\n    );\n  }\n\n  const sumLength = arrays.reduce((acc, value) => acc + value.length, 0);\n  // @ts-ignore typescript does not like dynamic constructors\n  const result = new TypedArrayConstructor(sumLength);\n  let offset = 0;\n  for (const array of arrays) {\n    result.set(array, offset);\n    offset += array.length;\n  }\n  return result;\n}\n\n/**\n * Copy a view of an ArrayBuffer into new ArrayBuffer with byteOffset = 0\n * @param arrayBuffer\n * @param byteOffset\n * @param byteLength\n */\nexport function sliceArrayBuffer(\n  arrayBuffer: ArrayBuffer,\n  byteOffset: number,\n  byteLength?: number\n): ArrayBuffer {\n  const subArray =\n    byteLength !== undefined\n      ? new Uint8Array(arrayBuffer).subarray(byteOffset, byteOffset + byteLength)\n      : new Uint8Array(arrayBuffer).subarray(byteOffset);\n  const arrayCopy = new Uint8Array(subArray);\n  return arrayCopy.buffer;\n}\n", "import {assert} from '../env-utils/assert';\n\n/**\n * Calculate new size of an arrayBuffer to be aligned to an n-byte boundary\n * This function increases `byteLength` by the minimum delta,\n * allowing the total length to be divided by `padding`\n * @param byteLength\n * @param padding\n */\nexport function padToNBytes(byteLength: number, padding: number): number {\n  assert(byteLength >= 0); // `Incorrect 'byteLength' value: ${byteLength}`\n  assert(padding > 0); // `Incorrect 'padding' value: ${padding}`\n  return (byteLength + (padding - 1)) & ~(padding - 1);\n}\n\n/**\n * Creates a new Uint8Array based on two different ArrayBuffers\n * @param targetBuffer The first buffer.\n * @param sourceBuffer The second buffer.\n * @return The new ArrayBuffer created out of the two.\n */\nexport function copyArrayBuffer(\n  targetBuffer: ArrayBuffer,\n  sourceBuffer: ArrayBuffer,\n  byteOffset: number,\n  byteLength: number = sourceBuffer.byteLength\n): ArrayBuffer {\n  const targetArray = new Uint8Array(targetBuffer, byteOffset, byteLength);\n  const sourceArray = new Uint8Array(sourceBuffer);\n  targetArray.set(sourceArray);\n  return targetBuffer;\n}\n\n/**\n * Copy from source to target at the targetOffset\n *\n * @param source - The data to copy\n * @param target - The destination to copy data into\n * @param targetOffset - The start offset into target to place the copied data\n * @returns the new offset taking into account proper padding\n */\nexport function copyToArray(source: ArrayBuffer | any, target: any, targetOffset: number): number {\n  let sourceArray;\n\n  if (source instanceof ArrayBuffer) {\n    sourceArray = new Uint8Array(source);\n  } else {\n    // Pack buffer onto the big target array\n    //\n    // 'source.data.buffer' could be a view onto a larger buffer.\n    // We MUST use this constructor to ensure the byteOffset and byteLength is\n    // set to correct values from 'source.data' and not the underlying\n    // buffer for target.set() to work properly.\n    const srcByteOffset = source.byteOffset;\n    const srcByteLength = source.byteLength;\n    // In gltf parser it is set as \"arrayBuffer\" instead of \"buffer\"\n    // https://github.com/visgl/loaders.gl/blob/1e3a82a0a65d7b6a67b1e60633453e5edda2960a/modules/gltf/src/lib/parse-gltf.js#L85\n    sourceArray = new Uint8Array(source.buffer || source.arrayBuffer, srcByteOffset, srcByteLength);\n  }\n\n  // Pack buffer onto the big target array\n  target.set(sourceArray, targetOffset);\n\n  return targetOffset + padToNBytes(sourceArray.byteLength, 4);\n}\n", "// loaders./gl, MIT license\n\nimport {TypedArray} from '../../types';\nimport {padToNBytes} from './memory-copy-utils';\n\n/**\n * Helper function that pads a string with spaces to fit a certain byte alignment\n * @param string\n * @param byteAlignment\n * @returns\n *\n * @todo PERFORMANCE IDEA: No need to copy string twice...\n */\nexport function padStringToByteAlignment(string: string, byteAlignment: number): string {\n  const length = string.length;\n  const paddedLength = Math.ceil(length / byteAlignment) * byteAlignment; // Round up to the required alignment\n  const padding = paddedLength - length;\n  let whitespace = '';\n  for (let i = 0; i < padding; ++i) {\n    whitespace += ' ';\n  }\n  return string + whitespace;\n}\n\n/**\n *\n * @param dataView\n * @param byteOffset\n * @param string\n * @param byteLength\n * @returns\n */\nexport function copyStringToDataView(\n  dataView: DataView,\n  byteOffset: number,\n  string: string,\n  byteLength: number\n): number {\n  if (dataView) {\n    for (let i = 0; i < byteLength; i++) {\n      dataView.setUint8(byteOffset + i, string.charCodeAt(i));\n    }\n  }\n  return byteOffset + byteLength;\n}\n\nexport function copyBinaryToDataView(dataView, byteOffset, binary, byteLength) {\n  if (dataView) {\n    for (let i = 0; i < byteLength; i++) {\n      dataView.setUint8(byteOffset + i, binary[i]);\n    }\n  }\n  return byteOffset + byteLength;\n}\n\n/**\n * Copy sourceBuffer to dataView with some padding\n *\n * @param dataView - destination data container. If null - only new offset is calculated\n * @param byteOffset - destination byte offset to copy to\n * @param sourceBuffer - source data buffer\n * @param padding - pad the resulting array to multiple of \"padding\" bytes. Additional bytes are filled with 0x20 (ASCII space)\n *\n * @return new byteOffset of resulting dataView\n */\nexport function copyPaddedArrayBufferToDataView(\n  dataView: DataView | null,\n  byteOffset: number,\n  sourceBuffer: TypedArray,\n  padding: number\n): number {\n  const paddedLength = padToNBytes(sourceBuffer.byteLength, padding);\n  const padLength = paddedLength - sourceBuffer.byteLength;\n\n  if (dataView) {\n    // Copy array\n    const targetArray = new Uint8Array(\n      dataView.buffer,\n      dataView.byteOffset + byteOffset,\n      sourceBuffer.byteLength\n    );\n    const sourceArray = new Uint8Array(sourceBuffer);\n    targetArray.set(sourceArray);\n\n    // Add PADDING\n    for (let i = 0; i < padLength; ++i) {\n      // json chunk is padded with spaces (ASCII 0x20)\n      dataView.setUint8(byteOffset + sourceBuffer.byteLength + i, 0x20);\n    }\n  }\n  byteOffset += paddedLength;\n  return byteOffset;\n}\n\n/**\n * Copy string to dataView with some padding\n *\n * @param {DataView | null} dataView - destination data container. If null - only new offset is calculated\n * @param {number} byteOffset - destination byte offset to copy to\n * @param {string} string - source string\n * @param {number} padding - pad the resulting array to multiple of \"padding\" bytes. Additional bytes are filled with 0x20 (ASCII space)\n *\n * @return new byteOffset of resulting dataView\n */\nexport function copyPaddedStringToDataView(\n  dataView: DataView | null,\n  byteOffset: number,\n  string: string,\n  padding: number\n): number {\n  const textEncoder = new TextEncoder();\n  // PERFORMANCE IDEA: We encode twice, once to get size and once to store\n  // PERFORMANCE IDEA: Use TextEncoder.encodeInto() to avoid temporary copy\n  const stringBuffer = textEncoder.encode(string);\n\n  byteOffset = copyPaddedArrayBufferToDataView(dataView, byteOffset, stringBuffer, padding);\n\n  return byteOffset;\n}\n", "import {concatenateArrayBuffers} from '../binary-utils/array-buffer-utils';\n\n// GENERAL UTILITIES\n\n/**\n * Iterate over async iterator, without resetting iterator if end is not reached\n * - forEach intentionally does not reset iterator if exiting loop prematurely\n *   so that iteration can continue in a second loop\n * - It is recommended to use a standard for-await as last loop to ensure\n *   iterator gets properly reset\n *\n * TODO - optimize using sync iteration if argument is an Iterable?\n *\n * @param iterator\n * @param visitor\n */\nexport async function forEach(iterator, visitor) {\n  // eslint-disable-next-line\n  while (true) {\n    const {done, value} = await iterator.next();\n    if (done) {\n      iterator.return();\n      return;\n    }\n    const cancel = visitor(value);\n    if (cancel) {\n      return;\n    }\n  }\n}\n\n// Breaking big data into iterable chunks, concatenating iterable chunks into big data objects\n\n/**\n * Concatenates all data chunks yielded by an (async) iterator\n * This function can e.g. be used to enable atomic parsers to work on (async) iterator inputs\n */\n\nexport async function concatenateArrayBuffersAsync(\n  asyncIterator: AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer>\n): Promise<ArrayBuffer> {\n  const arrayBuffers: ArrayBuffer[] = [];\n  for await (const chunk of asyncIterator) {\n    arrayBuffers.push(chunk);\n  }\n  return concatenateArrayBuffers(...arrayBuffers);\n}\n\nexport async function concatenateStringsAsync(\n  asyncIterator: AsyncIterable<string> | Iterable<string>\n): Promise<string> {\n  const strings: string[] = [];\n  for await (const chunk of asyncIterator) {\n    strings.push(chunk);\n  }\n  return strings.join('');\n}\n", "// Simple file alias mechanisms for tests.\n\nlet pathPrefix = '';\nconst fileAliases: {[aliasPath: string]: string} = {};\n\n/*\n * Set a relative path prefix\n */\nexport function setPathPrefix(prefix: string): void {\n  pathPrefix = prefix;\n}\n\n/*\n * Get the relative path prefix\n */\nexport function getPathPrefix(): string {\n  return pathPrefix;\n}\n\n/**\n *\n * @param aliases\n *\n * Note: addAliases are an experimental export, they are only for testing of loaders.gl loaders\n * not intended as a generic aliasing mechanism\n */\nexport function addAliases(aliases: {[aliasPath: string]: string}): void {\n  Object.assign(fileAliases, aliases);\n}\n\n/**\n * Resolves aliases and adds path-prefix to paths\n */\nexport function resolvePath(filename: string): string {\n  for (const alias in fileAliases) {\n    if (filename.startsWith(alias)) {\n      const replacement = fileAliases[alias];\n      filename = filename.replace(alias, replacement);\n    }\n  }\n  if (!filename.startsWith('http://') && !filename.startsWith('https://')) {\n    filename = `${pathPrefix}${filename}`;\n  }\n  return filename;\n}\n", "// loaders.gl, MIT license\n\n// Isolates Buffer references to ensure they are only bundled under Node.js (avoids big webpack polyfill)\n// this file is selected by the package.json \"browser\" field).\n\n/**\n * Convert Buffer to ArrayBuffer\n * Converts Node.js `Buffer` to `ArrayBuffer` (without triggering bundler to include Buffer polyfill on browser)\n * @todo better data type\n */\nexport function toArrayBuffer(buffer) {\n  return buffer;\n}\n\n/**\n * Convert (copy) ArrayBuffer to Buffer\n */\nexport function toBuffer(binaryData: ArrayBuffer | ArrayBuffer | Buffer): Buffer {\n  throw new Error('Buffer not supported in browser');\n}\n", "// loaders.gl, MIT license\n\nimport * as node from '../node/buffer';\n\n/**\n * Check for Node.js `Buffer` (without triggering bundler to include Buffer polyfill on browser)\n */\nexport function isBuffer(value: any): boolean {\n  return value && typeof value === 'object' && value.isBuffer;\n}\n\n/**\n * Converts to Node.js `Buffer` (without triggering bundler to include Buffer polyfill on browser)\n * @todo better data type\n */\nexport function toBuffer(data: any): Buffer {\n  return node.toBuffer ? node.toBuffer(data) : data;\n}\n\n/**\n * Convert an object to an array buffer\n */\nexport function toArrayBuffer(data: unknown): ArrayBuffer {\n  // Note: Should be called first, Buffers can trigger other detections below\n  if (isBuffer(data)) {\n    return node.toArrayBuffer(data);\n  }\n\n  if (data instanceof ArrayBuffer) {\n    return data;\n  }\n\n  // Careful - Node Buffers look like Uint8Arrays (keep after isBuffer)\n  if (ArrayBuffer.isView(data)) {\n    if (data.byteOffset === 0 && data.byteLength === data.buffer.byteLength) {\n      return data.buffer;\n    }\n    return data.buffer.slice(data.byteOffset, data.byteOffset + data.byteLength);\n  }\n\n  if (typeof data === 'string') {\n    const text = data;\n    const uint8Array = new TextEncoder().encode(text);\n    return uint8Array.buffer;\n  }\n\n  // HACK to support Blob polyfill\n  if (data && typeof data === 'object' && (data as any)._toArrayBuffer) {\n    return (data as any)._toArrayBuffer();\n  }\n\n  throw new Error('toArrayBuffer');\n}\n", "// @loaders.gl, MIT license\n\n// type Parameter1<T extends (arg1: any, ...args: unknown[]) => unknown> = T extends (\n//   arg1: infer P,\n//   ...args: unknown[]\n// ) => unknown\n//   ? P\n//   : never;\n\n//   type Parameter2<T extends (arg1: unknown, arg2: any, ...args: unknown[]) => unknown> = T extends (\n//   arg1: unknown,\n//   arg2: infer P,\n//   ...args: unknown[]\n// ) => unknown\n//   ? P\n//   : never;\n\n// type CallbackParameter2<\n//   T extends (arg: unknown, cb: (error: any, value: any) => void) => unknown\n// > = T extends (arg: unknown, cb: (error: any, value: infer P) => void) => unknown ? P : never;\n\n// type CallbackParameter3<\n//   T extends (arg: unknown, arg2: unknown, cb: (error: any, value: any) => void) => unknown\n// > = T extends (arg: unknown, arg2: unknown, cb: (error: any, value: infer P) => void) => unknown\n//   ? P\n//   : never;\n\n// /** Extract the parameters of a function type in a tuple */\n// export type Promisified<F extends (arg1, cb: (error: unknown, value: any) => void) => any> = (\n//   arg1: Parameter1<F>\n// ) => Promise<CallbackParameter2<F>>;\n// /** Extract the parameters of a function type in a tuple */\n// export type Promisified2<F extends (arg1, arg2, cb: (error: unknown, value: any) => void) => any> = (\n//   arg1: Parameter1<F>,\n//   arg2: Parameter2<F>\n// ) => Promise<CallbackParameter3<F>>;\n\n/** Wrapper for Node.js promisify */\ntype Callback<A> = (error: unknown, args: A) => void;\n\n/**\n * Typesafe promisify implementation\n * @link https://dev.to/_gdelgado/implement-a-type-safe-version-of-node-s-promisify-in-7-lines-of-code-in-typescript-2j34\n * @param fn\n * @returns\n */\nexport function promisify1<T, A>(fn: (args: T, cb: Callback<A>) => void): (args: T) => Promise<A> {\n  return (args: T) =>\n    new Promise((resolve, reject) =>\n      fn(args, (error, callbackArgs) => (error ? reject(error) : resolve(callbackArgs)))\n    );\n}\n\nexport function promisify2<T1, T2, A>(\n  fn: (arg1: T1, arg2: T2, cb: Callback<A>) => void\n): (arg1: T1, arg2: T2) => Promise<A> {\n  return (arg1: T1, arg2: T2) =>\n    new Promise((resolve, reject) =>\n      fn(arg1, arg2, (error, callbackArgs) => (error ? reject(error) : resolve(callbackArgs)))\n    );\n}\n\nexport function promisify3<T1, T2, T3, A>(\n  fn: (arg1: T1, arg2: T2, arg3: T3, cb: Callback<A>) => void\n): (arg1: T1, arg2: T2, arg3: T3) => Promise<A> {\n  return (arg1: T1, arg2: T2, arg3: T3) =>\n    new Promise((resolve, reject) =>\n      fn(arg1, arg2, arg3, (error, callbackArgs) => (error ? reject(error) : resolve(callbackArgs)))\n    );\n}\n", "// fs wrapper (promisified fs + avoids bundling fs in browsers)\nimport fs from 'fs';\nimport {toArrayBuffer} from './buffer';\nimport {promisify2, promisify3} from './promisify';\n\nexport type {Stats, WriteStream} from 'fs';\n\nexport let readdir;\n/** Wrapper for Node.js fs method */\nexport let stat;\n\n/** Wrapper for Node.js fs method */\nexport let readFile;\n/** Wrapper for Node.js fs method */\nexport let readFileSync;\n/** Wrapper for Node.js fs method */\nexport let writeFile;\n/** Wrapper for Node.js fs method */\nexport let writeFileSync;\n\n// file descriptors\n\n/** Wrapper for Node.js fs method */\nexport let open;\n/** Wrapper for Node.js fs method */\nexport let close: (fd: number) => Promise<void>;\n/** Wrapper for Node.js fs method */\nexport let read;\n/** Wrapper for Node.js fs method */\nexport let fstat;\n\nexport let createWriteStream: typeof fs.createWriteStream;\n\nexport let isSupported = Boolean(fs);\n\n// paths\n\ntry {\n  /** Wrapper for Node.js fs method */\n  readdir = promisify2(fs.readdir);\n  /** Wrapper for Node.js fs method */\n  stat = promisify2(fs.stat);\n\n  /** Wrapper for Node.js fs method */\n  readFile = fs.readFile;\n  /** Wrapper for Node.js fs method */\n  readFileSync = fs.readFileSync;\n  /** Wrapper for Node.js fs method */\n  writeFile = promisify3(fs.writeFile);\n  /** Wrapper for Node.js fs method */\n  writeFileSync = fs.writeFileSync;\n\n  // file descriptors\n\n  /** Wrapper for Node.js fs method */\n  open = fs.open;\n  /** Wrapper for Node.js fs method */\n  close = (fd: number) =>\n    new Promise((resolve, reject) => fs.close(fd, (err) => (err ? reject(err) : resolve())));\n  /** Wrapper for Node.js fs method */\n  read = fs.read;\n  /** Wrapper for Node.js fs method */\n  fstat = fs.fstat;\n\n  createWriteStream = fs.createWriteStream;\n\n  isSupported = Boolean(fs);\n} catch {\n  // ignore\n}\n\nexport async function _readToArrayBuffer(fd: number, start: number, length: number) {\n  const buffer = Buffer.alloc(length);\n  const {bytesRead} = await read(fd, buffer, 0, length, start);\n  if (bytesRead !== length) {\n    throw new Error('fs.read failed');\n  }\n  return toArrayBuffer(buffer);\n}\n", "// loaders.gl, MIT license\n\nimport stream from 'stream';\n\nexport type {Writable} from 'stream';\n\nexport let Transform;\n\nexport const isSupported = Boolean(stream);\n\n// paths\n\ntry {\n  /** Wrapper for Node.js fs method */\n  Transform = stream.Transform;\n} catch {\n  // ignore\n}\n", "import type {Readable} from 'stream';\n\n/** A DOM or Node readable stream */\nexport type ReadableStreamType = ReadableStream | Readable;\n\nconst isBoolean: (x: any) => boolean = (x) => typeof x === 'boolean';\nconst isFunction: (x: any) => boolean = (x) => typeof x === 'function';\n\nexport const isObject: (x: any) => boolean = (x) => x !== null && typeof x === 'object';\nexport const isPureObject: (x: any) => boolean = (x) =>\n  isObject(x) && x.constructor === {}.constructor;\nexport const isPromise: (x: any) => boolean = (x) => isObject(x) && isFunction(x.then);\n\nexport const isIterable: (x: any) => boolean = (x) => x && typeof x[Symbol.iterator] === 'function';\nexport const isAsyncIterable: (x: any) => boolean = (x) =>\n  x && typeof x[Symbol.asyncIterator] === 'function';\nexport const isIterator: (x: any) => boolean = (x) => x && isFunction(x.next);\n\nexport const isResponse: (x: any) => boolean = (x) =>\n  (typeof Response !== 'undefined' && x instanceof Response) ||\n  (x && x.arrayBuffer && x.text && x.json);\n\nexport const isFile: (x: any) => boolean = (x) => typeof File !== 'undefined' && x instanceof File;\nexport const isBlob: (x: any) => boolean = (x) => typeof Blob !== 'undefined' && x instanceof Blob;\n\n/** Check for Node.js `Buffer` without triggering bundler to include buffer polyfill */\nexport const isBuffer: (x: any) => boolean = (x) => x && typeof x === 'object' && x.isBuffer;\n\nexport const isWritableDOMStream: (x: any) => boolean = (x) =>\n  isObject(x) && isFunction(x.abort) && isFunction(x.getWriter);\n\nexport const isReadableDOMStream: (x: any) => boolean = (x) =>\n  (typeof ReadableStream !== 'undefined' && x instanceof ReadableStream) ||\n  (isObject(x) && isFunction(x.tee) && isFunction(x.cancel) && isFunction(x.getReader));\n// Not implemented in Firefox: && isFunction(x.pipeTo)\n\nexport const isWritableNodeStream: (x: any) => boolean = (x) =>\n  isObject(x) && isFunction(x.end) && isFunction(x.write) && isBoolean(x.writable);\nexport const isReadableNodeStream: (x: any) => boolean = (x) =>\n  isObject(x) && isFunction(x.read) && isFunction(x.pipe) && isBoolean(x.readable);\nexport const isReadableStream: (x: any) => boolean = (x) =>\n  isReadableDOMStream(x) || isReadableNodeStream(x);\nexport const isWritableStream: (x: any) => boolean = (x) =>\n  isWritableDOMStream(x) || isWritableNodeStream(x);\n", "// TODO - build/integrate proper MIME type parsing\n// https://mimesniff.spec.whatwg.org/\n\nconst DATA_URL_PATTERN = /^data:([-\\w.]+\\/[-\\w.+]+)(;|,)/;\nconst MIME_TYPE_PATTERN = /^([-\\w.]+\\/[-\\w.+]+)/;\n\n/**\n * Remove extra data like `charset` from MIME types\n * @param mimeString\n * @returns A clean MIME type, or an empty string\n *\n * @todo - handle more advanced MIMETYpes, multiple types\n * @todo - extract charset etc\n */\nexport function parseMIMEType(mimeString: string): string {\n  // If resource is a data url, extract any embedded mime type\n  const matches = MIME_TYPE_PATTERN.exec(mimeString);\n  if (matches) {\n    return matches[1];\n  }\n  return mimeString;\n}\n\n/**\n * Extract MIME type from data URL\n *\n * @param mimeString\n * @returns A clean MIME type, or an empty string\n *\n * @todo - handle more advanced MIMETYpes, multiple types\n * @todo - extract charset etc\n */\nexport function parseMIMETypeFromURL(url: string): string {\n  // If resource is a data URL, extract any embedded mime type\n  const matches = DATA_URL_PATTERN.exec(url);\n  if (matches) {\n    return matches[1];\n  }\n  return '';\n}\n", "// loaders.gl, MIT license\n\nconst QUERY_STRING_PATTERN = /\\?.*/;\n\nexport function extractQueryString(url): string {\n  const matches = url.match(QUERY_STRING_PATTERN);\n  return matches && matches[0];\n}\n\nexport function stripQueryString(url): string {\n  return url.replace(QUERY_STRING_PATTERN, '');\n}\n", "// loaders.gl, MIT license\n\nimport {isResponse, isBlob} from '../../javascript-utils/is-type';\nimport {parseMIMEType, parseMIMETypeFromURL} from './mime-type-utils';\nimport {stripQueryString} from './url-utils';\n\n/**\n * A loadable resource. Includes:\n * `Response`, `Blob` (`File` is a subclass), string URLs and data URLs\n */\nexport type Resource = Response | Blob | string;\n\n/**\n * Returns the URL associated with this resource.\n * The returned value may include a query string and need further processing.\n * If it cannot determine url, the corresponding value will be an empty string\n *\n * @todo string parameters are assumed to be URLs\n */\nexport function getResourceUrl(resource: unknown): string {\n  // If resource is a `Response`, it contains the information directly as a field\n  if (isResponse(resource)) {\n    const response = resource as Response;\n    return response.url;\n  }\n\n  // If the resource is a Blob or a File (subclass of Blob)\n  if (isBlob(resource)) {\n    const blob = resource as Blob;\n    // File objects have a \"name\" property. Blob objects don't have any\n    // url (name) information\n    return blob.name || '';\n  }\n\n  if (typeof resource === 'string') {\n    return resource;\n  }\n\n  // Unknown\n  return '';\n}\n\n/**\n * Returns the URL associated with this resource.\n * The returned value may include a query string and need further processing.\n * If it cannot determine url, the corresponding value will be an empty string\n *\n * @todo string parameters are assumed to be URLs\n */\nexport function getResourceMIMEType(resource: unknown): string {\n  // If resource is a response, it contains the information directly\n  if (isResponse(resource)) {\n    const response = resource as Response;\n    const contentTypeHeader = response.headers.get('content-type') || '';\n    const noQueryUrl = stripQueryString(response.url);\n    return parseMIMEType(contentTypeHeader) || parseMIMETypeFromURL(noQueryUrl);\n  }\n\n  // If the resource is a Blob or a File (subclass of Blob)\n  if (isBlob(resource)) {\n    const blob = resource as Blob;\n    return blob.type || '';\n  }\n\n  if (typeof resource === 'string') {\n    return parseMIMETypeFromURL(resource);\n  }\n\n  // Unknown\n  return '';\n}\n\n/**\n  * Returns (approximate) content length for a resource if it can be determined.\n  * Returns -1 if content length cannot be determined.\n  * @param resource\n\n  * @note string parameters are NOT assumed to be URLs\n  */\nexport function getResourceContentLength(resource: unknown): number {\n  if (isResponse(resource)) {\n    const response = resource as Response;\n    return response.headers['content-length'] || -1;\n  }\n  if (isBlob(resource)) {\n    const blob = resource as Blob;\n    return blob.size;\n  }\n  if (typeof resource === 'string') {\n    // TODO - handle data URL?\n    return resource.length;\n  }\n  if (resource instanceof ArrayBuffer) {\n    return resource.byteLength;\n  }\n  if (ArrayBuffer.isView(resource)) {\n    return resource.byteLength;\n  }\n  return -1;\n}\n", "import {isResponse} from '../../javascript-utils/is-type';\nimport {getResourceContentLength, getResourceUrl, getResourceMIMEType} from './resource-utils';\n\n/**\n * Returns a Response object\n * Adds content-length header when possible\n *\n * @param resource\n */\nexport async function makeResponse(resource: any): Promise<Response> {\n  if (isResponse(resource)) {\n    return resource;\n  }\n\n  // Add content-length header if possible\n  const headers: {[header: string]: string} = {};\n\n  const contentLength = getResourceContentLength(resource);\n  if (contentLength >= 0) {\n    headers['content-length'] = String(contentLength);\n  }\n\n  // `new Response(File)` does not preserve content-type and URL\n  // so we add them here\n  const url = getResourceUrl(resource);\n  const type = getResourceMIMEType(resource);\n  if (type) {\n    headers['content-type'] = type;\n  }\n\n  // Add a custom header with initial bytes if available\n  const initialDataUrl = await getInitialDataUrl(resource);\n  if (initialDataUrl) {\n    headers['x-first-bytes'] = initialDataUrl;\n  }\n\n  // TODO - is this the best way of handling strings?\n  // Maybe package as data URL instead?\n  if (typeof resource === 'string') {\n    // Convert to ArrayBuffer to avoid Response treating it as a URL\n    resource = new TextEncoder().encode(resource);\n  }\n\n  // Attempt to create a Response from the resource, adding headers and setting url\n  const response = new Response(resource, {headers});\n  // We can't control `Response.url` via constructor, use a property override to record URL.\n  Object.defineProperty(response, 'url', {value: url});\n  return response;\n}\n\n/**\n * Checks response status (async) and throws a helpful error message if status is not OK.\n * @param response\n */\nexport async function checkResponse(response: Response): Promise<void> {\n  if (!response.ok) {\n    const message = await getResponseError(response);\n    throw new Error(message);\n  }\n}\n\n/**\n * Checks response status (sync) and throws a helpful error message if status is not OK.\n * @param response\n */\nexport function checkResponseSync(response: Response): void {\n  if (!response.ok) {\n    let message = `${response.status} ${response.statusText}`;\n    message = message.length > 60 ? `${message.slice(0, 60)}...` : message;\n    throw new Error(message);\n  }\n}\n\n// HELPERS\n\nasync function getResponseError(response): Promise<string> {\n  let message = `Failed to fetch resource ${response.url} (${response.status}): `;\n  try {\n    const contentType = response.headers.get('Content-Type');\n    let text = response.statusText;\n    if (contentType.includes('application/json')) {\n      text += ` ${await response.text()}`;\n    }\n    message += text;\n    message = message.length > 60 ? `${message.slice(0, 60)}...` : message;\n  } catch (error) {\n    // eslint forbids return in a finally statement, so we just catch here\n  }\n  return message;\n}\n\nasync function getInitialDataUrl(resource): Promise<string | null> {\n  const INITIAL_DATA_LENGTH = 5;\n  if (typeof resource === 'string') {\n    return `data:,${resource.slice(0, INITIAL_DATA_LENGTH)}`;\n  }\n  if (resource instanceof Blob) {\n    const blobSlice = resource.slice(0, 5);\n    return await new Promise((resolve) => {\n      const reader = new FileReader();\n      reader.onload = (event) => resolve(event?.target?.result as string);\n      reader.readAsDataURL(blobSlice);\n    });\n  }\n  if (resource instanceof ArrayBuffer) {\n    const slice = resource.slice(0, INITIAL_DATA_LENGTH);\n    const base64 = arrayBufferToBase64(slice);\n    return `data:base64,${base64}`;\n  }\n  return null;\n}\n\n// https://stackoverflow.com/questions/9267899/arraybuffer-to-base64-encoded-string\nfunction arrayBufferToBase64(buffer) {\n  let binary = '';\n  const bytes = new Uint8Array(buffer);\n  for (let i = 0; i < bytes.byteLength; i++) {\n    binary += String.fromCharCode(bytes[i]);\n  }\n  return btoa(binary);\n}\n", "import {resolvePath} from '@loaders.gl/loader-utils';\nimport {makeResponse} from '../utils/response-utils';\n// import {getErrorMessageFromResponse} from './fetch-error-message';\n\n/**\n * fetch compatible function\n * Reads file data from:\n * - http/http urls\n * - data urls\n * - File/Blob objects\n * Leverages `@loaders.gl/polyfills` for Node.js support\n * Respects pathPrefix and file aliases\n */\nexport async function fetchFile(\n  url: string | Blob,\n  options?: RequestInit & {fetch?: RequestInit | Function}\n): Promise<Response> {\n  if (typeof url === 'string') {\n    url = resolvePath(url);\n\n    let fetchOptions: RequestInit = options as RequestInit;\n    if (options?.fetch && typeof options?.fetch !== 'function') {\n      fetchOptions = options.fetch;\n    }\n\n    return await fetch(url, fetchOptions);\n  }\n\n  return await makeResponse(url);\n}\n", "import type {Loader} from '@loaders.gl/loader-utils';\nimport {assert} from '@loaders.gl/loader-utils';\n\nexport function isLoaderObject(loader?: any): boolean {\n  if (!loader) {\n    return false;\n  }\n\n  if (Array.isArray(loader)) {\n    loader = loader[0];\n  }\n\n  const hasExtensions = Array.isArray(loader?.extensions);\n\n  /* Now handled by types and worker loaders do not have these\n  let hasParser =\n    loader.parseTextSync ||\n    loader.parseSync ||\n    loader.parse ||\n    loader.parseStream || // TODO Remove, Replace with parseInBatches\n    loader.parseInBatches;\n  */\n\n  return hasExtensions;\n}\n\nexport function normalizeLoader(loader: Loader): Loader {\n  // This error is fairly easy to trigger by mixing up import statements etc\n  // So we make an exception and add a developer error message for this case\n  // To help new users from getting stuck here\n  assert(loader, 'null loader');\n  assert(isLoaderObject(loader), 'invalid loader');\n\n  // NORMALIZE [LOADER, OPTIONS] => LOADER\n\n  // If [loader, options], create a new loaders object with options merged in\n  let options;\n  if (Array.isArray(loader)) {\n    options = loader[1];\n    loader = loader[0];\n    loader = {\n      ...loader,\n      options: {...loader.options, ...options}\n    };\n  }\n\n  // NORMALIZE text and binary flags\n  // Ensure at least one of text/binary flags are properly set\n\n  // @ts-expect-error\n  if (loader?.parseTextSync || loader?.parseText) {\n    loader.text = true;\n  }\n\n  if (!loader.text) {\n    loader.binary = true;\n  }\n\n  return loader;\n}\n", "// based on https://github.com/cheton/is-electron\n// https://github.com/electron/electron/issues/2288\n/* eslint-disable complexity */\nexport default function isElectron(mockUserAgent?: string): boolean {\n  // Renderer process\n  if (\n    typeof window !== 'undefined' &&\n    typeof window.process === 'object' &&\n    // @ts-expect-error\n    window.process.type === 'renderer'\n  ) {\n    return true;\n  }\n  // Main process\n  if (\n    typeof process !== 'undefined' &&\n    typeof process.versions === 'object' &&\n    // eslint-disable-next-line\n    Boolean(process.versions['electron'])\n  ) {\n    return true;\n  }\n  // Detect the user agent when the `nodeIntegration` option is set to true\n  const realUserAgent =\n    typeof navigator === 'object' && typeof navigator.userAgent === 'string' && navigator.userAgent;\n  const userAgent = mockUserAgent || realUserAgent;\n  if (userAgent && userAgent.indexOf('Electron') >= 0) {\n    return true;\n  }\n  return false;\n}\n", "// This function is needed in initialization stages,\n// make sure it can be imported in isolation\n\nimport isElectron from './is-electron';\n\nexport default function isBrowser(): boolean {\n  // Check if in browser by duck-typing Node context\n  const isNode =\n    // @ts-expect-error\n    typeof process === 'object' && String(process) === '[object process]' && !process.browser;\n\n  return !isNode || isElectron();\n}\n\n// document does not exist on worker thread\nexport function isBrowserMainThread(): boolean {\n  return isBrowser() && typeof document !== 'undefined';\n}\n", "// Do not name these variables the same as the global objects - will break bundling\nconst global_ = globalThis;\n// eslint-disable-next-line consistent-this\nconst self_ = globalThis.self || globalThis.window || globalThis.global;\nconst window_ = (globalThis.window || globalThis.self || globalThis.global) as unknown as Window;\nconst document_ = globalThis.document || ({} as Document);\nconst process_ = globalThis.process || {};\nconst console_ = globalThis.console;\nconst navigator_ = globalThis.navigator || ({} as Navigator);\n\nexport {\n  global_ as global,\n  self_ as self,\n  window_ as window,\n  document_ as document,\n  process_ as process,\n  console_ as console,\n  navigator_ as navigator\n};\n", "import checkIfBrowser from '../lib/is-browser';\n\nexport {self, window, global, document, process, console} from '../lib/globals';\n\n// Extract injected version from package.json (injected by babel plugin)\n// @ts-expect-error\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'untranspiled source';\n\nexport const isBrowser = checkIfBrowser();\n", "// probe.gl, MIT license\n\nexport type StorageType = 'sessionStorage' | 'localStorage';\n\nfunction getStorage(type: StorageType): Storage | null {\n  try {\n    const storage: Storage = window[type];\n    const x = '__storage_test__';\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return storage;\n  } catch (e) {\n    return null;\n  }\n}\n\n// Store keys in local storage via simple interface\nexport class LocalStorage<Configuration extends {}> {\n  storage: Storage | null;\n  id: string;\n  config: Required<Configuration>;\n\n  constructor(\n    id: string,\n    defaultConfig: Required<Configuration>,\n    type: StorageType = 'sessionStorage'\n  ) {\n    this.storage = getStorage(type);\n    this.id = id;\n    this.config = defaultConfig;\n    this._loadConfiguration();\n  }\n\n  getConfiguration(): Required<Configuration> {\n    return this.config;\n  }\n\n  setConfiguration(configuration: Configuration): void {\n    Object.assign(this.config, configuration);\n    if (this.storage) {\n      const serialized = JSON.stringify(this.config);\n      this.storage.setItem(this.id, serialized);\n    }\n  }\n\n  // Get config from persistent store, if available\n  _loadConfiguration() {\n    let configuration = {};\n    if (this.storage) {\n      const serializedConfiguration = this.storage.getItem(this.id);\n      configuration = serializedConfiguration ? JSON.parse(serializedConfiguration) : {};\n    }\n    Object.assign(this.config, configuration);\n    return this;\n  }\n}\n", "// probe.gl, MIT license\n\nexport type FormatValueOptions = {\n  isInteger?: boolean;\n  maxElts?: number;\n  size?: number;\n};\n\n/**\n * Format time\n */\nexport function formatTime(ms: number): string {\n  let formatted;\n  if (ms < 10) {\n    formatted = `${ms.toFixed(2)}ms`;\n  } else if (ms < 100) {\n    formatted = `${ms.toFixed(1)}ms`;\n  } else if (ms < 1000) {\n    formatted = `${ms.toFixed(0)}ms`;\n  } else {\n    formatted = `${(ms / 1000).toFixed(2)}s`;\n  }\n  return formatted;\n}\n\nexport function leftPad(string: string, length: number = 8): string {\n  const padLength = Math.max(length - string.length, 0);\n  return `${' '.repeat(padLength)}${string}`;\n}\n\nexport function rightPad(string: string, length: number = 8): string {\n  const padLength = Math.max(length - string.length, 0);\n  return `${string}${' '.repeat(padLength)}`;\n}\n\nexport function formatValue(v: unknown, options: FormatValueOptions = {}): string {\n  const EPSILON = 1e-16;\n  const {isInteger = false} = options;\n  if (Array.isArray(v) || ArrayBuffer.isView(v)) {\n    return formatArrayValue(v, options);\n  }\n  if (!Number.isFinite(v)) {\n    return String(v);\n  }\n  // @ts-expect-error\n  if (Math.abs(v) < EPSILON) {\n    return isInteger ? '0' : '0.';\n  }\n  if (isInteger) {\n    // @ts-expect-error\n    return v.toFixed(0);\n  }\n  // @ts-expect-error\n  if (Math.abs(v) > 100 && Math.abs(v) < 10000) {\n    // @ts-expect-error\n    return v.toFixed(0);\n  }\n  // @ts-expect-error\n  const string = v.toPrecision(2);\n  const decimal = string.indexOf('.0');\n  return decimal === string.length - 2 ? string.slice(0, -1) : string;\n}\n\n/** Helper to formatValue */\nfunction formatArrayValue(v: any, options: FormatValueOptions) {\n  const {maxElts = 16, size = 1} = options;\n  let string = '[';\n  for (let i = 0; i < v.length && i < maxElts; ++i) {\n    if (i > 0) {\n      string += `,${i % size === 0 ? ' ' : ''}`;\n    }\n    string += formatValue(v[i], options);\n  }\n  const terminator = v.length > maxElts ? '...' : ']';\n  return `${string}${terminator}`;\n}\n\n/**\n * Log an image to the console (uses browser specific console formatting styles)\n * Inspired by https://github.com/hughsk/console-image (MIT license)\n */\nexport function formatImage(image: any, message: string, scale: number, maxWidth: number = 600) {\n  const imageUrl = image.src.replace(/\\(/g, '%28').replace(/\\)/g, '%29');\n\n  if (image.width > maxWidth) {\n    scale = Math.min(scale, maxWidth / image.width);\n  }\n\n  const width = image.width * scale;\n  const height = image.height * scale;\n\n  const style = [\n    'font-size:1px;',\n    `padding:${Math.floor(height / 2)}px ${Math.floor(width / 2)}px;`,\n    `line-height:${height}px;`,\n    `background:url(${imageUrl});`,\n    `background-size:${width}px ${height}px;`,\n    'color:transparent;'\n  ].join('');\n\n  return [`${message} %c+`, style];\n}\n", "import {isBrowser} from '@probe.gl/env';\n\nexport enum COLOR {\n  BLACK = 30,\n  RED = 31,\n  GREEN = 32,\n  YELLOW = 33,\n  BLUE = 34,\n  MAGENTA = 35,\n  CYAN = 36,\n  WHITE = 37,\n\n  BRIGHT_BLACK = 90,\n  BRIGHT_RED = 91,\n  BRIGHT_GREEN = 92,\n  BRIGHT_YELLOW = 93,\n  BRIGHT_BLUE = 94,\n  BRIGHT_MAGENTA = 95,\n  BRIGHT_CYAN = 96,\n  BRIGHT_WHITE = 97\n}\n\nconst BACKGROUND_INCREMENT = 10;\n\nfunction getColor(color: string | COLOR): number {\n  if (typeof color !== 'string') {\n    return color;\n  }\n  color = color.toUpperCase();\n  return COLOR[color] || COLOR.WHITE;\n}\n\nexport function addColor(\n  string: string,\n  color: string | COLOR,\n  background?: string | COLOR\n): string {\n  if (!isBrowser && typeof string === 'string') {\n    if (color) {\n      const colorCode = getColor(color);\n      string = `\\u001b[${colorCode}m${string}\\u001b[39m`;\n    }\n    if (background) {\n      // background colors values are +10\n      const colorCode = getColor(background);\n      string = `\\u001b[${colorCode + BACKGROUND_INCREMENT}m${string}\\u001b[49m`;\n    }\n  }\n  return string;\n}\n", "// Copyright (c) 2015 - 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\n/**\n * Binds the \"this\" argument of all functions on a class instance to the instance\n * @param obj - class instance (typically a react component)\n */\nexport function autobind(obj: object, predefined = ['constructor']): void {\n  const proto = Object.getPrototypeOf(obj);\n  const propNames = Object.getOwnPropertyNames(proto);\n\n  const object = obj as Record<string, unknown>;\n  for (const key of propNames) {\n    const value = object[key];\n    if (typeof value === 'function') {\n      if (!predefined.find(name => key === name)) {\n        object[key] = value.bind(obj);\n      }\n    }\n  }\n}\n", "export default function assert(condition: unknown, message?: string): asserts condition {\n  if (!condition) {\n    throw new Error(message || 'Assertion failed');\n  }\n}\n", "// probe.gl, MIT license\n\nimport {window, process, isBrowser} from '@probe.gl/env';\n\n/** Get best timer available. */\nexport function getHiResTimestamp() {\n  let timestamp;\n  if (isBrowser() && window.performance) {\n    timestamp = window?.performance?.now?.();\n  } else if ('hrtime' in process) {\n    // @ts-ignore\n    const timeParts = process?.hrtime?.();\n    timestamp = timeParts[0] * 1000 + timeParts[1] / 1e6;\n  } else {\n    timestamp = Date.now();\n  }\n\n  return timestamp;\n}\n", "// probe.gl, MIT license\n\n/* eslint-disable no-console */\nimport {VERSION, isBrowser} from '@probe.gl/env';\nimport {LocalStorage} from './utils/local-storage';\nimport {formatImage, formatTime, leftPad} from './utils/formatters';\nimport {addColor} from './utils/color';\nimport {autobind} from './utils/autobind';\nimport assert from './utils/assert';\nimport {getHiResTimestamp} from './utils/hi-res-timestamp';\n\n/** \"Global\" log configuration settings */\ntype LogConfiguration = {\n  enabled?: boolean;\n  level?: number;\n  [key: string]: unknown;\n};\n\n/** Options when logging a message */\ntype LogOptions = {\n  method?: Function;\n  time?: boolean;\n  total?: number;\n  delta?: number;\n  tag?: string;\n  message?: string;\n  once?: boolean;\n  nothrottle?: boolean;\n  args?: any;\n};\n\ntype LogFunction = () => void;\n\ntype Table = Record<string, any>;\n\n// Instrumentation in other packages may override console methods, so preserve them here\nconst originalConsole = {\n  debug: isBrowser() ? console.debug || console.log : console.log,\n  log: console.log,\n  info: console.info,\n  warn: console.warn,\n  error: console.error\n};\n\nconst DEFAULT_LOG_CONFIGURATION: Required<LogConfiguration> = {\n  enabled: true,\n  level: 0\n};\n\nfunction noop() {} // eslint-disable-line @typescript-eslint/no-empty-function\n\nconst cache = {};\nconst ONCE = {once: true};\n\n/** A console wrapper */\n\nexport class Log {\n  static VERSION = VERSION;\n\n  id: string;\n  VERSION: string = VERSION;\n  _startTs: number = getHiResTimestamp();\n  _deltaTs: number = getHiResTimestamp();\n  _storage: LocalStorage<LogConfiguration>;\n  userData = {};\n\n  // TODO - fix support from throttling groups\n  LOG_THROTTLE_TIMEOUT: number = 0; // Time before throttled messages are logged again\n\n  constructor({id} = {id: ''}) {\n    this.id = id;\n    this.userData = {};\n    this._storage = new LocalStorage<LogConfiguration>(\n      `__probe-${this.id}__`,\n      DEFAULT_LOG_CONFIGURATION\n    );\n\n    this.timeStamp(`${this.id} started`);\n\n    autobind(this);\n    Object.seal(this);\n  }\n\n  set level(newLevel: number) {\n    this.setLevel(newLevel);\n  }\n\n  get level(): number {\n    return this.getLevel();\n  }\n\n  isEnabled(): boolean {\n    return this._storage.config.enabled;\n  }\n\n  getLevel(): number {\n    return this._storage.config.level;\n  }\n\n  /** @return milliseconds, with fractions */\n  getTotal(): number {\n    return Number((getHiResTimestamp() - this._startTs).toPrecision(10));\n  }\n\n  /** @return milliseconds, with fractions */\n  getDelta(): number {\n    return Number((getHiResTimestamp() - this._deltaTs).toPrecision(10));\n  }\n\n  /** @deprecated use logLevel */\n  set priority(newPriority: number) {\n    this.level = newPriority;\n  }\n\n  /** @deprecated use logLevel */\n  get priority(): number {\n    return this.level;\n  }\n\n  /** @deprecated use logLevel */\n  getPriority(): number {\n    return this.level;\n  }\n\n  // Configure\n\n  enable(enabled: boolean = true): this {\n    this._storage.setConfiguration({enabled});\n    return this;\n  }\n\n  setLevel(level: number): this {\n    this._storage.setConfiguration({level});\n    return this;\n  }\n\n  /** return the current status of the setting */\n  get(setting: string): any {\n    return this._storage.config[setting];\n  }\n\n  // update the status of the setting\n  set(setting: string, value: any): void {\n    this._storage.setConfiguration({[setting]: value});\n  }\n\n  /** Logs the current settings as a table */\n  settings(): void {\n    if (console.table) {\n      console.table(this._storage.config);\n    } else {\n      console.log(this._storage.config);\n    }\n  }\n\n  // Unconditional logging\n\n  assert(condition: unknown, message?: string): asserts condition {\n    assert(condition, message);\n  }\n\n  /** Warn, but only once, no console flooding */\n  warn(message: string, ...args: unknown[]): LogFunction;\n  warn(message: string): LogFunction {\n    return this._getLogFunction(0, message, originalConsole.warn, arguments, ONCE);\n  }\n\n  /** Print an error */\n  error(message: string, ...args: unknown[]): LogFunction;\n  error(message: string): LogFunction {\n    return this._getLogFunction(0, message, originalConsole.error, arguments);\n  }\n\n  /** Print a deprecation warning */\n  deprecated(oldUsage: string, newUsage: string): LogFunction {\n    return this.warn(`\\`${oldUsage}\\` is deprecated and will be removed \\\nin a later version. Use \\`${newUsage}\\` instead`);\n  }\n\n  /** Print a removal warning */\n  removed(oldUsage: string, newUsage: string): LogFunction {\n    return this.error(`\\`${oldUsage}\\` has been removed. Use \\`${newUsage}\\` instead`);\n  }\n\n  // Conditional logging\n\n  /** Log to a group */\n  probe(logLevel, message?, ...args: unknown[]): LogFunction;\n  probe(logLevel, message?): LogFunction {\n    return this._getLogFunction(logLevel, message, originalConsole.log, arguments, {\n      time: true,\n      once: true\n    });\n  }\n\n  /** Log a debug message */\n  log(logLevel, message?, ...args: unknown[]): LogFunction;\n  log(logLevel, message?): LogFunction {\n    return this._getLogFunction(logLevel, message, originalConsole.debug, arguments);\n  }\n\n  /** Log a normal message */\n  info(logLevel, message?, ...args: unknown[]): LogFunction;\n  info(logLevel, message?): LogFunction {\n    return this._getLogFunction(logLevel, message, console.info, arguments);\n  }\n\n  /** Log a normal message, but only once, no console flooding */\n  once(logLevel, message?, ...args: unknown[]): LogFunction;\n  once(logLevel, message?) {\n    return this._getLogFunction(\n      logLevel,\n      message,\n      originalConsole.debug || originalConsole.info,\n      arguments,\n      ONCE\n    );\n  }\n\n  /** Logs an object as a table */\n  table(logLevel, table?, columns?): LogFunction {\n    if (table) {\n      return this._getLogFunction(\n        logLevel,\n        table,\n        console.table || noop,\n        (columns && [columns]) as unknown as IArguments,\n        {\n          tag: getTableHeader(table)\n        }\n      );\n    }\n    return noop;\n  }\n\n  /** logs an image under Chrome */\n  image({\n    logLevel,\n    priority,\n    image,\n    message = '',\n    scale = 1\n  }: {\n    logLevel?: number;\n    priority?: number;\n    image: any;\n    message?: string;\n    scale?: number;\n  }): LogFunction {\n    if (!this._shouldLog(logLevel || priority)) {\n      return noop;\n    }\n    return isBrowser()\n      ? logImageInBrowser({image, message, scale})\n      : logImageInNode({image, message, scale});\n  }\n\n  time(logLevel, message) {\n    return this._getLogFunction(logLevel, message, console.time ? console.time : console.info);\n  }\n\n  timeEnd(logLevel, message) {\n    return this._getLogFunction(\n      logLevel,\n      message,\n      console.timeEnd ? console.timeEnd : console.info\n    );\n  }\n\n  timeStamp(logLevel, message?) {\n    return this._getLogFunction(logLevel, message, console.timeStamp || noop);\n  }\n\n  group(logLevel, message, opts = {collapsed: false}) {\n    const options = normalizeArguments({logLevel, message, opts});\n    const {collapsed} = opts;\n    // @ts-expect-error\n    options.method = (collapsed ? console.groupCollapsed : console.group) || console.info;\n\n    return this._getLogFunction(options);\n  }\n\n  groupCollapsed(logLevel, message, opts = {}) {\n    return this.group(logLevel, message, Object.assign({}, opts, {collapsed: true}));\n  }\n\n  groupEnd(logLevel) {\n    return this._getLogFunction(logLevel, '', console.groupEnd || noop);\n  }\n\n  // EXPERIMENTAL\n\n  withGroup(logLevel: number, message: string, func: Function): void {\n    this.group(logLevel, message)();\n\n    try {\n      func();\n    } finally {\n      this.groupEnd(logLevel)();\n    }\n  }\n\n  trace(): void {\n    if (console.trace) {\n      console.trace();\n    }\n  }\n\n  // PRIVATE METHODS\n\n  /** Deduces log level from a variety of arguments */\n  _shouldLog(logLevel: unknown): boolean {\n    return this.isEnabled() && this.getLevel() >= normalizeLogLevel(logLevel);\n  }\n\n  _getLogFunction(\n    logLevel: unknown,\n    message?: unknown,\n    method?: Function,\n    args?: IArguments,\n    opts?: LogOptions\n  ): LogFunction {\n    if (this._shouldLog(logLevel)) {\n      // normalized opts + timings\n      opts = normalizeArguments({logLevel, message, args, opts});\n      method = method || opts.method;\n      assert(method);\n\n      opts.total = this.getTotal();\n      opts.delta = this.getDelta();\n      // reset delta timer\n      this._deltaTs = getHiResTimestamp();\n\n      const tag = opts.tag || opts.message;\n\n      if (opts.once && tag) {\n        if (!cache[tag]) {\n          cache[tag] = getHiResTimestamp();\n        } else {\n          return noop;\n        }\n      }\n\n      // TODO - Make throttling work with groups\n      // if (opts.nothrottle || !throttle(tag, this.LOG_THROTTLE_TIMEOUT)) {\n      //   return noop;\n      // }\n\n      message = decorateMessage(this.id, opts.message, opts);\n\n      // Bind console function so that it can be called after being returned\n      return method.bind(console, message, ...opts.args);\n    }\n    return noop;\n  }\n}\n\n/**\n * Get logLevel from first argument:\n * - log(logLevel, message, args) => logLevel\n * - log(message, args) => 0\n * - log({logLevel, ...}, message, args) => logLevel\n * - log({logLevel, message, args}) => logLevel\n */\nfunction normalizeLogLevel(logLevel: unknown): number {\n  if (!logLevel) {\n    return 0;\n  }\n  let resolvedLevel;\n\n  switch (typeof logLevel) {\n    case 'number':\n      resolvedLevel = logLevel;\n      break;\n\n    case 'object':\n      // Backward compatibility\n      // TODO - deprecate `priority`\n      // @ts-expect-error\n      resolvedLevel = logLevel.logLevel || logLevel.priority || 0;\n      break;\n\n    default:\n      return 0;\n  }\n  // 'log level must be a number'\n  assert(Number.isFinite(resolvedLevel) && resolvedLevel >= 0);\n\n  return resolvedLevel;\n}\n\n/**\n * \"Normalizes\" the various argument patterns into an object with known types\n * - log(logLevel, message, args) => {logLevel, message, args}\n * - log(message, args) => {logLevel: 0, message, args}\n * - log({logLevel, ...}, message, args) => {logLevel, message, args}\n * - log({logLevel, message, args}) => {logLevel, message, args}\n */\nexport function normalizeArguments(opts: {\n  logLevel;\n  message;\n  collapsed?: boolean;\n  args?: IArguments | undefined;\n  opts?;\n}): {\n  logLevel: number;\n  message: string;\n  args: any[];\n} {\n  const {logLevel, message} = opts;\n  opts.logLevel = normalizeLogLevel(logLevel);\n\n  // We use `arguments` instead of rest parameters (...args) because IE\n  // does not support the syntax. Rest parameters is transpiled to code with\n  // perf impact. Doing it here instead avoids constructing args when logging is\n  // disabled.\n  // TODO - remove when/if IE support is dropped\n  const args: any[] = opts.args ? Array.from(opts.args) : [];\n  // args should only contain arguments that appear after `message`\n  // eslint-disable-next-line no-empty\n  while (args.length && args.shift() !== message) {}\n\n  switch (typeof logLevel) {\n    case 'string':\n    case 'function':\n      if (message !== undefined) {\n        args.unshift(message);\n      }\n      opts.message = logLevel;\n      break;\n\n    case 'object':\n      Object.assign(opts, logLevel);\n      break;\n\n    default:\n  }\n\n  // Resolve functions into strings by calling them\n  if (typeof opts.message === 'function') {\n    opts.message = opts.message();\n  }\n  const messageType = typeof opts.message;\n  // 'log message must be a string' or object\n  assert(messageType === 'string' || messageType === 'object');\n\n  // original opts + normalized opts + opts arg + fixed up message\n  return Object.assign(opts, {args}, opts.opts);\n}\n\nfunction decorateMessage(id, message, opts) {\n  if (typeof message === 'string') {\n    const time = opts.time ? leftPad(formatTime(opts.total)) : '';\n    message = opts.time ? `${id}: ${time}  ${message}` : `${id}: ${message}`;\n    message = addColor(message, opts.color, opts.background);\n  }\n  return message;\n}\n\n/** @deprecated Function removed */\nfunction logImageInNode({image, message = '', scale = 1}) {\n  console.warn('removed');\n  return noop;\n}\n\nfunction logImageInBrowser({image, message = '', scale = 1}) {\n  if (typeof image === 'string') {\n    const img = new Image();\n    img.onload = () => {\n      const args = formatImage(img, message, scale);\n      console.log(...args);\n    };\n    img.src = image;\n    return noop;\n  }\n  const element = image.nodeName || '';\n  if (element.toLowerCase() === 'img') {\n    console.log(...formatImage(image, message, scale));\n    return noop;\n  }\n  if (element.toLowerCase() === 'canvas') {\n    const img = new Image();\n    img.onload = () => console.log(...formatImage(img, message, scale));\n    img.src = image.toDataURL();\n    return noop;\n  }\n  return noop;\n}\n\nfunction getTableHeader(table: Table): string {\n  for (const key in table) {\n    for (const title in table[key]) {\n      return title || 'untitled';\n    }\n  }\n  return 'empty';\n}\n", "// @ts-nocheck\n/* eslint-disable */\nglobalThis.probe = {};\n", "import {Log} from './log';\n\n// DEFAULT EXPORT IS A LOG INSTANCE\nexport default new Log({id: '@probe.gl/log'});\n\n// LOGGING\nexport {Log} from './log';\nexport {COLOR} from './utils/color';\n\n// UTILITIES\nexport {addColor} from './utils/color';\nexport {leftPad, rightPad} from './utils/formatters';\nexport {autobind} from './utils/autobind';\nexport {LocalStorage} from './utils/local-storage';\nexport {getHiResTimestamp} from './utils/hi-res-timestamp';\n\nimport './init';\n", "// probe.gl Log compatible loggers\nimport {Log} from '@probe.gl/log';\n\nexport const probeLog = new Log({id: 'loaders.gl'});\n\n// Logs nothing\nexport class NullLog {\n  log() {\n    return () => {};\n  }\n  info() {\n    return () => {};\n  }\n  warn() {\n    return () => {};\n  }\n  error() {\n    return () => {};\n  }\n}\n\n// Logs to console\nexport class ConsoleLog {\n  console;\n\n  constructor() {\n    this.console = console; // eslint-disable-line\n  }\n  log(...args) {\n    return this.console.log.bind(this.console, ...args);\n  }\n  info(...args) {\n    return this.console.info.bind(this.console, ...args);\n  }\n  warn(...args) {\n    return this.console.warn.bind(this.console, ...args);\n  }\n  error(...args) {\n    return this.console.error.bind(this.console, ...args);\n  }\n}\n", "import type {LoaderOptions} from '@loaders.gl/loader-utils';\nimport {isBrowser} from '@loaders.gl/loader-utils';\nimport {ConsoleLog} from './loggers';\n\nexport const DEFAULT_LOADER_OPTIONS: LoaderOptions = {\n  // baseUri\n  fetch: null,\n  mimeType: undefined,\n  nothrow: false,\n  log: new ConsoleLog(), // A probe.gl compatible (`log.log()()` syntax) that just logs to console\n\n  CDN: 'https://unpkg.com/@loaders.gl',\n  worker: true, // By default, use worker if provided by loader.\n  maxConcurrency: 3, // How many worker instances should be created for each loader.\n  maxMobileConcurrency: 1, // How many worker instances should be created for each loader on mobile devices.\n  reuseWorkers: isBrowser, // By default reuse workers in browser (Node.js refuses to terminate if browsers are running)\n  _nodeWorkers: false, // By default do not support node workers\n  _workerType: '', // 'test' to use locally generated workers\n\n  limit: 0,\n  _limitMB: 0,\n  batchSize: 'auto',\n  batchDebounceMs: 0,\n  metadata: false, // TODO - currently only implemented for parseInBatches, adds initial metadata batch,\n  transforms: []\n};\n\nexport const REMOVED_LOADER_OPTIONS = {\n  throws: 'nothrow',\n  dataType: '(no longer used)',\n  uri: 'baseUri',\n  // Warn if fetch options are used on top-level\n  method: 'fetch.method',\n  headers: 'fetch.headers',\n  body: 'fetch.body',\n  mode: 'fetch.mode',\n  credentials: 'fetch.credentials',\n  cache: 'fetch.cache',\n  redirect: 'fetch.redirect',\n  referrer: 'fetch.referrer',\n  referrerPolicy: 'fetch.referrerPolicy',\n  integrity: 'fetch.integrity',\n  keepalive: 'fetch.keepalive',\n  signal: 'fetch.signal'\n};\n", "// loaders.gl, MIT license\n\nimport type {Loader, LoaderOptions} from '@loaders.gl/loader-utils';\nimport {isPureObject, isObject} from '../../javascript-utils/is-type';\nimport {probeLog, NullLog} from './loggers';\nimport {DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS} from './option-defaults';\n\n/**\n * Global state for loaders.gl. Stored on `global.loaders._state`\n */\ntype GlobalLoaderState = {\n  loaderRegistry: Loader[];\n  globalOptions: LoaderOptions;\n};\n\n/**\n * Helper for safely accessing global loaders.gl variables\n * Wraps initialization of global variable in function to defeat overly aggressive tree-shakers\n */\nexport function getGlobalLoaderState(): GlobalLoaderState {\n  // @ts-ignore\n  globalThis.loaders = globalThis.loaders || {};\n  // @ts-ignore\n  const {loaders} = globalThis;\n\n  // Add _state object to keep separate from modules added to globalThis.loaders\n  loaders._state = loaders._state || {};\n  return loaders._state;\n}\n\n/**\n * Store global loader options on the global object to increase chances of cross loaders-version interoperability\n * NOTE: This use case is not reliable but can help when testing new versions of loaders.gl with existing frameworks\n * @returns global loader options merged with default loader options\n */\nexport const getGlobalLoaderOptions = (): LoaderOptions => {\n  const state = getGlobalLoaderState();\n  // Ensure all default loader options from this library are mentioned\n  state.globalOptions = state.globalOptions || {...DEFAULT_LOADER_OPTIONS};\n  return state.globalOptions;\n};\n\n/**\n * Set global loader options\n * @param options\n */\nexport function setGlobalOptions(options: LoaderOptions): void {\n  const state = getGlobalLoaderState();\n  const globalOptions = getGlobalLoaderOptions();\n  state.globalOptions = normalizeOptionsInternal(globalOptions, options);\n}\n\n/**\n * Merges options with global opts and loader defaults, also injects baseUri\n * @param options\n * @param loader\n * @param loaders\n * @param url\n */\nexport function normalizeOptions(\n  options: LoaderOptions,\n  loader: Loader,\n  loaders?: Loader[],\n  url?: string\n): LoaderOptions {\n  loaders = loaders || [];\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n\n  validateOptions(options, loaders);\n  return normalizeOptionsInternal(loader, options, url);\n}\n\n// VALIDATE OPTIONS\n\n/**\n * Warn for unsupported options\n * @param options\n * @param loaders\n */\nfunction validateOptions(options: LoaderOptions, loaders: Loader[]) {\n  // Check top level options\n  validateOptionsObject(options, null, DEFAULT_LOADER_OPTIONS, REMOVED_LOADER_OPTIONS, loaders);\n  for (const loader of loaders) {\n    // Get the scoped, loader specific options from the user supplied options\n    const idOptions = (options && options[loader.id]) || {};\n\n    // Get scoped, loader specific default and deprecated options from the selected loader\n    const loaderOptions = (loader.options && loader.options[loader.id]) || {};\n    const deprecatedOptions =\n      (loader.deprecatedOptions && loader.deprecatedOptions[loader.id]) || {};\n\n    // Validate loader specific options\n    validateOptionsObject(idOptions, loader.id, loaderOptions, deprecatedOptions, loaders);\n  }\n}\n\n// eslint-disable-next-line max-params, complexity\nfunction validateOptionsObject(\n  options,\n  id: string | null,\n  defaultOptions,\n  deprecatedOptions,\n  loaders: Loader[]\n) {\n  const loaderName = id || 'Top level';\n  const prefix = id ? `${id}.` : '';\n\n  for (const key in options) {\n    // If top level option value is an object it could options for a loader, so ignore\n    const isSubOptions = !id && isObject(options[key]);\n    const isBaseUriOption = key === 'baseUri' && !id;\n    const isWorkerUrlOption = key === 'workerUrl' && id;\n    // <loader>.workerUrl requires special handling as it is now auto-generated and no longer specified as a default option.\n    if (!(key in defaultOptions) && !isBaseUriOption && !isWorkerUrlOption) {\n      // Issue deprecation warnings\n      if (key in deprecatedOptions) {\n        probeLog.warn(\n          `${loaderName} loader option \\'${prefix}${key}\\' no longer supported, use \\'${deprecatedOptions[key]}\\'`\n        )();\n      } else if (!isSubOptions) {\n        const suggestion = findSimilarOption(key, loaders);\n        probeLog.warn(\n          `${loaderName} loader option \\'${prefix}${key}\\' not recognized. ${suggestion}`\n        )();\n      }\n    }\n  }\n}\n\nfunction findSimilarOption(optionKey, loaders) {\n  const lowerCaseOptionKey = optionKey.toLowerCase();\n  let bestSuggestion = '';\n  for (const loader of loaders) {\n    for (const key in loader.options) {\n      if (optionKey === key) {\n        return `Did you mean \\'${loader.id}.${key}\\'?`;\n      }\n      const lowerCaseKey = key.toLowerCase();\n      const isPartialMatch =\n        lowerCaseOptionKey.startsWith(lowerCaseKey) || lowerCaseKey.startsWith(lowerCaseOptionKey);\n      if (isPartialMatch) {\n        bestSuggestion = bestSuggestion || `Did you mean \\'${loader.id}.${key}\\'?`;\n      }\n    }\n  }\n  return bestSuggestion;\n}\n\nfunction normalizeOptionsInternal(loader, options, url?: string) {\n  const loaderDefaultOptions = loader.options || {};\n\n  const mergedOptions = {...loaderDefaultOptions};\n\n  addUrlOptions(mergedOptions, url);\n\n  // LOGGING: options.log can be set to `null` to defeat logging\n  if (mergedOptions.log === null) {\n    mergedOptions.log = new NullLog();\n  }\n\n  mergeNestedFields(mergedOptions, getGlobalLoaderOptions());\n  mergeNestedFields(mergedOptions, options);\n\n  return mergedOptions;\n}\n\n// Merge nested options objects\nfunction mergeNestedFields(mergedOptions, options) {\n  for (const key in options) {\n    // Check for nested options\n    // object in options => either no key in defaultOptions or object in defaultOptions\n    if (key in options) {\n      const value = options[key];\n      if (isPureObject(value) && isPureObject(mergedOptions[key])) {\n        mergedOptions[key] = {\n          ...mergedOptions[key],\n          ...options[key]\n        };\n      } else {\n        mergedOptions[key] = options[key];\n      }\n    }\n    // else: No need to merge nested opts, and the initial merge already copied over the nested options\n  }\n}\n\n/**\n * Harvest information from the url\n * @deprecated This is mainly there to support a hack in the GLTFLoader\n * TODO - baseUri should be a directory, i.e. remove file component from baseUri\n * TODO - extract extension?\n * TODO - extract query parameters?\n * TODO - should these be injected on context instead of options?\n */\nfunction addUrlOptions(options, url?: string) {\n  if (url && !('baseUri' in options)) {\n    options.baseUri = url;\n  }\n}\n", "import {Loader} from '@loaders.gl/loader-utils';\nimport {normalizeLoader} from '../loader-utils/normalize-loader';\nimport {getGlobalLoaderState} from '../loader-utils/option-utils';\n\n// Store global registered loaders on the global object to increase chances of cross loaders-version interoperability\n// This use case is not reliable but can help when testing new versions of loaders.gl with existing frameworks\nconst getGlobalLoaderRegistry = () => {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = state.loaderRegistry || [];\n  return state.loaderRegistry;\n};\n\n/** Register a list of global loaders */\nexport function registerLoaders(loaders: Loader[] | Loader) {\n  const loaderRegistry = getGlobalLoaderRegistry();\n\n  loaders = Array.isArray(loaders) ? loaders : [loaders];\n\n  for (const loader of loaders) {\n    const normalizedLoader = normalizeLoader(loader);\n    if (!loaderRegistry.find((registeredLoader) => normalizedLoader === registeredLoader)) {\n      // add to the beginning of the loaderRegistry, so the last registeredLoader get picked\n      loaderRegistry.unshift(normalizedLoader);\n    }\n  }\n}\n\nexport function getRegisteredLoaders(): Loader[] {\n  return getGlobalLoaderRegistry();\n}\n\n/** @deprecated For testing only  */\nexport function _unregisterLoaders() {\n  const state = getGlobalLoaderState();\n  state.loaderRegistry = [];\n}\n", "// loaders.gl, MIT license\n\nimport type {LoaderContext, LoaderOptions} from '@loaders.gl/loader-utils';\nimport {isObject} from '../../javascript-utils/is-type';\nimport {fetchFile} from '../fetch/fetch-file';\nimport {getGlobalLoaderOptions} from './option-utils';\n\n/**\n * Gets the current fetch function from options and context\n * @param options\n * @param context\n */\nexport function getFetchFunction(\n  options?: LoaderOptions,\n  context?: Omit<LoaderContext, 'fetch'> & Partial<Pick<LoaderContext, 'fetch'>>\n) {\n  const globalOptions = getGlobalLoaderOptions();\n\n  const fetchOptions = options || globalOptions;\n\n  // options.fetch can be a function\n  if (typeof fetchOptions.fetch === 'function') {\n    return fetchOptions.fetch;\n  }\n\n  // options.fetch can be an options object\n  if (isObject(fetchOptions.fetch)) {\n    return (url) => fetchFile(url, fetchOptions as RequestInit);\n  }\n\n  // else refer to context (from parent loader) if available\n  if (context?.fetch) {\n    return context?.fetch;\n  }\n\n  // else return the default fetch function\n  return fetchFile;\n}\n", "import type {IteratorOptions} from './make-iterator';\n\nconst DEFAULT_CHUNK_SIZE = 256 * 1024;\n\n/**\n * Returns an iterator that breaks a big string into chunks and yields them one-by-one as ArrayBuffers\n * @param blob string to iterate over\n * @param options\n * @param options.chunkSize\n */\nexport function* makeStringIterator(\n  string: string,\n  options?: IteratorOptions\n): Iterable<ArrayBuffer> {\n  const chunkSize = options?.chunkSize || DEFAULT_CHUNK_SIZE;\n\n  let offset = 0;\n  const textEncoder = new TextEncoder();\n  while (offset < string.length) {\n    // Create a chunk of the right size\n    const chunkLength = Math.min(string.length - offset, chunkSize);\n    const chunk = string.slice(offset, offset + chunkLength);\n    offset += chunkLength;\n\n    // yield an ArrayBuffer chunk\n    yield textEncoder.encode(chunk);\n  }\n}\n", "import type {IteratorOptions} from './make-iterator';\n\nconst DEFAULT_CHUNK_SIZE = 256 * 1024;\n\n/**\n * Returns an iterator that breaks a big ArrayBuffer into chunks and yields them one-by-one\n * @param blob ArrayBuffer to iterate over\n * @param options\n * @param options.chunkSize\n */\nexport function* makeArrayBufferIterator(\n  arrayBuffer: ArrayBuffer,\n  options: IteratorOptions = {}\n): Iterable<ArrayBuffer> {\n  const {chunkSize = DEFAULT_CHUNK_SIZE} = options;\n\n  let byteOffset = 0;\n\n  while (byteOffset < arrayBuffer.byteLength) {\n    // Create a chunk of the right size\n    const chunkByteLength = Math.min(arrayBuffer.byteLength - byteOffset, chunkSize);\n    const chunk = new ArrayBuffer(chunkByteLength);\n\n    // Copy data from the big chunk\n    const sourceArray = new Uint8Array(arrayBuffer, byteOffset, chunkByteLength);\n    const chunkArray = new Uint8Array(chunk);\n    chunkArray.set(sourceArray);\n\n    // yield the chunk\n    byteOffset += chunkByteLength;\n    yield chunk;\n  }\n}\n", "import type {IteratorOptions} from './make-iterator';\n\nconst DEFAULT_CHUNK_SIZE = 1024 * 1024; // 1MB  biggest value that keeps UI responsive\n\n/**\n * Returns an iterator that breaks a big Blob into chunks and yields them one-by-one\n * @param blob Blob or File object\n * @param options\n * @param options.chunkSize\n */\nexport async function* makeBlobIterator(\n  blob: Blob,\n  options?: IteratorOptions\n): AsyncIterable<ArrayBuffer> {\n  const chunkSize = options?.chunkSize || DEFAULT_CHUNK_SIZE;\n\n  let offset = 0;\n  while (offset < blob.size) {\n    const end = offset + chunkSize;\n\n    const chunk = await blob.slice(offset, end).arrayBuffer();\n\n    offset = end;\n    yield chunk;\n  }\n}\n", "import type {Readable} from 'stream';\nimport {isBrowser, toArrayBuffer} from '@loaders.gl/loader-utils';\n\nexport type StreamIteratorOptions = {\n  _streamReadAhead?: boolean;\n};\n\n/**\n * Returns an async iterable that reads from a stream (works in both Node.js and browsers)\n * @param stream stream to iterator over\n */\nexport function makeStreamIterator(\n  stream: ReadableStream | Readable,\n  options?: StreamIteratorOptions\n): AsyncIterable<ArrayBuffer> {\n  return isBrowser\n    ? makeBrowserStreamIterator(stream as ReadableStream, options)\n    : makeNodeStreamIterator(stream as Readable, options);\n}\n\n/**\n * Returns an async iterable that reads from a DOM (browser) stream\n * @param stream stream to iterate from\n * @see https://jakearchibald.com/2017/async-iterators-and-generators/#making-streams-iterate\n */\nasync function* makeBrowserStreamIterator(\n  stream: ReadableStream,\n  options?: StreamIteratorOptions\n): AsyncIterable<ArrayBuffer> {\n  // WhatWG: stream is supposed to have a `getIterator` method\n  // if (typeof stream.getIterator === 'function') {\n  //   return stream.getIterator();\n  // }\n  // if (typeof stream[Symbol.asyncIterator] === 'function') {\n  //   return makeToArrayBufferIterator(stream);\n  // }\n\n  // In the browser, we first need to get a lock on the stream\n  const reader = stream.getReader();\n\n  let nextBatchPromise: Promise<{done?: boolean; value?: Uint8Array}> | undefined;\n\n  try {\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n      const currentBatchPromise = nextBatchPromise || reader.read();\n      // Issue a read for an additional batch, while we await the next batch\n      // Idea is to make fetching happen in parallel with processing / parsing\n      if (options?._streamReadAhead) {\n        nextBatchPromise = reader.read();\n      }\n      // Read from the stream\n      // value is a Uint8Array\n      const {done, value} = await currentBatchPromise;\n      // Exit if we're done\n      if (done) {\n        return;\n      }\n      // Else yield the chunk\n      yield toArrayBuffer(value);\n    }\n  } catch (error) {\n    // TODO - examples makes it look like this should always be called,\n    // but that generates exceptions so only call it if we do not reach the end\n    reader.releaseLock();\n  }\n}\n\n/**\n * Returns an async iterable that reads from a DOM (browser) stream\n * @param stream stream to iterate from\n * @note Requires Node.js >= 10\n */\nasync function* makeNodeStreamIterator(\n  stream: Readable,\n  options?: StreamIteratorOptions\n): AsyncIterable<ArrayBuffer> {\n  // Hacky test for node version to ensure we don't call bad polyfills\n  // NODE 10+: stream is an asyncIterator\n  for await (const chunk of stream) {\n    yield toArrayBuffer(chunk); // Coerce each chunk to ArrayBuffer\n  }\n}\n/* TODO - remove NODE < 10\n * @see https://github.com/bustle/streaming-iterables, MIT license\n *\n  if (typeof stream[Symbol.asyncIterator] === 'function') {\n    return;\n  }\n\n  // TODO - check if is this ever used in Node 10+?\n  // eslint-disable-next-line no-constant-condition\n  while (true) {\n    const data = stream.read();\n    if (data !== null) {\n      yield toArrayBuffer(data);\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n    if (stream._readableState?.ended) {\n      return;\n    }\n    await onceReadable(stream);\n  }\n\nasync function onceReadable(stream: Readable): Promise<any> {\n  return new Promise((resolve) => {\n    stream.once('readable', resolve);\n  });\n}\n  */\n", "import type {ReadStream} from 'fs';\n\nimport {makeStringIterator} from './make-string-iterator';\nimport {makeArrayBufferIterator} from './make-array-buffer-iterator';\nimport {makeBlobIterator} from './make-blob-iterator';\nimport type {StreamIteratorOptions} from './make-stream-iterator';\nimport {makeStreamIterator} from './make-stream-iterator';\nimport {isBlob, isReadableStream, isResponse} from '../../javascript-utils/is-type';\n\n/**\n * @param [options.chunkSize]\n */\nexport type IteratorOptions = StreamIteratorOptions & {\n  chunkSize?: number;\n};\n\n/**\n * Returns an iterator that breaks its input into chunks and yields them one-by-one.\n * @param data\n * @param options\n * @returns\n * This function can e.g. be used to enable data sources that can only be read atomically\n * (such as `Blob` and `File` via `FileReader`) to still be parsed in batches.\n */\nexport function makeIterator(\n  data: ArrayBuffer | string | Blob | Response | ReadableStream | ReadStream,\n  options?: IteratorOptions\n): AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer> {\n  if (typeof data === 'string') {\n    // Note: Converts string chunks to binary\n    return makeStringIterator(data, options);\n  }\n  if (data instanceof ArrayBuffer) {\n    return makeArrayBufferIterator(data, options);\n  }\n  if (isBlob(data)) {\n    return makeBlobIterator(data as Blob, options);\n  }\n  if (isReadableStream(data)) {\n    return makeStreamIterator(data as ReadableStream, options);\n  }\n  if (isResponse(data)) {\n    const response = data as Response;\n    return makeStreamIterator(response.body as ReadableStream, options);\n  }\n  throw new Error('makeIterator');\n}\n", "import type {\n  DataType,\n  SyncDataType,\n  BatchableDataType,\n  Loader,\n  LoaderOptions\n} from '@loaders.gl/loader-utils';\nimport {concatenateArrayBuffersAsync} from '@loaders.gl/loader-utils';\nimport {\n  isResponse,\n  isReadableStream,\n  isAsyncIterable,\n  isIterable,\n  isIterator,\n  isBlob,\n  isBuffer\n} from '../../javascript-utils/is-type';\nimport {makeIterator} from '../../iterators/make-iterator/make-iterator';\nimport {checkResponse, makeResponse} from '../utils/response-utils';\n\nconst ERR_DATA = 'Cannot convert supplied data type';\n\n// eslint-disable-next-line complexity\nexport function getArrayBufferOrStringFromDataSync(\n  data: SyncDataType,\n  loader: Loader,\n  options: LoaderOptions\n): ArrayBuffer | string {\n  if (loader.text && typeof data === 'string') {\n    return data;\n  }\n\n  if (isBuffer(data)) {\n    // @ts-ignore\n    data = data.buffer;\n  }\n\n  if (data instanceof ArrayBuffer) {\n    const arrayBuffer = data;\n    if (loader.text && !loader.binary) {\n      const textDecoder = new TextDecoder('utf8');\n      return textDecoder.decode(arrayBuffer);\n    }\n    return arrayBuffer;\n  }\n\n  // We may need to handle offsets\n  if (ArrayBuffer.isView(data)) {\n    // TextDecoder is invoked on typed arrays and will handle offsets\n    if (loader.text && !loader.binary) {\n      const textDecoder = new TextDecoder('utf8');\n      return textDecoder.decode(data);\n    }\n\n    let arrayBuffer = data.buffer;\n\n    // Since we are returning the underlying arrayBuffer, we must create a new copy\n    // if this typed array / Buffer is a partial view into the ArryayBuffer\n    // TODO - this is a potentially unnecessary copy\n    const byteLength = data.byteLength || data.length;\n    if (data.byteOffset !== 0 || byteLength !== arrayBuffer.byteLength) {\n      // console.warn(`loaders.gl copying arraybuffer of length ${byteLength}`);\n      arrayBuffer = arrayBuffer.slice(data.byteOffset, data.byteOffset + byteLength);\n    }\n    return arrayBuffer;\n  }\n\n  throw new Error(ERR_DATA);\n}\n\n// Convert async iterator to a promise\nexport async function getArrayBufferOrStringFromData(\n  data: DataType,\n  loader: Loader,\n  options: LoaderOptions\n): Promise<ArrayBuffer | string> {\n  const isArrayBuffer = data instanceof ArrayBuffer || ArrayBuffer.isView(data);\n  if (typeof data === 'string' || isArrayBuffer) {\n    return getArrayBufferOrStringFromDataSync(data as string | ArrayBuffer, loader, options);\n  }\n\n  // Blobs and files are FileReader compatible\n  if (isBlob(data)) {\n    data = await makeResponse(data);\n  }\n\n  if (isResponse(data)) {\n    const response = data as Response;\n    await checkResponse(response);\n    return loader.binary ? await response.arrayBuffer() : await response.text();\n  }\n\n  if (isReadableStream(data)) {\n    // @ts-expect-error TS2559 options type\n    data = makeIterator(data as ReadableStream, options);\n  }\n\n  if (isIterable(data) || isAsyncIterable(data)) {\n    // Assume arrayBuffer iterator - attempt to concatenate\n    return concatenateArrayBuffersAsync(data as AsyncIterable<ArrayBuffer>);\n  }\n\n  throw new Error(ERR_DATA);\n}\n\nexport async function getAsyncIterableFromData(\n  data: BatchableDataType,\n  options: LoaderOptions\n): Promise<AsyncIterable<ArrayBuffer> | Iterable<ArrayBuffer>> {\n  if (isIterator(data)) {\n    return data as AsyncIterable<ArrayBuffer>;\n  }\n\n  if (isResponse(data)) {\n    const response = data as Response;\n    // Note Since this function is not async, we currently can't load error message, just status\n    await checkResponse(response);\n    // TODO - bug in polyfill, body can be a Promise under Node.js\n    // eslint-disable-next-line @typescript-eslint/await-thenable\n    const body = await response.body;\n    // TODO - body can be null?\n    return makeIterator(body as ReadableStream<Uint8Array>, options as any);\n  }\n\n  if (isBlob(data) || isReadableStream(data)) {\n    return makeIterator(data as Blob | ReadableStream, options as any);\n  }\n\n  if (isAsyncIterable(data)) {\n    return data[Symbol.asyncIterator]();\n  }\n\n  return getIterableFromData(data);\n}\n\nexport async function getReadableStream(data: BatchableDataType): Promise<ReadableStream> {\n  if (isReadableStream(data)) {\n    return data as ReadableStream;\n  }\n  if (isResponse(data)) {\n    // @ts-ignore\n    return data.body;\n  }\n  const response = await makeResponse(data);\n  // @ts-ignore\n  return response.body;\n}\n\n// HELPERS\n\nfunction getIterableFromData(data) {\n  // generate an iterator that emits a single chunk\n  if (ArrayBuffer.isView(data)) {\n    return (function* oneChunk() {\n      yield data.buffer;\n    })();\n  }\n\n  if (data instanceof ArrayBuffer) {\n    return (function* oneChunk() {\n      yield data;\n    })();\n  }\n\n  if (isIterator(data)) {\n    return data;\n  }\n\n  if (isIterable(data)) {\n    return data[Symbol.iterator]();\n  }\n\n  throw new Error(ERR_DATA);\n}\n", "import type {Loader, LoaderOptions, LoaderContext} from '@loaders.gl/loader-utils';\nimport {getFetchFunction} from './get-fetch-function';\nimport {extractQueryString, stripQueryString} from '../utils/url-utils';\nimport {path} from '@loaders.gl/loader-utils';\n\n/**\n * \"sub\" loaders invoked by other loaders get a \"context\" injected on `this`\n * The context will inject core methods like `parse` and contain information\n * about loaders and options passed in to the top-level `parse` call.\n *\n * @param context\n * @param options\n * @param previousContext\n */\nexport function getLoaderContext(\n  context: Omit<LoaderContext, 'fetch'> & Partial<Pick<LoaderContext, 'fetch'>>,\n  options: LoaderOptions,\n  parentContext: LoaderContext | null\n): LoaderContext {\n  // For recursive calls, we already have a context\n  // TODO - add any additional loaders to context?\n  if (parentContext) {\n    return parentContext;\n  }\n\n  const newContext: LoaderContext = {\n    fetch: getFetchFunction(options, context),\n    ...context\n  };\n\n  // Parse URLs so that subloaders can easily generate correct strings\n  if (newContext.url) {\n    const baseUrl = stripQueryString(newContext.url);\n    newContext.baseUrl = baseUrl;\n    newContext.queryString = extractQueryString(newContext.url);\n    newContext.filename = path.filename(baseUrl);\n    newContext.baseUrl = path.dirname(baseUrl);\n  }\n\n  // Recursive loading does not use single loader\n  if (!Array.isArray(newContext.loaders)) {\n    newContext.loaders = null;\n  }\n\n  return newContext;\n}\n\n// eslint-disable-next-line complexity\nexport function getLoadersFromContext(\n  loaders: Loader[] | Loader | undefined,\n  context?: LoaderContext\n) {\n  // A single non-array loader is force selected, but only on top-level (context === null)\n  if (!context && loaders && !Array.isArray(loaders)) {\n    return loaders;\n  }\n\n  // Create a merged list\n  let candidateLoaders;\n  if (loaders) {\n    candidateLoaders = Array.isArray(loaders) ? loaders : [loaders];\n  }\n  if (context && context.loaders) {\n    const contextLoaders = Array.isArray(context.loaders) ? context.loaders : [context.loaders];\n    candidateLoaders = candidateLoaders ? [...candidateLoaders, ...contextLoaders] : contextLoaders;\n  }\n  // If no loaders, return null to look in globally registered loaders\n  return candidateLoaders && candidateLoaders.length ? candidateLoaders : null;\n}\n", "// loaders.gl, MIT license\nimport {Log} from '@probe.gl/log';\n\nexport const log = new Log({id: 'loaders.gl'});\n", "import type {LoaderContext, LoaderOptions, Loader} from '@loaders.gl/loader-utils';\nimport {compareArrayBuffers, path} from '@loaders.gl/loader-utils';\nimport {normalizeLoader} from '../loader-utils/normalize-loader';\nimport {log} from '../utils/log';\nimport {getResourceUrl, getResourceMIMEType} from '../utils/resource-utils';\nimport {getRegisteredLoaders} from './register-loaders';\nimport {isBlob} from '../../javascript-utils/is-type';\nimport {stripQueryString} from '../utils/url-utils';\n\nconst EXT_PATTERN = /\\.([^.]+)$/;\n\n// TODO - Need a variant that peeks at streams for parseInBatches\n// TODO - Detect multiple matching loaders? Use heuristics to grade matches?\n// TODO - Allow apps to pass context to disambiguate between multiple matches (e.g. multiple .json formats)?\n\n/**\n * Find a loader that matches file extension and/or initial file content\n * Search the loaders array argument for a loader that matches url extension or initial data\n * Returns: a normalized loader\n * @param data data to assist\n * @param loaders\n * @param options\n * @param context used internally, applications should not provide this parameter\n */\nexport async function selectLoader(\n  data: Response | Blob | ArrayBuffer | string,\n  loaders: Loader[] | Loader = [],\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Promise<Loader | null> {\n  if (!validHTTPResponse(data)) {\n    return null;\n  }\n\n  // First make a sync attempt, disabling exceptions\n  let loader = selectLoaderSync(data, loaders, {...options, nothrow: true}, context);\n  if (loader) {\n    return loader;\n  }\n\n  // For Blobs and Files, try to asynchronously read a small initial slice and test again with that\n  // to see if we can detect by initial content\n  if (isBlob(data)) {\n    data = await (data as Blob).slice(0, 10).arrayBuffer();\n    loader = selectLoaderSync(data, loaders, options, context);\n  }\n\n  // no loader available\n  if (!loader && !options?.nothrow) {\n    throw new Error(getNoValidLoaderMessage(data));\n  }\n\n  return loader;\n}\n\n/**\n * Find a loader that matches file extension and/or initial file content\n * Search the loaders array argument for a loader that matches url extension or initial data\n * Returns: a normalized loader\n * @param data data to assist\n * @param loaders\n * @param options\n * @param context used internally, applications should not provide this parameter\n */\nexport function selectLoaderSync(\n  data: Response | Blob | ArrayBuffer | string,\n  loaders: Loader[] | Loader = [],\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Loader | null {\n  if (!validHTTPResponse(data)) {\n    return null;\n  }\n\n  // eslint-disable-next-line complexity\n  // if only a single loader was provided (not as array), force its use\n  // TODO - Should this behavior be kept and documented?\n  if (loaders && !Array.isArray(loaders)) {\n    // TODO - remove support for legacy loaders\n    return normalizeLoader(loaders);\n  }\n\n  // Build list of candidate loaders that will be searched in order for a match\n  let candidateLoaders: Loader[] = [];\n  // First search supplied loaders\n  if (loaders) {\n    candidateLoaders = candidateLoaders.concat(loaders);\n  }\n  // Then fall back to registered loaders\n  if (!options?.ignoreRegisteredLoaders) {\n    candidateLoaders.push(...getRegisteredLoaders());\n  }\n\n  // TODO - remove support for legacy loaders\n  normalizeLoaders(candidateLoaders);\n\n  const loader = selectLoaderInternal(data, candidateLoaders, options, context);\n\n  // no loader available\n  if (!loader && !options?.nothrow) {\n    throw new Error(getNoValidLoaderMessage(data));\n  }\n\n  return loader;\n}\n\n/** Implements loaders selection logic */\n// eslint-disable-next-line complexity\nfunction selectLoaderInternal(\n  data: Response | Blob | ArrayBuffer | string,\n  loaders: Loader[],\n  options?: LoaderOptions,\n  context?: LoaderContext\n) {\n  const url = getResourceUrl(data);\n  const type = getResourceMIMEType(data);\n\n  const testUrl = stripQueryString(url) || context?.url;\n\n  let loader: Loader | null = null;\n  let reason: string = '';\n\n  // if options.mimeType is supplied, it takes precedence\n  if (options?.mimeType) {\n    loader = findLoaderByMIMEType(loaders, options?.mimeType);\n    reason = `match forced by supplied MIME type ${options?.mimeType}`;\n  }\n\n  // Look up loader by url\n  loader = loader || findLoaderByUrl(loaders, testUrl);\n  reason = reason || (loader ? `matched url ${testUrl}` : '');\n\n  // Look up loader by mime type\n  loader = loader || findLoaderByMIMEType(loaders, type);\n  reason = reason || (loader ? `matched MIME type ${type}` : '');\n\n  // Look for loader via initial bytes (Note: not always accessible (e.g. Response, stream, async iterator)\n  loader = loader || findLoaderByInitialBytes(loaders, data);\n  reason = reason || (loader ? `matched initial data ${getFirstCharacters(data)}` : '');\n\n  // Look up loader by fallback mime type\n  loader = loader || findLoaderByMIMEType(loaders, options?.fallbackMimeType);\n  reason = reason || (loader ? `matched fallback MIME type ${type}` : '');\n\n  if (reason) {\n    log.log(1, `selectLoader selected ${loader?.name}: ${reason}.`);\n  }\n\n  return loader;\n}\n\n/** Check HTTP Response */\nfunction validHTTPResponse(data: any): boolean {\n  // HANDLE HTTP status\n  if (data instanceof Response) {\n    // 204 - NO CONTENT. This handles cases where e.g. a tile server responds with 204 for a missing tile\n    if (data.status === 204) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/** Generate a helpful message to help explain why loader selection failed. */\nfunction getNoValidLoaderMessage(data): string {\n  const url = getResourceUrl(data);\n  const type = getResourceMIMEType(data);\n\n  let message = 'No valid loader found (';\n  message += url ? `${path.filename(url)}, ` : 'no url provided, ';\n  message += `MIME type: ${type ? `\"${type}\"` : 'not provided'}, `;\n  // First characters are only accessible when called on data (string or arrayBuffer).\n  const firstCharacters: string = data ? getFirstCharacters(data) : '';\n  message += firstCharacters ? ` first bytes: \"${firstCharacters}\"` : 'first bytes: not available';\n  message += ')';\n  return message;\n}\n\nfunction normalizeLoaders(loaders: Loader[]): void {\n  for (const loader of loaders) {\n    normalizeLoader(loader);\n  }\n}\n\n// TODO - Would be nice to support http://example.com/file.glb?parameter=1\n// E.g: x = new URL('http://example.com/file.glb?load=1'; x.pathname\nfunction findLoaderByUrl(loaders: Loader[], url?: string): Loader | null {\n  // Get extension\n  const match = url && EXT_PATTERN.exec(url);\n  const extension = match && match[1];\n  return extension ? findLoaderByExtension(loaders, extension) : null;\n}\n\nfunction findLoaderByExtension(loaders: Loader[], extension: string): Loader | null {\n  extension = extension.toLowerCase();\n\n  for (const loader of loaders) {\n    for (const loaderExtension of loader.extensions) {\n      if (loaderExtension.toLowerCase() === extension) {\n        return loader;\n      }\n    }\n  }\n  return null;\n}\n\nfunction findLoaderByMIMEType(loaders, mimeType) {\n  for (const loader of loaders) {\n    if (loader.mimeTypes && loader.mimeTypes.includes(mimeType)) {\n      return loader;\n    }\n\n    // Support referring to loaders using the \"unregistered tree\"\n    // https://en.wikipedia.org/wiki/Media_type#Unregistered_tree\n    if (mimeType === `application/x.${loader.id}`) {\n      return loader;\n    }\n  }\n  return null;\n}\n\nfunction findLoaderByInitialBytes(loaders, data) {\n  if (!data) {\n    return null;\n  }\n\n  for (const loader of loaders) {\n    if (typeof data === 'string') {\n      if (testDataAgainstText(data, loader)) {\n        return loader;\n      }\n    } else if (ArrayBuffer.isView(data)) {\n      // Typed Arrays can have offsets into underlying buffer\n      if (testDataAgainstBinary(data.buffer, data.byteOffset, loader)) {\n        return loader;\n      }\n    } else if (data instanceof ArrayBuffer) {\n      const byteOffset = 0;\n      if (testDataAgainstBinary(data, byteOffset, loader)) {\n        return loader;\n      }\n    }\n    // TODO Handle streaming case (requires creating a new AsyncIterator)\n  }\n  return null;\n}\n\nfunction testDataAgainstText(data, loader) {\n  if (loader.testText) {\n    return loader.testText(data);\n  }\n\n  const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n  return tests.some((test) => data.startsWith(test));\n}\n\nfunction testDataAgainstBinary(data, byteOffset, loader) {\n  const tests = Array.isArray(loader.tests) ? loader.tests : [loader.tests];\n  return tests.some((test) => testBinary(data, byteOffset, loader, test));\n}\n\nfunction testBinary(data, byteOffset, loader, test) {\n  if (test instanceof ArrayBuffer) {\n    return compareArrayBuffers(test, data, test.byteLength);\n  }\n  switch (typeof test) {\n    case 'function':\n      return test(data, loader);\n\n    case 'string':\n      // Magic bytes check: If `test` is a string, check if binary data starts with that strings\n      const magic = getMagicString(data, byteOffset, test.length);\n      return test === magic;\n\n    default:\n      return false;\n  }\n}\n\nfunction getFirstCharacters(data, length: number = 5) {\n  if (typeof data === 'string') {\n    return data.slice(0, length);\n  } else if (ArrayBuffer.isView(data)) {\n    // Typed Arrays can have offsets into underlying buffer\n    return getMagicString(data.buffer, data.byteOffset, length);\n  } else if (data instanceof ArrayBuffer) {\n    const byteOffset = 0;\n    return getMagicString(data, byteOffset, length);\n  }\n  return '';\n}\n\nfunction getMagicString(arrayBuffer, byteOffset, length) {\n  if (arrayBuffer.byteLength < byteOffset + length) {\n    return '';\n  }\n  const dataView = new DataView(arrayBuffer);\n  let magic = '';\n  for (let i = 0; i < length; i++) {\n    magic += String.fromCharCode(dataView.getUint8(byteOffset + i));\n  }\n  return magic;\n}\n", "import type {DataType, Loader, LoaderContext, LoaderOptions} from '@loaders.gl/loader-utils';\nimport {assert, validateWorkerVersion} from '@loaders.gl/worker-utils';\nimport {parseWithWorker, canParseWithWorker} from '@loaders.gl/loader-utils';\nimport {isLoaderObject} from '../loader-utils/normalize-loader';\nimport {isResponse} from '../../javascript-utils/is-type';\nimport {normalizeOptions} from '../loader-utils/option-utils';\nimport {getArrayBufferOrStringFromData} from '../loader-utils/get-data';\nimport {getLoaderContext, getLoadersFromContext} from '../loader-utils/loader-context';\nimport {getResourceUrl} from '../utils/resource-utils';\nimport {selectLoader} from './select-loader';\n\n/**\n * Parses `data` using a specified loader\n * @param data\n * @param loaders\n * @param options\n * @param context\n */\nexport async function parse(\n  data: DataType | Promise<DataType>,\n  loaders?: Loader | Loader[] | LoaderOptions,\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Promise<any> {\n  assert(!context || typeof context === 'object'); // parse no longer accepts final url\n\n  // Signature: parse(data, options, context | url)\n  // Uses registered loaders\n  if (loaders && !Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined; // context not supported in short signature\n    options = loaders as LoaderOptions;\n    loaders = undefined;\n  }\n\n  data = await data; // Resolve any promise\n  options = options || {};\n\n  // Extract a url for auto detection\n  const url = getResourceUrl(data);\n\n  // Chooses a loader (and normalizes it)\n  // Also use any loaders in the context, new loaders take priority\n  const typedLoaders = loaders as Loader | Loader[] | undefined;\n  const candidateLoaders = getLoadersFromContext(typedLoaders, context);\n  // todo hacky type cast\n  const loader = await selectLoader(data as ArrayBuffer, candidateLoaders, options);\n  // Note: if no loader was found, if so just return null\n  if (!loader) {\n    return null;\n  }\n\n  // Normalize options\n  options = normalizeOptions(options, loader, candidateLoaders, url);\n\n  // Get a context (if already present, will be unchanged)\n  context = getLoaderContext({url, parse, loaders: candidateLoaders}, options, context || null);\n\n  return await parseWithLoader(loader, data, options, context);\n}\n\n// TODO: support progress and abort\n// TODO - should accept loader.parseAsyncIterator and concatenate.\nasync function parseWithLoader(loader, data, options, context) {\n  validateWorkerVersion(loader);\n\n  if (isResponse(data)) {\n    // Serialize to support passing the response to web worker\n    const response = data as Response;\n    const {ok, redirected, status, statusText, type, url} = response;\n    const headers = Object.fromEntries(response.headers.entries());\n    context.response = {headers, ok, redirected, status, statusText, type, url};\n  }\n\n  data = await getArrayBufferOrStringFromData(data, loader, options);\n\n  // First check for synchronous text parser, wrap results in promises\n  if (loader.parseTextSync && typeof data === 'string') {\n    options.dataType = 'text';\n    return loader.parseTextSync(data, options, context, loader);\n  }\n\n  // If we have a workerUrl and the loader can parse the given options efficiently in a worker\n  if (canParseWithWorker(loader, options)) {\n    return await parseWithWorker(loader, data, options, context, parse);\n  }\n\n  // Check for asynchronous parser\n  if (loader.parseText && typeof data === 'string') {\n    return await loader.parseText(data, options, context, loader);\n  }\n\n  if (loader.parse) {\n    return await loader.parse(data, options, context, loader);\n  }\n\n  // This should not happen, all sync loaders should also offer `parse` function\n  assert(!loader.parseSync);\n\n  // TBD - If asynchronous parser not available, return null\n  throw new Error(`${loader.id} loader - no parser found and worker is disabled`);\n}\n", "import type {DataType, Loader, LoaderContext, LoaderOptions} from '@loaders.gl/loader-utils';\nimport {isBlob} from '../../javascript-utils/is-type';\nimport {isLoaderObject} from '../loader-utils/normalize-loader';\nimport {getFetchFunction} from '../loader-utils/get-fetch-function';\n\nimport {parse} from './parse';\n\n/**\n * Parses `data` using a specified loader\n * Note: Load does duplicate a lot of parse.\n * it can also call fetchFile on string urls, which `parse` won't do.\n * @param data\n * @param loaders\n * @param options\n * @param context\n */\n// implementation signature\nexport async function load(\n  url: string | DataType,\n  loaders?: Loader | Loader[] | LoaderOptions,\n  options?: LoaderOptions,\n  context?: LoaderContext\n): Promise<any> {\n  // Signature: load(url, options)\n  if (!Array.isArray(loaders) && !isLoaderObject(loaders)) {\n    context = undefined; // context not supported in short signature\n    options = loaders as LoaderOptions;\n    loaders = undefined;\n  }\n\n  // Select fetch function\n  const fetch = getFetchFunction(options);\n\n  // at this point, `url` could be already loaded binary data\n  let data = url;\n  // url is a string, fetch the url\n  if (typeof url === 'string') {\n    data = await fetch(url);\n    // URL is Blob or File, fetchFile handles it (alt: we could generate ObjectURL here)\n  }\n\n  if (isBlob(url)) {\n    // The fetch response object will contain blob.name\n    // @ts-expect-error TODO - This may not work for overridden fetch functions\n    data = await fetch(url);\n  }\n\n  // Data is loaded (at least we have a `Response` object) so time to hand over to `parse`\n  return await parse(data, loaders as Loader[], options);\n}\n", "// Version constant cannot be imported, it needs to correspond to the build version of **this** module.\n// __VERSION__ is injected by babel-plugin-version-inline\n// @ts-ignore TS2304: Cannot find name '__VERSION__'.\nexport const VERSION = typeof __VERSION__ !== 'undefined' ? __VERSION__ : 'latest';\n", "import {isBrowser} from '@loaders.gl/loader-utils';\nimport type {ImageTypeEnum} from '../../types';\n\n// @ts-ignore TS2339: Property does not exist on type\nconst {_parseImageNode} = globalThis;\n\nconst IMAGE_SUPPORTED = typeof Image !== 'undefined'; // NOTE: \"false\" positives if jsdom is installed\nconst IMAGE_BITMAP_SUPPORTED = typeof ImageBitmap !== 'undefined';\nconst NODE_IMAGE_SUPPORTED = Boolean(_parseImageNode);\nconst DATA_SUPPORTED = isBrowser ? true : NODE_IMAGE_SUPPORTED;\n\n/**\n * Checks if a loaders.gl image type is supported\n * @param type image type string\n */\nexport function isImageTypeSupported(type: string): boolean {\n  switch (type) {\n    case 'auto':\n      // Should only ever be false in Node.js, if polyfills have not been installed...\n      return IMAGE_BITMAP_SUPPORTED || IMAGE_SUPPORTED || DATA_SUPPORTED;\n\n    case 'imagebitmap':\n      return IMAGE_BITMAP_SUPPORTED;\n    case 'image':\n      return IMAGE_SUPPORTED;\n    case 'data':\n      return DATA_SUPPORTED;\n\n    default:\n      throw new Error(`@loaders.gl/images: image ${type} not supported in this environment`);\n  }\n}\n\n/**\n * Returns the \"most performant\" supported image type on this platform\n * @returns image type string\n */\nexport function getDefaultImageType(): ImageTypeEnum {\n  if (IMAGE_BITMAP_SUPPORTED) {\n    return 'imagebitmap';\n  }\n  if (IMAGE_SUPPORTED) {\n    return 'image';\n  }\n  if (DATA_SUPPORTED) {\n    return 'data';\n  }\n\n  // This should only happen in Node.js\n  throw new Error('Install \\'@loaders.gl/polyfills\\' to parse images under Node.js');\n}\n", "import type {ImageType, ImageTypeEnum, ImageDataType} from '../../types';\n\nexport function isImage(image: ImageType): boolean {\n  return Boolean(getImageTypeOrNull(image));\n}\n\nexport function deleteImage(image: ImageType): void {\n  switch (getImageType(image)) {\n    case 'imagebitmap':\n      (image as ImageBitmap).close();\n      break;\n    default:\n    // Nothing to do for images and image data objects\n  }\n}\n\nexport function getImageType(image: ImageType): ImageTypeEnum {\n  const format = getImageTypeOrNull(image);\n  if (!format) {\n    throw new Error('Not an image');\n  }\n  return format;\n}\n\nexport function getImageSize(image: ImageType): {width: number; height: number} {\n  return getImageData(image);\n}\n\nexport function getImageData(image: ImageType): ImageDataType | ImageData {\n  switch (getImageType(image)) {\n    case 'data':\n      return image as unknown as ImageData;\n\n    case 'image':\n    case 'imagebitmap':\n      // Extract the image data from the image via a canvas\n      const canvas = document.createElement('canvas');\n      // TODO - reuse the canvas?\n      const context = canvas.getContext('2d');\n      if (!context) {\n        throw new Error('getImageData');\n      }\n      // @ts-ignore\n      canvas.width = image.width;\n      // @ts-ignore\n      canvas.height = image.height;\n      // @ts-ignore\n      context.drawImage(image, 0, 0);\n      // @ts-ignore\n      return context.getImageData(0, 0, image.width, image.height);\n\n    default:\n      throw new Error('getImageData');\n  }\n}\n\n// PRIVATE\n\n// eslint-disable-next-line complexity\nfunction getImageTypeOrNull(image) {\n  if (typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap) {\n    return 'imagebitmap';\n  }\n  if (typeof Image !== 'undefined' && image instanceof Image) {\n    return 'image';\n  }\n  if (image && typeof image === 'object' && image.data && image.width && image.height) {\n    return 'data';\n  }\n  return null;\n}\n", "// SVG parsing has limitations, e.g:\n// https://bugs.chromium.org/p/chromium/issues/detail?id=606319\n\nconst SVG_DATA_URL_PATTERN = /^data:image\\/svg\\+xml/;\nconst SVG_URL_PATTERN = /\\.svg((\\?|#).*)?$/;\n\nexport function isSVG(url) {\n  return url && (SVG_DATA_URL_PATTERN.test(url) || SVG_URL_PATTERN.test(url));\n}\n\nexport function getBlobOrSVGDataUrl(arrayBuffer: ArrayBuffer, url?: string): Blob | string {\n  if (isSVG(url)) {\n    // Prepare a properly tagged data URL, and load using normal mechanism\n    const textDecoder = new TextDecoder();\n    let xmlText = textDecoder.decode(arrayBuffer);\n    // TODO Escape in browser to support e.g. Chinese characters\n    try {\n      if (typeof unescape === 'function' && typeof encodeURIComponent === 'function') {\n        xmlText = unescape(encodeURIComponent(xmlText));\n      }\n    } catch (error) {\n      throw new Error((error as Error).message);\n    }\n    // base64 encoding is safer. utf-8 fails in some browsers\n    const src = `data:image/svg+xml;base64,${btoa(xmlText)}`;\n    return src;\n  }\n  return getBlob(arrayBuffer, url);\n}\n\nexport function getBlob(arrayBuffer: ArrayBuffer, url?: string): Blob {\n  if (isSVG(url)) {\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=606319\n    // return new Blob([new Uint8Array(arrayBuffer)], {type: 'image/svg+xml'});\n    throw new Error('SVG cannot be parsed directly to imagebitmap');\n  }\n  // TODO - how to determine mime type? Param? Sniff here?\n  return new Blob([new Uint8Array(arrayBuffer)]); // MIME type not needed?\n}\n", "import type {ImageLoaderOptions} from '../../image-loader';\nimport {getBlobOrSVGDataUrl} from './svg-utils';\n\n// Parses html image from array buffer\nexport default async function parseToImage(\n  arrayBuffer: ArrayBuffer,\n  options: ImageLoaderOptions,\n  url?: string\n): Promise<HTMLImageElement> {\n  // Note: image parsing requires conversion to Blob (for createObjectURL).\n  // Potentially inefficient for not using `response.blob()` (and for File / Blob inputs)...\n  // But presumably not worth adding 'blob' flag to loader objects?\n\n  const blobOrDataUrl = getBlobOrSVGDataUrl(arrayBuffer, url);\n  const URL = self.URL || self.webkitURL;\n  const objectUrl = typeof blobOrDataUrl !== 'string' && URL.createObjectURL(blobOrDataUrl);\n  try {\n    return await loadToImage(objectUrl || blobOrDataUrl, options);\n  } finally {\n    if (objectUrl) {\n      URL.revokeObjectURL(objectUrl);\n    }\n  }\n}\n\nexport async function loadToImage(url, options): Promise<HTMLImageElement> {\n  const image = new Image();\n  image.src = url;\n\n  // The `image.onload()` callback does not guarantee that the image has been decoded\n  // so a main thread \"freeze\" can be incurred when using the image for the first time.\n  // `Image.decode()` returns a promise that completes when image is decoded.\n\n  // https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/decode\n  // Note: When calling `img.decode()`, we do not need to wait for `img.onload()`\n  // Note: `HTMLImageElement.decode()` is not available in Edge and IE11\n  if (options.image && options.image.decode && image.decode) {\n    await image.decode();\n    return image;\n  }\n\n  // Create a promise that tracks onload/onerror callbacks\n  return await new Promise((resolve, reject) => {\n    try {\n      image.onload = () => resolve(image);\n      image.onerror = (err) => reject(new Error(`Could not load image ${url}: ${err}`));\n    } catch (error) {\n      reject(error);\n    }\n  });\n}\n", "import type {ImageLoaderOptions} from '../../image-loader';\nimport {isSVG, getBlob} from './svg-utils';\nimport parseToImage from './parse-to-image';\n\nconst EMPTY_OBJECT = {};\n\nlet imagebitmapOptionsSupported = true;\n\n/**\n * Asynchronously parses an array buffer into an ImageBitmap - this contains the decoded data\n * ImageBitmaps are supported on worker threads, but not supported on Edge, IE11 and Safari\n * https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap#Browser_compatibility\n *\n * TODO - createImageBitmap supports source rect (5 param overload), pass through?\n */\nexport default async function parseToImageBitmap(\n  arrayBuffer: ArrayBuffer,\n  options: ImageLoaderOptions,\n  url?: string\n): Promise<ImageBitmap> {\n  let blob;\n\n  // Cannot parse SVG directly to ImageBitmap, parse to Image first\n  if (isSVG(url)) {\n    // Note: this only works on main thread\n    const image = await parseToImage(arrayBuffer, options, url);\n    blob = image;\n  } else {\n    // Create blob from the array buffer\n    blob = getBlob(arrayBuffer, url);\n  }\n\n  const imagebitmapOptions = options && options.imagebitmap;\n\n  return await safeCreateImageBitmap(blob, imagebitmapOptions);\n}\n\n/**\n * Safely creates an imageBitmap with options\n * *\n * Firefox crashes if imagebitmapOptions is supplied\n * Avoid supplying if not provided or supported, remember if not supported\n */\nasync function safeCreateImageBitmap(\n  blob: Blob,\n  imagebitmapOptions: ImageBitmapOptions | null = null\n): Promise<ImageBitmap> {\n  if (isEmptyObject(imagebitmapOptions) || !imagebitmapOptionsSupported) {\n    imagebitmapOptions = null;\n  }\n\n  if (imagebitmapOptions) {\n    try {\n      // @ts-ignore Options\n      return await createImageBitmap(blob, imagebitmapOptions);\n    } catch (error) {\n      console.warn(error); // eslint-disable-line\n      imagebitmapOptionsSupported = false;\n    }\n  }\n\n  return await createImageBitmap(blob);\n}\n\nfunction isEmptyObject(object) {\n  // @ts-ignore\n  for (const key in object || EMPTY_OBJECT) {\n    return false;\n  }\n  return true;\n}\n", "// loaders.gl, MIT license\n// code adapted from https://github.com/sindresorhus/file-type under MIT license\n\n/**\n * Box is a container format that can contain a variety of media related files,\n * so we want to return information about which type of file is actually contained inside\n */\nexport type BoxFileType = {extension: string; mimeType: string};\n\n/**\n * Tests if a buffer is in ISO base media file format (ISOBMFF) @see https://en.wikipedia.org/wiki/ISO_base_media_file_format\n * (ISOBMFF is a media container standard based on the Apple QuickTime container format)\n */\nexport function getISOBMFFMediaType(buffer: Uint8Array): BoxFileType | null {\n  // Almost all ISO base media files start with `ftyp` box. (It's not required to be first, but it's recommended to be.)\n  if (!checkString(buffer, 'ftyp', 4)) {\n    return null;\n  }\n\n  // Extra check: test for 8859-1 printable characters (for simplicity, it's a mask which also catches one non-printable character).\n  if ((buffer[8] & 0x60) === 0x00) {\n    return null;\n  }\n\n  // `ftyp` box must contain a brand major identifier, which must consist of ISO 8859-1 printable characters.\n  return decodeMajorBrand(buffer);\n}\n\n/**\n * brands explained @see https://github.com/strukturag/libheif/issues/83\n * code adapted from @see https://github.com/sindresorhus/file-type/blob/main/core.js#L489-L492\n */\nexport function decodeMajorBrand(buffer: Uint8Array): BoxFileType | null {\n  const brandMajor = getUTF8String(buffer, 8, 12).replace('\\0', ' ').trim();\n\n  switch (brandMajor) {\n    case 'avif':\n    case 'avis':\n      return {extension: 'avif', mimeType: 'image/avif'};\n    default:\n      return null;\n  }\n  // We don't need these now, but they are easy to add\n  // case 'mif1':\n  //   return {extension: 'heic', mimeType: 'image/heif'};\n  // case 'msf1':\n  //   return {extension: 'heic', mimeType: 'image/heif-sequence'};\n  // case 'heic':\n  // case 'heix':\n  //   return {extension: 'heic', mimeType: 'image/heic'};\n  // case 'hevc':\n  // case 'hevx':\n  //   return {extension: 'heic', mimeType: 'image/heic-sequence'};\n  // case 'qt':\n  //   return {ext: 'mov', mime: 'video/quicktime'};\n  // case 'M4V':\n  // case 'M4VH':\n  // case 'M4VP':\n  //   return {ext: 'm4v', mime: 'video/x-m4v'};\n  // case 'M4P':\n  //   return {ext: 'm4p', mime: 'video/mp4'};\n  // case 'M4B':\n  //   return {ext: 'm4b', mime: 'audio/mp4'};\n  // case 'M4A':\n  //   return {ext: 'm4a', mime: 'audio/x-m4a'};\n  // case 'F4V':\n  //   return {ext: 'f4v', mime: 'video/mp4'};\n  // case 'F4P':\n  //   return {ext: 'f4p', mime: 'video/mp4'};\n  // case 'F4A':\n  //   return {ext: 'f4a', mime: 'audio/mp4'};\n  // case 'F4B':\n  //   return {ext: 'f4b', mime: 'audio/mp4'};\n  // case 'crx':\n  //   return {ext: 'cr3', mime: 'image/x-canon-cr3'};\n  // default:\n  // if (brandMajor.startsWith('3g')) {\n  //   if (brandMajor.startsWith('3g2')) {\n  //     return {ext: '3g2', mime: 'video/3gpp2'};\n  //   }\n  //   return {ext: '3gp', mime: 'video/3gpp'};\n  // }\n  // return {ext: 'mp4', mime: 'video/mp4'};\n}\n\n/** Interpret a chunk of bytes as a UTF8 string */\nfunction getUTF8String(array: Uint8Array, start: number, end: number): string {\n  return String.fromCharCode(...array.slice(start, end));\n}\n\nfunction stringToBytes(string: string): number[] {\n  return [...string].map((character) => character.charCodeAt(0));\n}\n\nfunction checkString(buffer: ArrayLike<number>, header: string, offset: number = 0): boolean {\n  const headerBytes = stringToBytes(header);\n\n  for (let i = 0; i < headerBytes.length; ++i) {\n    if (headerBytes[i] !== buffer[i + offset]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n", "// Attributions\n// * Based on binary-gltf-utils under MIT license: Copyright (c) 2016-17 Karl Cheng\n\n// TODO: make these functions work for Node.js buffers?\n// Quarantine references to Buffer to prevent bundler from adding big polyfills\n// import {bufferToArrayBuffer} from '../node/buffer-to-array-buffer';\n// TODO - this should be handled in @loaders.gl/polyfills\n\nimport {getISOBMFFMediaType} from './parse-isobmff-binary';\n\n/** MIME type, width and height extracted from binary compressed image data */\nexport type BinaryImageMetadata = {\n  mimeType: string;\n  width: number;\n  height: number;\n};\n\nconst BIG_ENDIAN = false;\nconst LITTLE_ENDIAN = true;\n\n/**\n * Extracts `{mimeType, width and height}` from a memory buffer containing a known image format\n * Currently supports `image/png`, `image/jpeg`, `image/bmp` and `image/gif`.\n * @param binaryData: DataView | ArrayBuffer image file memory to parse\n * @returns metadata or null if memory is not a valid image file format layout.\n */\nexport function getBinaryImageMetadata(\n  binaryData: DataView | ArrayBuffer\n): BinaryImageMetadata | null {\n  const dataView = toDataView(binaryData);\n  return (\n    getPngMetadata(dataView) ||\n    getJpegMetadata(dataView) ||\n    getGifMetadata(dataView) ||\n    getBmpMetadata(dataView) ||\n    getISOBMFFMetadata(dataView)\n  );\n}\n\n// ISOBMFF\n\nfunction getISOBMFFMetadata(binaryData: DataView | ArrayBuffer): BinaryImageMetadata | null {\n  const buffer = new Uint8Array(binaryData instanceof DataView ? binaryData.buffer : binaryData);\n  const mediaType = getISOBMFFMediaType(buffer);\n  if (!mediaType) {\n    return null;\n  }\n  return {\n    mimeType: mediaType.mimeType,\n    // TODO - decode width and height\n    width: 0,\n    height: 0\n  };\n}\n\n// PNG\n\nfunction getPngMetadata(binaryData: DataView | ArrayBuffer): BinaryImageMetadata | null {\n  const dataView = toDataView(binaryData);\n  // Check file contains the first 4 bytes of the PNG signature.\n  const isPng = dataView.byteLength >= 24 && dataView.getUint32(0, BIG_ENDIAN) === 0x89504e47;\n  if (!isPng) {\n    return null;\n  }\n\n  // Extract size from a binary PNG file\n  return {\n    mimeType: 'image/png',\n    width: dataView.getUint32(16, BIG_ENDIAN),\n    height: dataView.getUint32(20, BIG_ENDIAN)\n  };\n}\n\n// GIF\n\n// Extract size from a binary GIF file\n// TODO: GIF is not this simple\nfunction getGifMetadata(binaryData: DataView | ArrayBuffer): BinaryImageMetadata | null {\n  const dataView = toDataView(binaryData);\n  // Check first 4 bytes of the GIF signature (\"GIF8\").\n  const isGif = dataView.byteLength >= 10 && dataView.getUint32(0, BIG_ENDIAN) === 0x47494638;\n  if (!isGif) {\n    return null;\n  }\n\n  // GIF is little endian.\n  return {\n    mimeType: 'image/gif',\n    width: dataView.getUint16(6, LITTLE_ENDIAN),\n    height: dataView.getUint16(8, LITTLE_ENDIAN)\n  };\n}\n\n// BMP\n\n// TODO: BMP is not this simple\nexport function getBmpMetadata(binaryData: DataView | ArrayBuffer): BinaryImageMetadata | null {\n  const dataView = toDataView(binaryData);\n  // Check magic number is valid (first 2 characters should be \"BM\").\n  // The mandatory bitmap file header is 14 bytes long.\n  const isBmp =\n    dataView.byteLength >= 14 &&\n    dataView.getUint16(0, BIG_ENDIAN) === 0x424d &&\n    dataView.getUint32(2, LITTLE_ENDIAN) === dataView.byteLength;\n\n  if (!isBmp) {\n    return null;\n  }\n\n  // BMP is little endian.\n  return {\n    mimeType: 'image/bmp',\n    width: dataView.getUint32(18, LITTLE_ENDIAN),\n    height: dataView.getUint32(22, LITTLE_ENDIAN)\n  };\n}\n\n// JPEG\n\n// Extract width and height from a binary JPEG file\nfunction getJpegMetadata(binaryData: DataView | ArrayBuffer): BinaryImageMetadata | null {\n  const dataView = toDataView(binaryData);\n  // Check file contains the JPEG \"start of image\" (SOI) marker\n  // followed by another marker.\n  const isJpeg =\n    dataView.byteLength >= 3 &&\n    dataView.getUint16(0, BIG_ENDIAN) === 0xffd8 &&\n    dataView.getUint8(2) === 0xff;\n\n  if (!isJpeg) {\n    return null;\n  }\n\n  const {tableMarkers, sofMarkers} = getJpegMarkers();\n\n  // Exclude the two byte SOI marker.\n  let i = 2;\n  while (i + 9 < dataView.byteLength) {\n    const marker = dataView.getUint16(i, BIG_ENDIAN);\n\n    // The frame that contains the width and height of the JPEG image.\n    if (sofMarkers.has(marker)) {\n      return {\n        mimeType: 'image/jpeg',\n        height: dataView.getUint16(i + 5, BIG_ENDIAN), // Number of lines\n        width: dataView.getUint16(i + 7, BIG_ENDIAN) // Number of pixels per line\n      };\n    }\n\n    // Miscellaneous tables/data preceding the frame header.\n    if (!tableMarkers.has(marker)) {\n      return null;\n    }\n\n    // Length includes size of length parameter but not the two byte header.\n    i += 2;\n    i += dataView.getUint16(i, BIG_ENDIAN);\n  }\n\n  return null;\n}\n\nfunction getJpegMarkers() {\n  // Tables/misc header markers.\n  // DQT, DHT, DAC, DRI, COM, APP_n\n  const tableMarkers = new Set([0xffdb, 0xffc4, 0xffcc, 0xffdd, 0xfffe]);\n  for (let i = 0xffe0; i < 0xfff0; ++i) {\n    tableMarkers.add(i);\n  }\n\n  // SOF markers and DHP marker.\n  // These markers are after tables/misc data.\n  const sofMarkers = new Set([\n    0xffc0, 0xffc1, 0xffc2, 0xffc3, 0xffc5, 0xffc6, 0xffc7, 0xffc9, 0xffca, 0xffcb, 0xffcd, 0xffce,\n    0xffcf, 0xffde\n  ]);\n\n  return {tableMarkers, sofMarkers};\n}\n\n// TODO - move into image module?\nfunction toDataView(data) {\n  if (data instanceof DataView) {\n    return data;\n  }\n  if (ArrayBuffer.isView(data)) {\n    return new DataView(data.buffer);\n  }\n\n  // TODO: make these functions work for Node.js buffers?\n  // if (bufferToArrayBuffer) {\n  //   data = bufferToArrayBuffer(data);\n  // }\n\n  // Careful - Node Buffers will look like ArrayBuffers (keep after isBuffer)\n  if (data instanceof ArrayBuffer) {\n    return new DataView(data);\n  }\n  throw new Error('toDataView');\n}\n", "import type {ImageLoaderOptions} from '../../image-loader';\nimport type {ImageDataType} from '../../types';\nimport {assert} from '@loaders.gl/loader-utils';\nimport {getBinaryImageMetadata} from '../category-api/binary-image-api';\n\n// Note: These types should be consistent with loaders.gl/polyfills\n\ntype NDArray = {\n  shape: number[];\n  data: Uint8Array;\n  width: number;\n  height: number;\n  components: number;\n  layers: number[];\n};\n\ntype ParseImageNode = (arrayBuffer: ArrayBuffer, mimeType: string) => Promise<NDArray>;\n\n// Use polyfills if installed to parsed image using get-pixels\nexport default async function parseToNodeImage(\n  arrayBuffer: ArrayBuffer,\n  options: ImageLoaderOptions\n): Promise<ImageDataType> {\n  const {mimeType} = getBinaryImageMetadata(arrayBuffer) || {};\n\n  // @ts-ignore\n  const _parseImageNode: ParseImageNode = globalThis._parseImageNode;\n  assert(_parseImageNode); // '@loaders.gl/polyfills not installed'\n\n  // @ts-expect-error TODO should we throw error in this case?\n  return await _parseImageNode(arrayBuffer, mimeType);\n}\n", "import type {LoaderContext} from '@loaders.gl/loader-utils';\nimport {assert} from '@loaders.gl/loader-utils';\nimport type {ImageType} from '../../types';\nimport type {ImageLoaderOptions} from '../../image-loader';\nimport {isImageTypeSupported, getDefaultImageType} from '../category-api/image-type';\nimport {getImageData} from '../category-api/parsed-image-api';\nimport parseToImage from './parse-to-image';\nimport parseToImageBitmap from './parse-to-image-bitmap';\nimport parseToNodeImage from './parse-to-node-image';\n\n// Parse to platform defined image type (data on node, ImageBitmap or HTMLImage on browser)\n// eslint-disable-next-line complexity\nexport default async function parseImage(\n  arrayBuffer: ArrayBuffer,\n  options?: ImageLoaderOptions,\n  context?: LoaderContext\n): Promise<ImageType> {\n  options = options || {};\n  const imageOptions = options.image || {};\n\n  // The user can request a specific output format via `options.image.type`\n  const imageType = imageOptions.type || 'auto';\n\n  const {url} = context || {};\n\n  // Note: For options.image.type === `data`, we may still need to load as `image` or `imagebitmap`\n  const loadType = getLoadableImageType(imageType);\n\n  let image;\n  switch (loadType) {\n    case 'imagebitmap':\n      image = await parseToImageBitmap(arrayBuffer, options, url);\n      break;\n    case 'image':\n      image = await parseToImage(arrayBuffer, options, url);\n      break;\n    case 'data':\n      // Node.js loads imagedata directly\n      image = await parseToNodeImage(arrayBuffer, options);\n      break;\n    default:\n      assert(false);\n  }\n\n  // Browser: if options.image.type === 'data', we can now extract data from the loaded image\n  if (imageType === 'data') {\n    image = getImageData(image);\n  }\n\n  return image;\n}\n\n// Get a loadable image type from image type\nfunction getLoadableImageType(type) {\n  switch (type) {\n    case 'auto':\n    case 'data':\n      // Browser: For image data we need still need to load using an image format\n      // Node: the default image type is `data`.\n      return getDefaultImageType();\n    default:\n      // Throw an error if not supported\n      isImageTypeSupported(type);\n      return type;\n  }\n}\n", "import type {LoaderOptions, LoaderWithParser} from '@loaders.gl/loader-utils';\nimport {VERSION} from './lib/utils/version';\nimport parseImage from './lib/parsers/parse-image';\nimport {getBinaryImageMetadata} from './lib/category-api/binary-image-api';\n\nconst EXTENSIONS = ['png', 'jpg', 'jpeg', 'gif', 'webp', 'bmp', 'ico', 'svg', 'avif'];\nconst MIME_TYPES = [\n  'image/png',\n  'image/jpeg',\n  'image/gif',\n  'image/webp',\n  'image/avif',\n  'image/bmp',\n  'image/vnd.microsoft.icon',\n  'image/svg+xml'\n];\n\nexport type ImageLoaderOptions = LoaderOptions & {\n  image?: {\n    type?: 'auto' | 'data' | 'imagebitmap' | 'image';\n    decode?: boolean;\n  };\n  imagebitmap?: ImageBitmapOptions;\n};\n\nconst DEFAULT_IMAGE_LOADER_OPTIONS: ImageLoaderOptions = {\n  image: {\n    type: 'auto',\n    decode: true // if format is HTML\n  }\n  // imagebitmap: {} - passes (platform dependent) parameters to ImageBitmap constructor\n};\n\n/**\n * Loads a platform-specific image type\n * Note: This type can be used as input data to WebGL texture creation\n */\nexport const ImageLoader = {\n  id: 'image',\n  module: 'images',\n  name: 'Images',\n  version: VERSION,\n  mimeTypes: MIME_TYPES,\n  extensions: EXTENSIONS,\n  parse: parseImage,\n  // TODO: byteOffset, byteLength;\n  tests: [(arrayBuffer) => Boolean(getBinaryImageMetadata(new DataView(arrayBuffer)))],\n  options: DEFAULT_IMAGE_LOADER_OPTIONS\n};\n\nexport const _typecheckImageLoader: LoaderWithParser = ImageLoader;\n", "// Image loading/saving for browser and Node.js\nimport {getImageSize} from '../category-api/parsed-image-api';\n\n// @ts-ignore TS2339: Property does not exist on type\nconst {_encodeImageNode} = globalThis;\n\n/**\n * Returns data bytes representing a compressed image in PNG or JPG format,\n * This data can be saved using file system (f) methods or used in a request.\n * @param image - ImageBitmap Image or Canvas\n * @param options\n * param opt.type='png' - png, jpg or image/png, image/jpg are valid\n * param mimeType= - Whether to include a data URI header\n */\nexport async function encodeImage(\n  image: any,\n  options?: {[key: string]: any}\n): Promise<ArrayBuffer> {\n  options = options || {};\n  options.image = options.image || ({} as {[key: string]: any});\n\n  return _encodeImageNode\n    ? _encodeImageNode(image, {type: options.image.mimeType})\n    : encodeImageInBrowser(image, options);\n}\n\n// In case we get exceptions from canvas.toBlob(resolve, type, quality)\nlet qualityParamSupported = true;\n\n/**\n *\n * @param image\n * @param options\n * @note Based on canvas.toBlob\n * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toBlob\n */\nasync function encodeImageInBrowser(image, options) {\n  const {mimeType, jpegQuality} = options.image;\n\n  const {width, height} = getImageSize(image);\n\n  // create a canvas and resize it to the size of our image\n  const canvas = document.createElement('canvas');\n  canvas.width = width;\n  canvas.height = height;\n\n  drawImageToCanvas(image, canvas);\n\n  // The actual encoding is done asynchronously with `canvas.toBlob()`\n  const blob = await new Promise<Blob | null>((resolve) => {\n    // get it back as a Blob\n    if (jpegQuality && qualityParamSupported) {\n      try {\n        canvas.toBlob(resolve, mimeType, jpegQuality);\n        return;\n      } catch (error) {\n        qualityParamSupported = false;\n      }\n    }\n    canvas.toBlob(resolve, mimeType);\n  });\n\n  if (!blob) {\n    throw new Error('image encoding failed');\n  }\n\n  return await blob.arrayBuffer();\n}\n\nfunction drawImageToCanvas(image, canvas, x = 0, y = 0) {\n  // Try optimized path for ImageBitmaps via bitmaprenderer context\n  if (x === 0 && y === 0 && typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap) {\n    const context = canvas.getContext('bitmaprenderer');\n    if (context) {\n      // transfer the ImageBitmap to it\n      context.transferFromImageBitmap(image);\n      return canvas;\n    }\n  }\n\n  // Available on most platforms, except IE11 and Andriod WebViews...\n  const context = canvas.getContext('2d');\n  if (image.data) {\n    // ImageData constructor expects clamped array even though getImageData does not return a clamped array...\n    const clampedArray = new Uint8ClampedArray(image.data);\n    const imageData = new ImageData(clampedArray, image.width, image.height);\n    context.putImageData(imageData, 0, 0);\n    return canvas;\n  }\n\n  // Fall back to generic image/image bitmap rendering path\n  context.drawImage(image, 0, 0);\n  return canvas;\n}\n", "// loaders.gl, MIT license\n\nimport {isBrowser} from '@loaders.gl/loader-utils';\n\nconst MIME_TYPES = [\n  'image/png',\n  'image/jpeg',\n  'image/gif',\n  'image/webp',\n  'image/avif',\n  'image/tiff',\n  // TODO - what is the correct type for SVG\n  'image/svg',\n  'image/svg+xml',\n  'image/bmp',\n  'image/vnd.microsoft.icon'\n];\n\n/** Only one round of tests is performed */\nconst mimeTypeSupportedPromise: Promise<Set<string>> | null = null;\n\n/** Run-time browser detection of file formats requires async tests for most precise results */\nexport async function getSupportedImageFormats(): Promise<Set<string>> {\n  if (mimeTypeSupportedPromise) {\n    return await mimeTypeSupportedPromise;\n  }\n\n  const supportedMimeTypes = new Set<string>();\n  for (const mimeType of MIME_TYPES) {\n    const supported = isBrowser\n      ? await checkBrowserImageFormatSupportAsync(mimeType)\n      : checkNodeImageFormatSupport(mimeType);\n    if (supported) {\n      supportedMimeTypes.add(mimeType);\n    }\n  }\n\n  return supportedMimeTypes;\n}\n\n/** Cache sync values for speed */\nconst mimeTypeSupportedSync: {[mimeType: string]: boolean} = {};\n\n/**\n * Check if image MIME type is supported. Result is cached to avoid repeated tests.\n */\nexport function isImageFormatSupported(mimeType: string): boolean {\n  if (mimeTypeSupportedSync[mimeType] === undefined) {\n    const supported = isBrowser\n      ? checkBrowserImageFormatSupport(mimeType)\n      : checkNodeImageFormatSupport(mimeType);\n    mimeTypeSupportedSync[mimeType] = supported;\n  }\n  return mimeTypeSupportedSync[mimeType];\n}\n\n/**\n * Checks that polyfills are installed and that mimeType is supported by polyfills\n * @todo Ideally polyfills should declare what formats they support, instead of storing that data here.\n */\nfunction checkNodeImageFormatSupport(mimeType: string): boolean {\n  /** @deprecated Remove these in 4.0 and rely on polyfills to inject them */\n  const NODE_FORMAT_SUPPORT = ['image/png', 'image/jpeg', 'image/gif'];\n  // @ts-ignore\n  const {_parseImageNode, _imageFormatsNode = NODE_FORMAT_SUPPORT} = globalThis;\n  return Boolean(_parseImageNode) && _imageFormatsNode.includes(mimeType);\n}\n\n/** Checks image format support synchronously.\n * @note Unreliable, fails on AVIF\n */\nfunction checkBrowserImageFormatSupport(mimeType: string): boolean {\n  switch (mimeType) {\n    case 'image/avif': // Will fail\n    case 'image/webp':\n      return testBrowserImageFormatSupport(mimeType);\n    default:\n      return true;\n  }\n}\n\nconst TEST_IMAGE = {\n  'image/avif':\n    'data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A=',\n  // Lossy test image. Support for lossy images doesn't guarantee support for all WebP images.\n  'image/webp': 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA'\n};\n\n/** Checks WebP and AVIF support asynchronously */\nasync function checkBrowserImageFormatSupportAsync(mimeType: string): Promise<boolean> {\n  const dataURL = TEST_IMAGE[mimeType];\n  return dataURL ? await testBrowserImageFormatSupportAsync(dataURL) : true;\n}\n\n/**\n * Checks browser synchronously\n * Checks if toDataURL supports the mimeType.\n * @note Imperfect testOn Chrome this is true for WebP but not for AVIF\n */\nfunction testBrowserImageFormatSupport(mimeType: string): boolean {\n  try {\n    const element = document.createElement('canvas');\n    const dataURL = element.toDataURL(mimeType);\n    return dataURL.indexOf(`data:${mimeType}`) === 0;\n  } catch {\n    // Probably Safari...\n    return false;\n  }\n}\n\n// Check WebPSupport asynchronously\nasync function testBrowserImageFormatSupportAsync(testImageDataURL: string): Promise<boolean> {\n  return new Promise((resolve) => {\n    const image = new Image();\n    image.src = testImageDataURL;\n    image.onload = () => resolve(image.height > 0);\n    image.onerror = () => resolve(false);\n  });\n}\n", "export default function assert(condition: unknown, message?: string): void {\n  if (!condition) {\n    throw new Error(`math.gl assertion ${message}`);\n  }\n}\n", "// Copyright (c) 2017 Uber Technologies, Inc.\n// MIT License\nimport {NumericArray} from '@math.gl/types';\nimport assert from './assert';\n\nimport type MathArray from '../classes/base/math-array';\n\nexport type ConfigurationOptions = {\n  EPSILON: number;\n  debug?: boolean;\n  precision: number;\n  printTypes?: boolean;\n  printDegrees?: boolean;\n  printRowMajor?: boolean;\n  _cartographicRadians?: boolean;\n};\n\nconst RADIANS_TO_DEGREES = (1 / Math.PI) * 180;\nconst DEGREES_TO_RADIANS = (1 / 180) * Math.PI;\n\n// TODO - remove\nexport const config: ConfigurationOptions = {\n  EPSILON: 1e-12,\n  debug: false,\n  precision: 4,\n  printTypes: false,\n  printDegrees: false,\n  printRowMajor: true\n};\n\nexport function configure(options?: Partial<ConfigurationOptions>): ConfigurationOptions {\n  // Only copy existing keys\n  for (const key in options) {\n    assert(key in config);\n    config[key] = options[key];\n  }\n  return config;\n}\n\n/**\n * Formats a value into a string\n * @param value\n * @param param1\n * @returns\n */\nexport function formatValue(\n  value: number,\n  {precision = config.precision}: {precision?: number} = {}\n): string {\n  value = round(value);\n  // get rid of trailing zeros\n  return `${parseFloat(value.toPrecision(precision))}`;\n}\n\n/**\n * Check if value is an \"array\"\n * Returns `true` if value is either an array or a typed array\n *\n * Note: returns `false` for `ArrayBuffer` and `DataView` instances\n */\nexport function isArray(value: unknown): boolean {\n  return Array.isArray(value) || (ArrayBuffer.isView(value) && !(value instanceof DataView));\n}\n\nexport function clone(array: NumericArray | MathArray): NumericArray {\n  return 'clone' in array ? array.clone() : array.slice();\n}\n\nexport function toRadians(degrees: number): number;\nexport function toRadians(degrees: NumericArray): NumericArray;\n\nexport function toRadians(degrees: number | NumericArray): number | NumericArray {\n  return radians(degrees as NumericArray);\n}\n\nexport function toDegrees(degrees: number): number;\nexport function toDegrees(degrees: NumericArray): NumericArray;\n\nexport function toDegrees(radians: number | NumericArray): number | NumericArray {\n  return degrees(radians as NumericArray);\n}\n\n// GLSL math function equivalents - Works on both single values and vectors\n\n/**\n * \"GLSL equivalent\" radians: Works on single values and vectors\n */\nexport function radians(degrees: number): number;\nexport function radians(degrees: NumericArray, result?: NumericArray): NumericArray;\n\nexport function radians(\n  degrees: number | NumericArray,\n  result?: NumericArray\n): number | NumericArray {\n  return map(degrees, (degrees) => degrees * DEGREES_TO_RADIANS, result);\n}\n\n/**\n * \"GLSL equivalent\" degrees: Works on single values and vectors\n */\nexport function degrees(radians: number): number;\nexport function degrees(radians: NumericArray, result?: NumericArray): NumericArray;\n\nexport function degrees(\n  radians: number | NumericArray,\n  result?: NumericArray\n): number | NumericArray {\n  return map(radians, (radians) => radians * RADIANS_TO_DEGREES, result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.sin`: Works on single values and vectors\n * @deprecated\n */\nexport function sin(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.sin(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.cos`: Works on single values and vectors\n * @deprecated\n */\nexport function cos(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.cos(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.tan`: Works on single values and vectors\n * @deprecated\n */\nexport function tan(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.tan(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.asin`: Works on single values and vectors\n * @deprecated\n */\nexport function asin(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.asin(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.acos`: Works on single values and vectors\n * @deprecated\n */\nexport function acos(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.acos(angle), result);\n}\n\n/**\n * \"GLSL equivalent\" of `Math.atan`: Works on single values and vectors\n * @deprecated\n */\nexport function atan(radians: number | NumericArray, result?: NumericArray): number | NumericArray {\n  return map(radians, (angle) => Math.atan(angle), result);\n}\n\n/**\n * GLSL style value clamping: Works on single values and vectors\n */\nexport function clamp(value: number, min: number, max: number): number;\nexport function clamp(value: NumericArray, min: number, max: number): NumericArray;\n\nexport function clamp(\n  value: number | NumericArray,\n  min: number,\n  max: number\n): number | NumericArray {\n  return map(value, (value) => Math.max(min, Math.min(max, value)));\n}\n\n/**\n * Interpolate between two numbers or two arrays\n */\nexport function lerp(a: number, b: number, t: number): number;\nexport function lerp(a: NumericArray, b: NumericArray, t: number): NumericArray;\n\nexport function lerp(\n  a: number | NumericArray,\n  b: number | NumericArray,\n  t: number\n): number | NumericArray {\n  if (isArray(a)) {\n    return (a as NumericArray).map((ai: number, i: number) => lerp(ai, (b as NumericArray)[i], t));\n  }\n  return t * (b as number) + (1 - t) * (a as number);\n}\n\n/* eslint-disable */\n\n/**\n * Compares any two math objects, using `equals` method if available.\n * @param a\n * @param b\n * @param epsilon\n * @returns\n */\nexport function equals(a: any, b: any, epsilon?: number): boolean {\n  const oldEpsilon = config.EPSILON;\n  if (epsilon) {\n    config.EPSILON = epsilon;\n  }\n  try {\n    if (a === b) {\n      return true;\n    }\n    if (isArray(a) && isArray(b)) {\n      if (a.length !== b.length) {\n        return false;\n      }\n      for (let i = 0; i < a.length; ++i) {\n        // eslint-disable-next-line max-depth\n        if (!equals(a[i], b[i])) {\n          return false;\n        }\n      }\n      return true;\n    }\n    if (a && a.equals) {\n      return a.equals(b);\n    }\n    if (b && b.equals) {\n      return b.equals(a);\n    }\n    if (typeof a === 'number' && typeof b === 'number') {\n      return Math.abs(a - b) <= config.EPSILON * Math.max(1, Math.abs(a), Math.abs(b));\n    }\n    return false;\n  } finally {\n    config.EPSILON = oldEpsilon;\n  }\n}\n\nexport function exactEquals(a: any, b: any): boolean {\n  if (a === b) {\n    return true;\n  }\n  if (a && typeof a === 'object' && b && typeof b === 'object') {\n    if (a.constructor !== b.constructor) {\n      return false;\n    }\n    if (a.exactEquals) {\n      return a.exactEquals(b);\n    }\n  }\n  if (isArray(a) && isArray(b)) {\n    if (a.length !== b.length) {\n      return false;\n    }\n    for (let i = 0; i < a.length; ++i) {\n      if (!exactEquals(a[i], b[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n  return false;\n}\n\n/* eslint-enable */\n\nexport function withEpsilon<T>(epsilon: number, func: () => T): T {\n  const oldPrecision = config.EPSILON;\n  config.EPSILON = epsilon;\n  let value: T;\n  try {\n    value = func();\n  } finally {\n    config.EPSILON = oldPrecision;\n  }\n  return value;\n}\n\n// HELPERS\n\nfunction round(value: number): number {\n  return Math.round(value / config.EPSILON) * config.EPSILON;\n}\n\n// If the array has a clone function, calls it, otherwise returns a copy\nfunction duplicateArray(array: NumericArray): NumericArray {\n  // @ts-expect-error We check for math.gl class methods\n  return array.clone ? array.clone() : (new Array(array.length) as number[]);\n}\n\n// If the argument value is an array, applies the func element wise,\n// otherwise applies func to the argument value\nfunction map(\n  value: number | NumericArray,\n  func: (x: number, index?: number, result?: NumericArray) => number,\n  result?: NumericArray\n): number | NumericArray {\n  if (isArray(value)) {\n    const array = value as NumericArray;\n    result = result || duplicateArray(array);\n    for (let i = 0; i < result.length && i < array.length; ++i) {\n      result[i] = func(value[i], i, result);\n    }\n    return result;\n  }\n  return func(value as number);\n}\n", "/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};", "import * as glMatrix from \"./common.js\";\n/**\n * 2 Dimensional Vector\n * @module vec2\n */\n\n/**\n * Creates a new, empty vec2\n *\n * @returns {vec2} a new 2D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(2);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec2 initialized with values from an existing vector\n *\n * @param {ReadonlyVec2} a vector to clone\n * @returns {vec2} a new 2D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\n * Creates a new vec2 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} a new 2D vector\n */\n\nexport function fromValues(x, y) {\n  var out = new glMatrix.ARRAY_TYPE(2);\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\n * Copy the values from one vec2 to another\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the source vector\n * @returns {vec2} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  return out;\n}\n/**\n * Set the components of a vec2 to the given values\n *\n * @param {vec2} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @returns {vec2} out\n */\n\nexport function set(out, x, y) {\n  out[0] = x;\n  out[1] = y;\n  return out;\n}\n/**\n * Adds two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  return out;\n}\n/**\n * Multiplies two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  return out;\n}\n/**\n * Divides two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  return out;\n}\n/**\n * Math.ceil the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to ceil\n * @returns {vec2} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  return out;\n}\n/**\n * Math.floor the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to floor\n * @returns {vec2} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  return out;\n}\n/**\n * Returns the minimum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  return out;\n}\n/**\n * Returns the maximum of two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec2} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  return out;\n}\n/**\n * Math.round the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to round\n * @returns {vec2} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  return out;\n}\n/**\n * Scales a vec2 by a scalar number\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec2} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  return out;\n}\n/**\n * Adds two vec2's after scaling the second operand by a scalar value\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec2} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return Math.hypot(x, y);\n}\n/**\n * Calculates the squared euclidian distance between two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1];\n  return x * x + y * y;\n}\n/**\n * Calculates the length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0],\n      y = a[1];\n  return Math.hypot(x, y);\n}\n/**\n * Calculates the squared length of a vec2\n *\n * @param {ReadonlyVec2} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0],\n      y = a[1];\n  return x * x + y * y;\n}\n/**\n * Negates the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to negate\n * @returns {vec2} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to invert\n * @returns {vec2} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  return out;\n}\n/**\n * Normalize a vec2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a vector to normalize\n * @returns {vec2} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0],\n      y = a[1];\n  var len = x * x + y * y;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec2's\n *\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1];\n}\n/**\n * Computes the cross product of two vec2's\n * Note that the cross product must by definition produce a 3D vector\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var z = a[0] * b[1] - a[1] * b[0];\n  out[0] = out[1] = 0;\n  out[2] = z;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec2's\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the first operand\n * @param {ReadonlyVec2} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec2} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0],\n      ay = a[1];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec2} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec2} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  out[0] = Math.cos(r) * scale;\n  out[1] = Math.sin(r) * scale;\n  return out;\n}\n/**\n * Transforms the vec2 with a mat2\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat2(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  return out;\n}\n/**\n * Transforms the vec2 with a mat2d\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat2d} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat2d(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[2] * y + m[4];\n  out[1] = m[1] * x + m[3] * y + m[5];\n  return out;\n}\n/**\n * Transforms the vec2 with a mat3\n * 3rd vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat3} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1];\n  out[0] = m[0] * x + m[3] * y + m[6];\n  out[1] = m[1] * x + m[4] * y + m[7];\n  return out;\n}\n/**\n * Transforms the vec2 with a mat4\n * 3rd vector component is implicitly '0'\n * 4th vector component is implicitly '1'\n *\n * @param {vec2} out the receiving vector\n * @param {ReadonlyVec2} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec2} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0];\n  var y = a[1];\n  out[0] = m[0] * x + m[4] * y + m[12];\n  out[1] = m[1] * x + m[5] * y + m[13];\n  return out;\n}\n/**\n * Rotate a 2D vector\n * @param {vec2} out The receiving vec2\n * @param {ReadonlyVec2} a The vec2 point to rotate\n * @param {ReadonlyVec2} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec2} out\n */\n\nexport function rotate(out, a, b, rad) {\n  //Translate point to the origin\n  var p0 = a[0] - b[0],\n      p1 = a[1] - b[1],\n      sinC = Math.sin(rad),\n      cosC = Math.cos(rad); //perform rotation and translate to correct position\n\n  out[0] = p0 * cosC - p1 * sinC + b[0];\n  out[1] = p0 * sinC + p1 * cosC + b[1];\n  return out;\n}\n/**\n * Get the angle between two 2D vectors\n * @param {ReadonlyVec2} a The first operand\n * @param {ReadonlyVec2} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var x1 = a[0],\n      y1 = a[1],\n      x2 = b[0],\n      y2 = b[1],\n      // mag is the product of the magnitudes of a and b\n  mag = Math.sqrt(x1 * x1 + y1 * y1) * Math.sqrt(x2 * x2 + y2 * y2),\n      // mag &&.. short circuits if mag == 0\n  cosine = mag && (x1 * x2 + y1 * y2) / mag; // Math.min(Math.max(cosine, -1), 1) clamps the cosine between -1 and 1\n\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec2 to zero\n *\n * @param {vec2} out the receiving vector\n * @returns {vec2} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec2} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec2(\" + a[0] + \", \" + a[1] + \")\";\n}\n/**\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec2} a The first vector.\n * @param {ReadonlyVec2} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1];\n  var b0 = b[0],\n      b1 = b[1];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));\n}\n/**\n * Alias for {@link vec2.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec2.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec2.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec2.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec2.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec2.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec2.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec2s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 2;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n    }\n\n    return a;\n  };\n}();", "import * as glMatrix from \"./common.js\";\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec3} out\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec3.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();", "// math.gl, MIT License\nimport {NumericArray} from '@math.gl/types';\nimport {ConfigurationOptions, config, formatValue, equals, isArray} from '../../lib/common';\n\n/** Base class for vectors and matrices */\nexport default abstract class MathArray extends Array<number> {\n  /** Number of elements (values) in this array */\n  abstract get ELEMENTS(): number;\n\n  abstract copy(vector: Readonly<NumericArray>): this;\n\n  abstract fromObject(object: object): this;\n\n  // Common methods\n\n  /**\n   * Clone the current object\n   * @returns a new copy of this object\n   */\n  clone(): this {\n    // @ts-expect-error TS2351: Cannot use 'new' with an expression whose type lacks a call or construct signature.\n    return new this.constructor().copy(this); // eslint-disable-line\n  }\n\n  fromArray(array: Readonly<NumericArray>, offset: number = 0): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = array[i + offset];\n    }\n    return this.check();\n  }\n\n  toArray<TypedArray>(targetArray: TypedArray, offset?: number): TypedArray;\n  toArray(targetArray?: number[], offset?: number): NumericArray;\n\n  toArray(targetArray: NumericArray = [], offset: number = 0): NumericArray {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      targetArray[offset + i] = this[i];\n    }\n    return targetArray;\n  }\n\n  from(arrayOrObject: Readonly<NumericArray> | object): this {\n    return Array.isArray(arrayOrObject) ? this.copy(arrayOrObject) : this.fromObject(arrayOrObject);\n  }\n\n  to<T extends NumericArray | object>(arrayOrObject: T): T {\n    // @ts-ignore\n    if (arrayOrObject === this) {\n      return this;\n    }\n    // @ts-expect-error TS2339: Property 'toObject' does not exist on type 'MathArray'.\n    return isArray(arrayOrObject) ? this.toArray(arrayOrObject) : this.toObject(arrayOrObject);\n  }\n\n  toTarget(target: this): this {\n    return target ? this.to(target) : this;\n  }\n\n  /** @deprecated */\n  toFloat32Array(): Float32Array {\n    return new Float32Array(this);\n  }\n\n  toString(): string {\n    return this.formatString(config);\n  }\n\n  /** Formats string according to options */\n  formatString(opts: ConfigurationOptions): string {\n    let string = '';\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      string += (i > 0 ? ', ' : '') + formatValue(this[i], opts);\n    }\n    return `${opts.printTypes ? this.constructor.name : ''}[${string}]`;\n  }\n\n  equals(array: Readonly<NumericArray>): boolean {\n    if (!array || this.length !== array.length) {\n      return false;\n    }\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      if (!equals(this[i], array[i])) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  exactEquals(array: Readonly<NumericArray>): boolean {\n    if (!array || this.length !== array.length) {\n      return false;\n    }\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      if (this[i] !== array[i]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  // Modifiers\n\n  /** Negates all values in this object */\n  negate(): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = -this[i];\n    }\n    return this.check();\n  }\n\n  /** Linearly interpolates between two values */\n  lerp(a: Readonly<NumericArray>, t: number): this;\n  lerp(a: Readonly<NumericArray>, b: Readonly<NumericArray>, t: number): this;\n\n  lerp(a: Readonly<NumericArray>, b: Readonly<NumericArray> | number, t?: number): this {\n    if (t === undefined) {\n      return this.lerp(this, a, b as number);\n    }\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      const ai = a[i];\n      this[i] = ai + t * (b[i] - ai);\n    }\n    return this.check();\n  }\n\n  /** Minimal */\n  min(vector: Readonly<NumericArray>): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(vector[i], this[i]);\n    }\n    return this.check();\n  }\n\n  /** Maximal */\n  max(vector: Readonly<NumericArray>): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.max(vector[i], this[i]);\n    }\n    return this.check();\n  }\n\n  clamp(minVector: Readonly<NumericArray>, maxVector: Readonly<NumericArray>): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(Math.max(this[i], minVector[i]), maxVector[i]);\n    }\n    return this.check();\n  }\n\n  add(...vectors: Readonly<NumericArray>[]): this {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] += vector[i];\n      }\n    }\n    return this.check();\n  }\n\n  subtract(...vectors: Readonly<NumericArray>[]): this {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] -= vector[i];\n      }\n    }\n    return this.check();\n  }\n\n  scale(scale: number | Readonly<NumericArray>): this {\n    if (typeof scale === 'number') {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] *= scale;\n      }\n    } else {\n      for (let i = 0; i < this.ELEMENTS && i < scale.length; ++i) {\n        this[i] *= scale[i];\n      }\n    }\n    return this.check();\n  }\n\n  /**\n   * Multiplies all elements by `scale`\n   * Note: `Matrix4.multiplyByScalar` only scales its 3x3 \"minor\"\n   */\n  multiplyByScalar(scalar: number): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] *= scalar;\n    }\n    return this.check();\n  }\n\n  // Debug checks\n\n  /** Throws an error if array length is incorrect or contains illegal values */\n  check(): this {\n    if (config.debug && !this.validate()) {\n      throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);\n    }\n    return this;\n  }\n\n  /** Returns false if the array length is incorrect or contains illegal values */\n  validate(): boolean {\n    let valid = this.length === this.ELEMENTS;\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      valid = valid && Number.isFinite(this[i]);\n    }\n    return valid;\n  }\n\n  // three.js compatibility\n\n  /** @deprecated */\n  sub(a: Readonly<NumericArray>): this {\n    return this.subtract(a);\n  }\n\n  /** @deprecated */\n  setScalar(a: number): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = a;\n    }\n    return this.check();\n  }\n\n  /** @deprecated */\n  addScalar(a: number): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] += a;\n    }\n    return this.check();\n  }\n\n  /** @deprecated */\n  subScalar(a: number): this {\n    return this.addScalar(-a);\n  }\n\n  /** @deprecated */\n  multiplyScalar(scalar: number): this {\n    // Multiplies all elements\n    // `Matrix4.scale` only scales its 3x3 \"minor\"\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] *= scalar;\n    }\n    return this.check();\n  }\n\n  /** @deprecated */\n  divideScalar(a: number): this {\n    return this.multiplyByScalar(1 / a);\n  }\n\n  /** @deprecated */\n  clampScalar(min: number, max: number): this {\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      this[i] = Math.min(Math.max(this[i], min), max);\n    }\n    return this.check();\n  }\n\n  /** @deprecated */\n  get elements(): NumericArray {\n    return this;\n  }\n}\n", "// Copyright (c) 2017 Uber Technologies, Inc.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\nimport {NumberArray} from '@math.gl/types';\nimport {config} from './common';\n\nexport function validateVector(v: NumberArray, length: number): boolean {\n  if (v.length !== length) {\n    return false;\n  }\n  // Could be arguments \"array\" (v.every not availasble)\n  for (let i = 0; i < v.length; ++i) {\n    if (!Number.isFinite(v[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function checkNumber(value: any): number {\n  if (!Number.isFinite(value)) {\n    throw new Error(`Invalid number ${value}`);\n  }\n  return value as number;\n}\n\nexport function checkVector<T extends NumberArray>(\n  v: T,\n  length: number,\n  callerName: string = ''\n): T {\n  if (config.debug && !validateVector(v, length)) {\n    throw new Error(`math.gl: ${callerName} some fields set to invalid numbers'`);\n  }\n  return v;\n}\n\nconst map = {};\n\nexport function deprecated(method: string, version: string): void {\n  if (!map[method]) {\n    map[method] = true;\n    // eslint-disable-next-line\n    console.warn(\n      `${method} has been removed in version ${version}, see upgrade guide for more information`\n    );\n  }\n}\n", "// Copyright (c) 2017 Uber Technologies, Inc.\n// MIT License\nimport {NumericArray} from '@math.gl/types';\nimport MathArray from './math-array';\nimport {checkNumber} from '../../lib/validators';\nimport assert from '../../lib/assert';\n\n/** Base class for vectors with at least 2 elements */\nexport default abstract class Vector extends MathArray {\n  // ACCESSORS\n\n  get x(): number {\n    return this[0];\n  }\n\n  set x(value: number) {\n    this[0] = checkNumber(value);\n  }\n\n  get y(): number {\n    return this[1];\n  }\n\n  set y(value: number) {\n    this[1] = checkNumber(value);\n  }\n\n  /**\n   * Returns the length of the vector from the origin to the point described by this vector\n   *\n   * @note `length` is a reserved word for Arrays, so `v.length()` will return number of elements\n   * Instead we provide `len` and `magnitude`\n   */\n  len(): number {\n    return Math.sqrt(this.lengthSquared());\n  }\n\n  /**\n   * Returns the length of the vector from the origin to the point described by this vector\n   */\n  magnitude(): number {\n    return this.len();\n  }\n\n  /**\n   * Returns the squared length of the vector from the origin to the point described by this vector\n   */\n  lengthSquared(): number {\n    let length = 0;\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      length += this[i] * this[i];\n    }\n    return length;\n  }\n\n  /**\n   * Returns the squared length of the vector from the origin to the point described by this vector\n   */\n  magnitudeSquared(): number {\n    return this.lengthSquared();\n  }\n\n  distance(mathArray: Readonly<NumericArray>): number {\n    return Math.sqrt(this.distanceSquared(mathArray));\n  }\n\n  distanceSquared(mathArray: Readonly<NumericArray>): number {\n    let length = 0;\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      const dist = this[i] - mathArray[i];\n      length += dist * dist;\n    }\n    return checkNumber(length);\n  }\n\n  dot(mathArray: Readonly<NumericArray>): number {\n    let product = 0;\n    for (let i = 0; i < this.ELEMENTS; ++i) {\n      product += this[i] * mathArray[i];\n    }\n    return checkNumber(product);\n  }\n\n  // MODIFIERS\n\n  normalize(): this {\n    const length = this.magnitude();\n    if (length !== 0) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] /= length;\n      }\n    }\n    return this.check();\n  }\n\n  multiply(...vectors: Readonly<NumericArray>[]): this {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] *= vector[i];\n      }\n    }\n    return this.check();\n  }\n\n  divide(...vectors: Readonly<NumericArray>[]): this {\n    for (const vector of vectors) {\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        this[i] /= vector[i];\n      }\n    }\n    return this.check();\n  }\n\n  // THREE.js compatibility\n\n  lengthSq(): number {\n    return this.lengthSquared();\n  }\n  distanceTo(vector: Readonly<NumericArray>): number {\n    return this.distance(vector);\n  }\n  distanceToSquared(vector: Readonly<NumericArray>): number {\n    return this.distanceSquared(vector);\n  }\n\n  getComponent(i: number): number {\n    assert(i >= 0 && i < this.ELEMENTS, 'index is out of range');\n    return checkNumber(this[i]);\n  }\n\n  setComponent(i: number, value: number): this {\n    assert(i >= 0 && i < this.ELEMENTS, 'index is out of range');\n    this[i] = value;\n    return this.check();\n  }\n\n  addVectors(a: Readonly<NumericArray>, b: Readonly<NumericArray>): this {\n    return this.copy(a).add(b);\n  }\n\n  subVectors(a: Readonly<NumericArray>, b: Readonly<NumericArray>): this {\n    return this.copy(a).subtract(b);\n  }\n\n  multiplyVectors(a: Readonly<NumericArray>, b: Readonly<NumericArray>): this {\n    return this.copy(a).multiply(b);\n  }\n\n  addScaledVector(a: Readonly<NumericArray>, b: number): this {\n    // @ts-expect-error error TS2351: Cannot use 'new' with an expression whose type lacks a call or construct signature.\n    return this.add(new this.constructor(a).multiplyScalar(b));\n  }\n}\n", "/* eslint-disable camelcase */\nimport {NumericArray} from '@math.gl/types';\n// vec2 additions\n\nexport function vec2_transformMat4AsVector<T extends NumericArray>(\n  out: T,\n  a: Readonly<NumericArray>,\n  m: Readonly<NumericArray>\n): T {\n  const x = a[0];\n  const y = a[1];\n  const w = m[3] * x + m[7] * y || 1.0;\n  out[0] = (m[0] * x + m[4] * y) / w;\n  out[1] = (m[1] * x + m[5] * y) / w;\n  return out;\n}\n\n// vec3 additions\n\n// Transform as vector, only uses 3x3 minor matrix\nexport function vec3_transformMat4AsVector<T extends NumericArray>(\n  out: T,\n  a: Readonly<NumericArray>,\n  m: Readonly<NumericArray>\n): T {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  const w = m[3] * x + m[7] * y + m[11] * z || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z) / w;\n  return out;\n}\n\nexport function vec3_transformMat2<T extends NumericArray>(\n  out: T,\n  a: Readonly<NumericArray>,\n  m: Readonly<NumericArray>\n): T {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  out[2] = a[2];\n  return out;\n}\n\n// vec4 additions\n\nexport function vec4_transformMat2<T extends NumericArray>(\n  out: T,\n  a: Readonly<NumericArray>,\n  m: Readonly<NumericArray>\n): T {\n  const x = a[0];\n  const y = a[1];\n  out[0] = m[0] * x + m[2] * y;\n  out[1] = m[1] * x + m[3] * y;\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n\nexport function vec4_transformMat3<T extends NumericArray>(\n  out: T,\n  a: Readonly<NumericArray>,\n  m: Readonly<NumericArray>\n): T {\n  const x = a[0];\n  const y = a[1];\n  const z = a[2];\n  out[0] = m[0] * x + m[3] * y + m[6] * z;\n  out[1] = m[1] * x + m[4] * y + m[7] * z;\n  out[2] = m[2] * x + m[5] * y + m[8] * z;\n  out[3] = a[3];\n  return out;\n}\n", "// Copyright (c) 2017 Uber Technologies, Inc.\n// MIT License\nimport {NumericArray} from '@math.gl/types';\nimport Vector from './base/vector';\nimport {config, isArray} from '../lib/common';\nimport {checkNumber} from '../lib/validators';\nimport * as vec3 from 'gl-matrix/vec3';\n/* eslint-disable camelcase */\nimport {vec3_transformMat2, vec3_transformMat4AsVector} from '../lib/gl-matrix-extras';\n\nconst ORIGIN = [0, 0, 0];\n\nlet ZERO: Vector3;\n\n/**\n * Three-element vector class.\n * Subclass of Array<number>\n */\nexport default class Vector3 extends Vector {\n  static get ZERO(): Vector3 {\n    if (!ZERO) {\n      ZERO = new Vector3(0, 0, 0);\n      Object.freeze(ZERO);\n    }\n    return ZERO;\n  }\n\n  /**\n   * @class\n   * @param x\n   * @param y\n   * @param z\n   */\n  constructor(x: number | Readonly<NumericArray> = 0, y: number = 0, z: number = 0) {\n    // PERF NOTE: initialize elements as double precision numbers\n    super(-0, -0, -0);\n    if (arguments.length === 1 && isArray(x)) {\n      this.copy(x as NumericArray);\n    } else {\n      // this.set(x, y, z);\n      if (config.debug) {\n        checkNumber(x);\n        checkNumber(y);\n        checkNumber(z);\n      }\n      // @ts-expect-error TS2412: Property '0' of type 'number | [number, number, number]' is not assignable to numeric index type 'number'\n      this[0] = x;\n      this[1] = y;\n      this[2] = z;\n    }\n  }\n\n  set(x: number, y: number, z: number): this {\n    this[0] = x;\n    this[1] = y;\n    this[2] = z;\n    return this.check();\n  }\n\n  copy(array: Readonly<NumericArray>): this {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    return this.check();\n  }\n\n  fromObject(object: {x: number; y: number; z: number}): this {\n    if (config.debug) {\n      checkNumber(object.x);\n      checkNumber(object.y);\n      checkNumber(object.z);\n    }\n    this[0] = object.x;\n    this[1] = object.y;\n    this[2] = object.z;\n    return this.check();\n  }\n\n  toObject(object: {x?: number; y?: number; z?: number}): {x: number; y: number; z: number} {\n    object.x = this[0];\n    object.y = this[1];\n    object.z = this[2];\n    return object as {x: number; y: number; z: number};\n  }\n\n  // Getters/setters\n\n  get ELEMENTS(): number {\n    return 3;\n  }\n  get z(): number {\n    return this[2];\n  }\n  set z(value: number) {\n    this[2] = checkNumber(value);\n  }\n\n  // ACCESSORS\n\n  angle(vector: Readonly<NumericArray>): number {\n    return vec3.angle(this, vector);\n  }\n\n  // MODIFIERS\n\n  cross(vector: Readonly<NumericArray>): this {\n    vec3.cross(this, this, vector);\n    return this.check();\n  }\n\n  rotateX({radians, origin = ORIGIN}: {radians: number; origin?: Readonly<NumericArray>}): this {\n    vec3.rotateX(this, this, origin, radians);\n    return this.check();\n  }\n\n  rotateY({radians, origin = ORIGIN}: {radians: number; origin?: Readonly<NumericArray>}): this {\n    vec3.rotateY(this, this, origin, radians);\n    return this.check();\n  }\n\n  rotateZ({radians, origin = ORIGIN}: {radians: number; origin?: Readonly<NumericArray>}): this {\n    vec3.rotateZ(this, this, origin, radians);\n    return this.check();\n  }\n\n  // Transforms\n\n  // transforms as point (4th component is implicitly 1)\n  transform(matrix4: Readonly<NumericArray>): this {\n    return this.transformAsPoint(matrix4);\n  }\n\n  // transforms as point (4th component is implicitly 1)\n  transformAsPoint(matrix4: Readonly<NumericArray>): this {\n    vec3.transformMat4(this, this, matrix4);\n    return this.check();\n  }\n\n  // transforms as vector  (4th component is implicitly 0, ignores translation. slightly faster)\n  transformAsVector(matrix4: Readonly<NumericArray>): this {\n    vec3_transformMat4AsVector(this, this, matrix4);\n    return this.check();\n  }\n\n  transformByMatrix3(matrix3: Readonly<NumericArray>): this {\n    vec3.transformMat3(this, this, matrix3);\n    return this.check();\n  }\n\n  transformByMatrix2(matrix2: Readonly<NumericArray>): this {\n    vec3_transformMat2(this, this, matrix2);\n    return this.check();\n  }\n\n  transformByQuaternion(quaternion: Readonly<NumericArray>): this {\n    vec3.transformQuat(this, this, quaternion);\n    return this.check();\n  }\n}\n", "import * as glMatrix from \"./common.js\";\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion paramter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     mat4.translate(dest, origin);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *     mat4.translate(dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\n\nexport var perspective = perspectiveNO;\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\n\nexport var ortho = orthoNO;\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\n\nexport var sub = subtract;", "import * as glMatrix from \"./common.js\";\n/**\n * 4 Dimensional Vector\n * @module vec4\n */\n\n/**\n * Creates a new, empty vec4\n *\n * @returns {vec4} a new 4D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec4 initialized with values from an existing vector\n *\n * @param {ReadonlyVec4} a vector to clone\n * @returns {vec4} a new 4D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Creates a new vec4 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} a new 4D vector\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\n * Copy the values from one vec4 to another\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the source vector\n * @returns {vec4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Set the components of a vec4 to the given values\n *\n * @param {vec4} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} out\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\n * Adds two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\n * Multiplies two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\n * Divides two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\n * Math.ceil the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to ceil\n * @returns {vec4} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\n * Math.floor the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to floor\n * @returns {vec4} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\n * Returns the minimum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\n * Returns the maximum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\n * Math.round the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to round\n * @returns {vec4} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\n * Scales a vec4 by a scalar number\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec4} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\n * Adds two vec4's after scaling the second operand by a scalar value\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec4} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\n * Calculates the squared euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\n * Calculates the length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\n * Calculates the squared length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\n * Negates the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to negate\n * @returns {vec4} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to invert\n * @returns {vec4} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\n * Normalize a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to normalize\n * @returns {vec4} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\n * Returns the cross-product of three vectors in a 4-dimensional space\n *\n * @param {ReadonlyVec4} result the receiving vector\n * @param {ReadonlyVec4} U the first vector\n * @param {ReadonlyVec4} V the second vector\n * @param {ReadonlyVec4} W the third vector\n * @returns {vec4} result\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec4} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec4} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec4} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\n * Transforms the vec4 with a mat4.\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec4} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\n * Transforms the vec4 with a quat\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec4} out\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\n * Set the components of a vec4 to zero\n *\n * @param {vec4} out the receiving vector\n * @returns {vec4} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec4} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\n * Alias for {@link vec4.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec4.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec4.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec4.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec4.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec4.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec4s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();", "// Copyright (c) 2017 Uber Technologies, Inc.\n// MIT License\nimport {NumericArray} from '@math.gl/types';\nimport MathArray from './math-array';\nimport {checkNumber} from '../../lib/validators';\nimport {config} from '../../lib/common';\n\n/** Base class for matrices */\nexport default abstract class Matrix extends MathArray {\n  abstract get RANK(): number;\n\n  // fromObject(object) {\n  //   const array = object.elements;\n  //   return this.fromRowMajor(array);\n  // }\n  // toObject(object) {\n  //   const array = object.elements;\n  //   this.toRowMajor(array);\n  //   return object;\n  // }\n\n  // TODO better override formatString?\n  toString(): string {\n    let string = '[';\n    if (config.printRowMajor) {\n      string += 'row-major:';\n      for (let row = 0; row < this.RANK; ++row) {\n        for (let col = 0; col < this.RANK; ++col) {\n          string += ` ${this[col * this.RANK + row]}`;\n        }\n      }\n    } else {\n      string += 'column-major:';\n      for (let i = 0; i < this.ELEMENTS; ++i) {\n        string += ` ${this[i]}`;\n      }\n    }\n    string += ']';\n    return string;\n  }\n\n  getElementIndex(row: number, col: number): number {\n    return col * this.RANK + row;\n  }\n\n  // By default assumes row major indices\n  getElement(row: number, col: number): number {\n    return this[col * this.RANK + row];\n  }\n\n  // By default assumes row major indices\n  setElement(row: number, col: number, value: number): this {\n    this[col * this.RANK + row] = checkNumber(value);\n    return this;\n  }\n  getColumn<NumArrayT>(columnIndex: number, result: NumArrayT): NumArrayT;\n  getColumn(columnIndex: number): number[];\n\n  getColumn(columnIndex: number, result: number[] = new Array(this.RANK).fill(-0)): number[] {\n    const firstIndex = columnIndex * this.RANK;\n    for (let i = 0; i < this.RANK; ++i) {\n      result[i] = this[firstIndex + i];\n    }\n    return result;\n  }\n\n  setColumn(columnIndex: number, columnVector: Readonly<NumericArray>): this {\n    const firstIndex = columnIndex * this.RANK;\n    for (let i = 0; i < this.RANK; ++i) {\n      this[firstIndex + i] = columnVector[i];\n    }\n    return this;\n  }\n}\n", "// Copyright (c) 2017 Uber Technologies, Inc.\n// MIT License\nimport Matrix from './base/matrix';\nimport {NumericArray} from '@math.gl/types';\nimport {checkVector} from '../lib/validators';\n\n/* eslint-disable camelcase */\nimport {vec2_transformMat4AsVector, vec3_transformMat4AsVector} from '../lib/gl-matrix-extras';\nimport * as mat4 from 'gl-matrix/mat4';\nimport * as vec2 from 'gl-matrix/vec2';\nimport * as vec3 from 'gl-matrix/vec3';\nimport * as vec4 from 'gl-matrix/vec4';\n\nenum INDICES {\n  COL0ROW0 = 0,\n  COL0ROW1 = 1,\n  COL0ROW2 = 2,\n  COL0ROW3 = 3,\n  COL1ROW0 = 4,\n  COL1ROW1 = 5,\n  COL1ROW2 = 6,\n  COL1ROW3 = 7,\n  COL2ROW0 = 8,\n  COL2ROW1 = 9,\n  COL2ROW2 = 10,\n  COL2ROW3 = 11,\n  COL3ROW0 = 12,\n  COL3ROW1 = 13,\n  COL3ROW2 = 14,\n  COL3ROW3 = 15\n}\n\nconst DEFAULT_FOVY = (45 * Math.PI) / 180;\nconst DEFAULT_ASPECT = 1;\nconst DEFAULT_NEAR = 0.1;\nconst DEFAULT_FAR = 500;\n\nconst IDENTITY_MATRIX = Object.freeze([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1]);\n\n/** 4x4 matrix */\nexport default class Matrix4 extends Matrix {\n  static get IDENTITY(): Readonly<Matrix4> {\n    return getIdentityMatrix();\n  }\n\n  static get ZERO(): Readonly<Matrix4> {\n    return getZeroMatrix();\n  }\n\n  get ELEMENTS(): number {\n    return 16;\n  }\n\n  get RANK(): number {\n    return 4;\n  }\n\n  get INDICES(): typeof INDICES {\n    return INDICES;\n  }\n\n  constructor(array?: Readonly<NumericArray>) {\n    // PERF NOTE: initialize elements as double precision numbers\n    super(-0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0);\n    if (arguments.length === 1 && Array.isArray(array)) {\n      this.copy(array);\n    } else {\n      this.identity();\n    }\n  }\n\n  copy(array: Readonly<NumericArray>): this {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    this[3] = array[3];\n    this[4] = array[4];\n    this[5] = array[5];\n    this[6] = array[6];\n    this[7] = array[7];\n    this[8] = array[8];\n    this[9] = array[9];\n    this[10] = array[10];\n    this[11] = array[11];\n    this[12] = array[12];\n    this[13] = array[13];\n    this[14] = array[14];\n    this[15] = array[15];\n    return this.check();\n  }\n\n  // eslint-disable-next-line max-params\n  set(\n    m00: number,\n    m10: number,\n    m20: number,\n    m30: number,\n    m01: number,\n    m11: number,\n    m21: number,\n    m31: number,\n    m02: number,\n    m12: number,\n    m22: number,\n    m32: number,\n    m03: number,\n    m13: number,\n    m23: number,\n    m33: number\n  ): this {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m30;\n    this[4] = m01;\n    this[5] = m11;\n    this[6] = m21;\n    this[7] = m31;\n    this[8] = m02;\n    this[9] = m12;\n    this[10] = m22;\n    this[11] = m32;\n    this[12] = m03;\n    this[13] = m13;\n    this[14] = m23;\n    this[15] = m33;\n    return this.check();\n  }\n\n  // accepts row major order, stores as column major\n  // eslint-disable-next-line max-params\n  setRowMajor(\n    m00: number,\n    m01: number,\n    m02: number,\n    m03: number,\n    m10: number,\n    m11: number,\n    m12: number,\n    m13: number,\n    m20: number,\n    m21: number,\n    m22: number,\n    m23: number,\n    m30: number,\n    m31: number,\n    m32: number,\n    m33: number\n  ): this {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m30;\n    this[4] = m01;\n    this[5] = m11;\n    this[6] = m21;\n    this[7] = m31;\n    this[8] = m02;\n    this[9] = m12;\n    this[10] = m22;\n    this[11] = m32;\n    this[12] = m03;\n    this[13] = m13;\n    this[14] = m23;\n    this[15] = m33;\n    return this.check();\n  }\n\n  toRowMajor(result: NumericArray): NumericArray {\n    result[0] = this[0];\n    result[1] = this[4];\n    result[2] = this[8];\n    result[3] = this[12];\n    result[4] = this[1];\n    result[5] = this[5];\n    result[6] = this[9];\n    result[7] = this[13];\n    result[8] = this[2];\n    result[9] = this[6];\n    result[10] = this[10];\n    result[11] = this[14];\n    result[12] = this[3];\n    result[13] = this[7];\n    result[14] = this[11];\n    result[15] = this[15];\n    return result;\n  }\n\n  // Constructors\n\n  /** Set to identity matrix */\n  identity(): this {\n    return this.copy(IDENTITY_MATRIX);\n  }\n\n  /**\n   *\n   * @param object\n   * @returns self\n   */\n  fromObject(object: {[key: string]: any}): this {\n    return this.check();\n  }\n\n  /**\n   * Calculates a 4x4 matrix from the given quaternion\n   * @param quaternion Quaternion to create matrix from\n   * @returns self\n   */\n  fromQuaternion(quaternion: Readonly<NumericArray>): this {\n    mat4.fromQuat(this, quaternion);\n    return this.check();\n  }\n\n  /**\n   * Generates a frustum matrix with the given bounds\n   * @param view.left - Left bound of the frustum\n   * @param view.right - Right bound of the frustum\n   * @param view.bottom - Bottom bound of the frustum\n   * @param view.top - Top bound of the frustum\n   * @param view.near - Near bound of the frustum\n   * @param view.far - Far bound of the frustum. Can be set to Infinity.\n   * @returns self\n   */\n  frustum(view: {\n    left: number;\n    right: number;\n    bottom: number;\n    top: number;\n    near: number;\n    far?: number;\n  }): this {\n    const {left, right, bottom, top, near = DEFAULT_NEAR, far = DEFAULT_FAR} = view;\n    if (far === Infinity) {\n      computeInfinitePerspectiveOffCenter(this, left, right, bottom, top, near);\n    } else {\n      mat4.frustum(this, left, right, bottom, top, near, far);\n    }\n    return this.check();\n  }\n\n  /**\n   * Generates a look-at matrix with the given eye position, focal point,\n   * and up axis\n   * @param view.eye - (vector) Position of the viewer\n   * @param view.center - (vector) Point the viewer is looking at\n   * @param view.up - (vector) Up axis\n   * @returns self\n   */\n  lookAt(view: {\n    eye: Readonly<NumericArray>;\n    center?: Readonly<NumericArray>;\n    up?: Readonly<NumericArray>;\n  }): this {\n    const {eye, center = [0, 0, 0], up = [0, 1, 0]} = view;\n    mat4.lookAt(this, eye, center, up);\n    return this.check();\n  }\n\n  /**\n   * Generates a orthogonal projection matrix with the given bounds\n   * from \"traditional\" view space parameters\n   * @param view.left - Left bound of the frustum\n   * @param view.right number  Right bound of the frustum\n   * @param view.bottom - Bottom bound of the frustum\n   * @param view.top number  Top bound of the frustum\n   * @param view.near - Near bound of the frustum\n   * @param view.far number  Far bound of the frustum\n   * @returns self\n   */\n  ortho(view: {\n    left: number;\n    right: number;\n    bottom: number;\n    top: number;\n    near?: number;\n    far?: number;\n  }): this {\n    const {left, right, bottom, top, near = DEFAULT_NEAR, far = DEFAULT_FAR} = view;\n    mat4.ortho(this, left, right, bottom, top, near, far);\n    return this.check();\n  }\n\n  /**\n   * Generates an orthogonal projection matrix with the same parameters\n   * as a perspective matrix (plus focalDistance)\n   * @param view.fovy Vertical field of view in radians\n   * @param view.aspect Aspect ratio. Typically viewport width / viewport height\n   * @param view.focalDistance Distance in the view frustum used for extent calculations\n   * @param view.near Near bound of the frustum\n   * @param view.far Far bound of the frustum\n   * @returns self\n   */\n  orthographic(view: {\n    fovy?: number;\n    aspect?: number;\n    focalDistance?: number;\n    near?: number;\n    far?: number;\n  }): this {\n    const {\n      fovy = DEFAULT_FOVY,\n      aspect = DEFAULT_ASPECT,\n      focalDistance = 1,\n      near = DEFAULT_NEAR,\n      far = DEFAULT_FAR\n    } = view;\n\n    checkRadians(fovy);\n\n    const halfY = fovy / 2;\n    const top = focalDistance * Math.tan(halfY); // focus_plane is the distance from the camera\n    const right = top * aspect;\n\n    return this.ortho({\n      left: -right,\n      right,\n      bottom: -top,\n      top,\n      near,\n      far\n    });\n  }\n\n  /**\n   * Generates a perspective projection matrix with the given bounds\n   * @param view.fovy Vertical field of view in radians\n   * @param view.aspect Aspect ratio. typically viewport width/height\n   * @param view.near Near bound of the frustum\n   * @param view.far Far bound of the frustum\n   * @returns self\n   */\n  perspective(view: {fovy: number; aspect?: number; near?: number; far?: number}): this {\n    const {fovy = (45 * Math.PI) / 180, aspect = 1, near = 0.1, far = 500} = view;\n    checkRadians(fovy);\n    mat4.perspective(this, fovy, aspect, near, far);\n    return this.check();\n  }\n\n  // Accessors\n\n  determinant(): number {\n    return mat4.determinant(this);\n  }\n\n  /**\n   * Extracts the non-uniform scale assuming the matrix is an affine transformation.\n   * The scales are the \"lengths\" of the column vectors in the upper-left 3x3 matrix.\n   * @param result\n   * @returns self\n   */\n  getScale(result: NumericArray = [-0, -0, -0]): NumericArray {\n    // explicit is faster than hypot...\n    result[0] = Math.sqrt(this[0] * this[0] + this[1] * this[1] + this[2] * this[2]);\n    result[1] = Math.sqrt(this[4] * this[4] + this[5] * this[5] + this[6] * this[6]);\n    result[2] = Math.sqrt(this[8] * this[8] + this[9] * this[9] + this[10] * this[10]);\n    // result[0] = Math.hypot(this[0], this[1], this[2]);\n    // result[1] = Math.hypot(this[4], this[5], this[6]);\n    // result[2] = Math.hypot(this[8], this[9], this[10]);\n    return result;\n  }\n\n  /**\n   * Gets the translation portion, assuming the matrix is a affine transformation matrix.\n   * @param result\n   * @returns self\n   */\n  getTranslation(result: NumericArray = [-0, -0, -0]): NumericArray {\n    result[0] = this[12];\n    result[1] = this[13];\n    result[2] = this[14];\n    return result;\n  }\n\n  /**\n   * Gets upper left 3x3 pure rotation matrix (non-scaling), assume affine transformation matrix\n   * @param result\n   * @param scaleResult\n   * @returns self\n   */\n  getRotation(result?: NumericArray, scaleResult?: NumericArray): NumericArray {\n    result = result || [-0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0];\n    scaleResult = scaleResult || [-0, -0, -0];\n    const scale = this.getScale(scaleResult);\n    const inverseScale0 = 1 / scale[0];\n    const inverseScale1 = 1 / scale[1];\n    const inverseScale2 = 1 / scale[2];\n    result[0] = this[0] * inverseScale0;\n    result[1] = this[1] * inverseScale1;\n    result[2] = this[2] * inverseScale2;\n    result[3] = 0;\n    result[4] = this[4] * inverseScale0;\n    result[5] = this[5] * inverseScale1;\n    result[6] = this[6] * inverseScale2;\n    result[7] = 0;\n    result[8] = this[8] * inverseScale0;\n    result[9] = this[9] * inverseScale1;\n    result[10] = this[10] * inverseScale2;\n    result[11] = 0;\n    result[12] = 0;\n    result[13] = 0;\n    result[14] = 0;\n    result[15] = 1;\n    return result;\n  }\n\n  /**\n   *\n   * @param result\n   * @param scaleResult\n   * @returns self\n   */\n  getRotationMatrix3(result?: NumericArray, scaleResult?: NumericArray): NumericArray {\n    result = result || [-0, -0, -0, -0, -0, -0, -0, -0, -0];\n    scaleResult = scaleResult || [-0, -0, -0];\n    const scale = this.getScale(scaleResult);\n    const inverseScale0 = 1 / scale[0];\n    const inverseScale1 = 1 / scale[1];\n    const inverseScale2 = 1 / scale[2];\n    result[0] = this[0] * inverseScale0;\n    result[1] = this[1] * inverseScale1;\n    result[2] = this[2] * inverseScale2;\n    result[3] = this[4] * inverseScale0;\n    result[4] = this[5] * inverseScale1;\n    result[5] = this[6] * inverseScale2;\n    result[6] = this[8] * inverseScale0;\n    result[7] = this[9] * inverseScale1;\n    result[8] = this[10] * inverseScale2;\n    return result;\n  }\n\n  // Modifiers\n\n  transpose(): this {\n    mat4.transpose(this, this);\n    return this.check();\n  }\n\n  invert(): this {\n    mat4.invert(this, this);\n    return this.check();\n  }\n\n  // Operations\n\n  multiplyLeft(a: Readonly<NumericArray>): this {\n    mat4.multiply(this, a, this);\n    return this.check();\n  }\n\n  multiplyRight(a: Readonly<NumericArray>): this {\n    mat4.multiply(this, this, a);\n    return this.check();\n  }\n\n  // Rotates a matrix by the given angle around the X axis\n  rotateX(radians: number): this {\n    mat4.rotateX(this, this, radians);\n    // mat4.rotate(this, this, radians, [1, 0, 0]);\n    return this.check();\n  }\n\n  // Rotates a matrix by the given angle around the Y axis.\n  rotateY(radians: number): this {\n    mat4.rotateY(this, this, radians);\n    // mat4.rotate(this, this, radians, [0, 1, 0]);\n    return this.check();\n  }\n\n  /**\n   * Rotates a matrix by the given angle around the Z axis.\n   * @param radians\n   * @returns self\n   */\n  rotateZ(radians: number): this {\n    mat4.rotateZ(this, this, radians);\n    // mat4.rotate(this, this, radians, [0, 0, 1]);\n    return this.check();\n  }\n\n  /**\n   *\n   * @param param0\n   * @returns self\n   */\n  rotateXYZ(angleXYZ: Readonly<NumericArray>): this {\n    return this.rotateX(angleXYZ[0]).rotateY(angleXYZ[1]).rotateZ(angleXYZ[2]);\n  }\n\n  /**\n   *\n   * @param radians\n   * @param axis\n   * @returns self\n   */\n  rotateAxis(radians: number, axis: Readonly<NumericArray>): this {\n    mat4.rotate(this, this, radians, axis);\n    return this.check();\n  }\n\n  /**\n   *\n   * @param factor\n   * @returns self\n   */\n  scale(factor: number | Readonly<NumericArray>): this {\n    mat4.scale(this, this, Array.isArray(factor) ? factor : [factor, factor, factor]);\n    return this.check();\n  }\n\n  /**\n   *\n   * @param vec\n   * @returns self\n   */\n  translate(vector: Readonly<NumericArray>): this {\n    mat4.translate(this, this, vector);\n    return this.check();\n  }\n\n  // Transforms\n\n  /**\n   * Transforms any 2, 3 or 4 element vector. 2 and 3 elements are treated as points\n   * @param vector\n   * @param result\n   * @returns self\n   */\n  transform(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    if (vector.length === 4) {\n      result = vec4.transformMat4(result || [-0, -0, -0, -0], vector, this);\n      checkVector(result, 4);\n      return result;\n    }\n    return this.transformAsPoint(vector, result);\n  }\n\n  /**\n   * Transforms any 2 or 3 element array as point (w implicitly 1)\n   * @param vector\n   * @param result\n   * @returns self\n   */\n  transformAsPoint(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    const {length} = vector;\n    let out: NumericArray;\n    switch (length) {\n      case 2:\n        out = vec2.transformMat4(result || [-0, -0], vector, this);\n        break;\n      case 3:\n        out = vec3.transformMat4(result || [-0, -0, -0], vector, this);\n        break;\n      default:\n        throw new Error('Illegal vector');\n    }\n    checkVector(out, vector.length);\n    return out;\n  }\n\n  /**\n   * Transforms any 2 or 3 element array as vector (w implicitly 0)\n   * @param vector\n   * @param result\n   * @returns self\n   */\n  transformAsVector(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    let out: NumericArray;\n    switch (vector.length) {\n      case 2:\n        out = vec2_transformMat4AsVector(result || [-0, -0], vector, this);\n        break;\n      case 3:\n        out = vec3_transformMat4AsVector(result || [-0, -0, -0], vector, this);\n        break;\n      default:\n        throw new Error('Illegal vector');\n    }\n    checkVector(out, vector.length);\n    return out;\n  }\n\n  /** @deprecated */\n  transformPoint(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    return this.transformAsPoint(vector, result);\n  }\n\n  /** @deprecated */\n  transformVector(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    return this.transformAsPoint(vector, result);\n  }\n\n  /** @deprecated */\n  transformDirection(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    return this.transformAsVector(vector, result);\n  }\n\n  // three.js math API compatibility\n\n  makeRotationX(radians: number): this {\n    return this.identity().rotateX(radians);\n  }\n\n  makeTranslation(x: number, y: number, z: number): this {\n    return this.identity().translate([x, y, z]);\n  }\n}\n\n// TODO initializing static members directly is an option, but make sure no tree-shaking issues\nlet ZERO: Matrix4;\nlet IDENTITY: Matrix4;\n\nfunction getZeroMatrix(): Readonly<Matrix4> {\n  if (!ZERO) {\n    ZERO = new Matrix4([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\n    Object.freeze(ZERO);\n  }\n  return ZERO;\n}\n\nfunction getIdentityMatrix(): Matrix4 {\n  if (!IDENTITY) {\n    IDENTITY = new Matrix4();\n    Object.freeze(IDENTITY);\n  }\n  return IDENTITY;\n}\n\n// HELPER FUNCTIONS\n\nfunction checkRadians(possiblyDegrees: number) {\n  if (possiblyDegrees > Math.PI * 2) {\n    throw Error('expected radians');\n  }\n}\n\n// eslint-disable-next-line max-params\nfunction computeInfinitePerspectiveOffCenter(\n  result: NumericArray,\n  left: number,\n  right: number,\n  bottom: number,\n  top: number,\n  near: number\n): NumericArray {\n  const column0Row0 = (2 * near) / (right - left);\n  const column1Row1 = (2 * near) / (top - bottom);\n  const column2Row0 = (right + left) / (right - left);\n  const column2Row1 = (top + bottom) / (top - bottom);\n  const column2Row2 = -1;\n  const column2Row3 = -1;\n  const column3Row2 = -2 * near;\n  result[0] = column0Row0;\n  result[1] = 0;\n  result[2] = 0;\n  result[3] = 0;\n  result[4] = 0;\n  result[5] = column1Row1;\n  result[6] = 0;\n  result[7] = 0;\n  result[8] = column2Row0;\n  result[9] = column2Row1;\n  result[10] = column2Row2;\n  result[11] = column2Row3;\n  result[12] = 0;\n  result[13] = 0;\n  result[14] = column3Row2;\n  result[15] = 0;\n  return result;\n}\n", "// Copyright (c) 2017 Uber Technologies, Inc.\n// MIT License\n// Adaptation of THREE.js Spherical class, under MIT license\nimport Vector3 from './vector3';\nimport {formatValue, equals, config} from '../lib/common';\nimport {degrees, radians, clamp} from '../lib/common';\nimport * as vec3 from 'gl-matrix/vec3';\nimport {NumericArray} from '@math.gl/types';\n\ntype SphericalCoordinatesOptions = {\n  phi?: number;\n  theta?: number;\n  radius?: number;\n  bearing?: number;\n  pitch?: number;\n  altitude?: number;\n  radiusScale?: number;\n};\n\ntype FormatOptions = {\n  printTypes?: boolean;\n};\n\n// TODO - import epsilon\nconst EPSILON = 0.000001;\nconst EARTH_RADIUS_METERS = 6371000;\n\n/**\n * The poles (phi) are at the positive and negative y axis.\n * The equator starts at positive z.\n * @link https://en.wikipedia.org/wiki/Spherical_coordinate_system\n */\nexport default class SphericalCoordinates {\n  phi: number;\n  theta: number;\n  radius: number;\n  radiusScale: number;\n  // bearing: number;\n  // pitch: number;\n  // altitude: number;\n\n  // lnglatZ coordinates\n  // longitude: number;\n  // latitude: number;\n  // lng: number;\n  // lat: number;\n  // z: number;\n\n  /**\n   * Creates a new SphericalCoordinates object\n   * @param options\n   * @param [options.phi] =0 - rotation around X (latitude)\n   * @param [options.theta] =0 - rotation around Y (longitude)\n   * @param [options.radius] =1 - Distance from center\n   * @param [options.bearing]\n   * @param [options.pitch]\n   * @param [options.altitude]\n   * @param [options.radiusScale] =1\n   */\n  // eslint-disable-next-line complexity\n  constructor({\n    phi = 0,\n    theta = 0,\n    radius = 1,\n    bearing,\n    pitch,\n    altitude,\n    radiusScale = EARTH_RADIUS_METERS\n  }: SphericalCoordinatesOptions = {}) {\n    this.phi = phi;\n    this.theta = theta;\n    // TODO - silently accepts illegal 0\n    this.radius = radius || altitude || 1; // radial distance from center\n    this.radiusScale = radiusScale || 1; // Used by lngLatZ\n    if (bearing !== undefined) {\n      this.bearing = bearing; // up / down towards top and bottom pole\n    }\n    if (pitch !== undefined) {\n      this.pitch = pitch; // around the equator of the sphere\n    }\n    this.check();\n  }\n\n  toString(): string {\n    return this.formatString(config);\n  }\n\n  formatString({printTypes = false}: FormatOptions): string {\n    const f = formatValue;\n    return `${printTypes ? 'Spherical' : ''}\\\n[rho:${f(this.radius)},theta:${f(this.theta)},phi:${f(this.phi)}]`;\n  }\n\n  equals(other: SphericalCoordinates): boolean {\n    return (\n      equals(this.radius, other.radius) &&\n      equals(this.theta, other.theta) &&\n      equals(this.phi, other.phi)\n    );\n  }\n\n  exactEquals(other: SphericalCoordinates): boolean {\n    return this.radius === other.radius && this.theta === other.theta && this.phi === other.phi;\n  }\n\n  /* eslint-disable brace-style */\n  // Cartographic (bearing 0 north, pitch 0 look from above)\n  get bearing(): number {\n    return 180 - degrees(this.phi);\n  }\n\n  set bearing(v: number) {\n    this.phi = Math.PI - radians(v);\n  }\n\n  get pitch(): number {\n    return degrees(this.theta);\n  }\n\n  set pitch(v: number) {\n    this.theta = radians(v);\n  }\n\n  // get pitch() { return 90 - degrees(this.phi); }\n  // set pitch(v) { this.phi = radians(v) + Math.PI / 2; }\n  // get altitude() { return this.radius - 1; } // relative altitude\n  // lnglatZ coordinates\n  get longitude(): number {\n    return degrees(this.phi);\n  }\n\n  get latitude(): number {\n    return degrees(this.theta);\n  }\n\n  get lng(): number {\n    return degrees(this.phi);\n  }\n\n  get lat(): number {\n    return degrees(this.theta);\n  }\n\n  get z(): number {\n    return (this.radius - 1) * this.radiusScale;\n  }\n\n  /* eslint-enable brace-style */\n  set(radius: number, phi: number, theta: number): this {\n    this.radius = radius;\n    this.phi = phi;\n    this.theta = theta;\n    return this.check();\n  }\n\n  clone(): SphericalCoordinates {\n    return new SphericalCoordinates().copy(this);\n  }\n\n  copy(other: SphericalCoordinates): this {\n    this.radius = other.radius;\n    this.phi = other.phi;\n    this.theta = other.theta;\n    return this.check();\n  }\n\n  fromLngLatZ([lng, lat, z]: [number, number, number]): this {\n    this.radius = 1 + z / this.radiusScale;\n    this.phi = radians(lat);\n    this.theta = radians(lng);\n    return this.check();\n  }\n\n  fromVector3(v: Readonly<NumericArray>): this {\n    this.radius = vec3.length(v);\n    if (this.radius > 0) {\n      this.theta = Math.atan2(v[0], v[1]); // equator angle around y-up axis\n      this.phi = Math.acos(clamp(v[2] / this.radius, -1, 1)); // polar angle\n    }\n    return this.check();\n  }\n\n  toVector3(): Vector3 {\n    return new Vector3(0, 0, this.radius)\n      .rotateX({radians: this.theta})\n      .rotateZ({radians: this.phi});\n  }\n\n  // restrict phi to be betwee EPS and PI-EPS\n  makeSafe(): this {\n    this.phi = Math.max(EPSILON, Math.min(Math.PI - EPSILON, this.phi));\n    return this;\n  }\n\n  check(): this {\n    // this.makeSafe();\n    if (!Number.isFinite(this.phi) || !Number.isFinite(this.theta) || !(this.radius > 0)) {\n      throw new Error('SphericalCoordinates: some fields set to invalid numbers');\n    }\n    return this;\n  }\n}\n", "// Copyright (c) 2017 Uber Technologies, Inc.\n// MIT License\nimport Vector from './base/vector';\nimport {config, isArray} from '../lib/common';\nimport {checkNumber} from '../lib/validators';\nimport * as vec2 from 'gl-matrix/vec2';\n/* eslint-disable camelcase */\nimport {vec2_transformMat4AsVector} from '../lib/gl-matrix-extras';\nimport {NumericArray} from '@math.gl/types';\n\n/**\n * Two-element vector class.\n * Subclass of Array<number>\n */\nexport default class Vector2 extends Vector {\n  // Creates a new, empty vec2\n  constructor(x: number | Readonly<NumericArray> = 0, y: number = 0) {\n    // PERF NOTE: initialize elements as double precision numbers\n    super(2); // -0, -0);\n    if (isArray(x) && arguments.length === 1) {\n      this.copy(x as Readonly<NumericArray>);\n    } else {\n      if (config.debug) {\n        checkNumber(x);\n        checkNumber(y);\n      }\n      this[0] = x as number;\n      this[1] = y;\n    }\n  }\n\n  set(x: number, y: number): this {\n    this[0] = x;\n    this[1] = y;\n    return this.check();\n  }\n\n  copy(array: Readonly<NumericArray>): this {\n    this[0] = array[0];\n    this[1] = array[1];\n    return this.check();\n  }\n\n  fromObject(object: {x: number; y: number}): this {\n    if (config.debug) {\n      checkNumber(object.x);\n      checkNumber(object.y);\n    }\n    this[0] = object.x;\n    this[1] = object.y;\n    return this.check();\n  }\n\n  toObject(object: {x?: number; y?: number}): {x: number; y: number} {\n    object.x = this[0];\n    object.y = this[1];\n    return object as {x: number; y: number};\n  }\n\n  // Getters/setters\n\n  get ELEMENTS(): number {\n    return 2;\n  }\n\n  /**\n   * Returns angle from x axis\n   * @returns\n   */\n  horizontalAngle(): number {\n    return Math.atan2(this.y, this.x);\n  }\n\n  /**\n   * Returns angle from y axis\n   * @returns\n   */\n  verticalAngle(): number {\n    return Math.atan2(this.x, this.y);\n  }\n\n  // Transforms\n\n  /**\n   * Transforms as point\n   * @param matrix4\n   * @returns\n   */\n  transform(matrix4: Readonly<NumericArray>): this {\n    return this.transformAsPoint(matrix4);\n  }\n\n  /**\n   * transforms as point (4th component is implicitly 1)\n   * @param matrix4\n   * @returns\n   */\n  transformAsPoint(matrix4: Readonly<NumericArray>): this {\n    vec2.transformMat4(this, this, matrix4);\n    return this.check();\n  }\n\n  /**\n   * transforms as vector (4th component is implicitly 0, ignores translation. slightly faster)\n   * @param matrix4\n   * @returns\n   */\n  transformAsVector(matrix4: Readonly<NumericArray>): this {\n    vec2_transformMat4AsVector(this, this, matrix4);\n    return this.check();\n  }\n\n  transformByMatrix3(matrix3: Readonly<NumericArray>): this {\n    vec2.transformMat3(this, this, matrix3);\n    return this.check();\n  }\n\n  transformByMatrix2x3(matrix2x3: Readonly<NumericArray>): this {\n    vec2.transformMat2d(this, this, matrix2x3);\n    return this.check();\n  }\n\n  transformByMatrix2(matrix2: Readonly<NumericArray>): this {\n    vec2.transformMat2(this, this, matrix2);\n    return this.check();\n  }\n}\n", "// Copyright (c) 2017 Uber Technologies, Inc.\n// MIT License\n\nimport Vector from './base/vector';\nimport {config, isArray} from '../lib/common';\nimport {checkNumber} from '../lib/validators';\nimport * as vec4 from 'gl-matrix/vec3';\n/* eslint-disable camelcase */\nimport {vec4_transformMat2, vec4_transformMat3} from '../lib/gl-matrix-extras';\nimport {NumericArray} from '@math.gl/types';\n\nimport type Matrix4 from './matrix4';\n\nlet ZERO: Vector4;\n\n/**\n * Four-element vector class.\n * Subclass of Array<number>\n */\nexport default class Vector4 extends Vector {\n  static get ZERO(): Vector4 {\n    if (!ZERO) {\n      ZERO = new Vector4(0, 0, 0, 0);\n      Object.freeze(ZERO);\n    }\n    return ZERO;\n  }\n\n  constructor(x: number | Readonly<NumericArray> = 0, y: number = 0, z: number = 0, w: number = 0) {\n    // PERF NOTE: initialize elements as double precision numbers\n    super(-0, -0, -0, -0);\n    if (isArray(x) && arguments.length === 1) {\n      this.copy(x as Readonly<NumericArray>);\n    } else {\n      // this.set(x, y, z, w);\n      if (config.debug) {\n        checkNumber(x);\n        checkNumber(y);\n        checkNumber(z);\n        checkNumber(w);\n      }\n      this[0] = x as number;\n      this[1] = y;\n      this[2] = z;\n      this[3] = w;\n    }\n  }\n\n  set(x: number, y: number, z: number, w: number): this {\n    this[0] = x;\n    this[1] = y;\n    this[2] = z;\n    this[3] = w;\n    return this.check();\n  }\n\n  copy(array: Readonly<NumericArray>): this {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    this[3] = array[3];\n    return this.check();\n  }\n\n  fromObject(object: {x: number; y: number; z: number; w: number}): this {\n    if (config.debug) {\n      checkNumber(object.x);\n      checkNumber(object.y);\n      checkNumber(object.z);\n      checkNumber(object.w);\n    }\n    this[0] = object.x;\n    this[1] = object.y;\n    this[2] = object.z;\n    this[3] = object.w;\n    return this;\n  }\n\n  toObject(object: {x?: number; y?: number; z?: number; w?: number}): {\n    x: number;\n    y: number;\n    z: number;\n    w: number;\n  } {\n    object.x = this[0];\n    object.y = this[1];\n    object.z = this[2];\n    object.w = this[3];\n    return object as {\n      x: number;\n      y: number;\n      z: number;\n      w: number;\n    };\n  }\n\n  // Getters/setters\n  /* eslint-disable no-multi-spaces, brace-style, no-return-assign */\n  get ELEMENTS(): number {\n    return 4;\n  }\n\n  get z(): number {\n    return this[2];\n  }\n  set z(value: number) {\n    this[2] = checkNumber(value);\n  }\n  get w(): number {\n    return this[3];\n  }\n  set w(value: number) {\n    this[3] = checkNumber(value);\n  }\n\n  transform(matrix4: Readonly<NumericArray>): this {\n    vec4.transformMat4(this, this, matrix4);\n    return this.check();\n  }\n\n  transformByMatrix3(matrix3: Readonly<NumericArray>): this {\n    vec4_transformMat3(this, this, matrix3);\n    return this.check();\n  }\n\n  transformByMatrix2(matrix2: Readonly<NumericArray>): this {\n    vec4_transformMat2(this, this, matrix2);\n    return this.check();\n  }\n\n  transformByQuaternion(quaternion: Readonly<NumericArray>): this {\n    vec4.transformQuat(this, this, quaternion);\n    return this.check();\n  }\n\n  // three.js compatibility\n  applyMatrix4(m: Matrix4): this {\n    m.transform(this, this);\n    return this;\n  }\n}\n", "import * as glMatrix from \"./common.js\";\n/**\n * 3x3 Matrix\n * @module mat3\n */\n\n/**\n * Creates a new identity mat3\n *\n * @returns {mat3} a new 3x3 matrix\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(9);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[5] = 0;\n    out[6] = 0;\n    out[7] = 0;\n  }\n\n  out[0] = 1;\n  out[4] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\n * Copies the upper-left 3x3 values into the given mat3.\n *\n * @param {mat3} out the receiving 3x3 matrix\n * @param {ReadonlyMat4} a   the source 4x4 matrix\n * @returns {mat3} out\n */\n\nexport function fromMat4(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[4];\n  out[4] = a[5];\n  out[5] = a[6];\n  out[6] = a[8];\n  out[7] = a[9];\n  out[8] = a[10];\n  return out;\n}\n/**\n * Creates a new mat3 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat3} a matrix to clone\n * @returns {mat3} a new 3x3 matrix\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\n * Copy the values from one mat3 to another\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\n * Create a new mat3 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} A new mat3\n */\n\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  var out = new glMatrix.ARRAY_TYPE(9);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\n * Set the components of a mat3 to the given values\n *\n * @param {mat3} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\n * @returns {mat3} out\n */\n\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m10;\n  out[4] = m11;\n  out[5] = m12;\n  out[6] = m20;\n  out[7] = m21;\n  out[8] = m22;\n  return out;\n}\n/**\n * Set a mat3 to the identity matrix\n *\n * @param {mat3} out the receiving matrix\n * @returns {mat3} out\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a12 = a[5];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a01;\n    out[5] = a[7];\n    out[6] = a02;\n    out[7] = a12;\n  } else {\n    out[0] = a[0];\n    out[1] = a[3];\n    out[2] = a[6];\n    out[3] = a[1];\n    out[4] = a[4];\n    out[5] = a[7];\n    out[6] = a[2];\n    out[7] = a[5];\n    out[8] = a[8];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b01 = a22 * a11 - a12 * a21;\n  var b11 = -a22 * a10 + a12 * a20;\n  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant\n\n  var det = a00 * b01 + a01 * b11 + a02 * b21;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = b01 * det;\n  out[1] = (-a22 * a01 + a02 * a21) * det;\n  out[2] = (a12 * a01 - a02 * a11) * det;\n  out[3] = b11 * det;\n  out[4] = (a22 * a00 - a02 * a20) * det;\n  out[5] = (-a12 * a00 + a02 * a10) * det;\n  out[6] = b21 * det;\n  out[7] = (-a21 * a00 + a01 * a20) * det;\n  out[8] = (a11 * a00 - a01 * a10) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the source matrix\n * @returns {mat3} out\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  out[0] = a11 * a22 - a12 * a21;\n  out[1] = a02 * a21 - a01 * a22;\n  out[2] = a01 * a12 - a02 * a11;\n  out[3] = a12 * a20 - a10 * a22;\n  out[4] = a00 * a22 - a02 * a20;\n  out[5] = a02 * a10 - a00 * a12;\n  out[6] = a10 * a21 - a11 * a20;\n  out[7] = a01 * a20 - a00 * a21;\n  out[8] = a00 * a11 - a01 * a10;\n  return out;\n}\n/**\n * Calculates the determinant of a mat3\n *\n * @param {ReadonlyMat3} a the source matrix\n * @returns {Number} determinant of a\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\n}\n/**\n * Multiplies two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2];\n  var a10 = a[3],\n      a11 = a[4],\n      a12 = a[5];\n  var a20 = a[6],\n      a21 = a[7],\n      a22 = a[8];\n  var b00 = b[0],\n      b01 = b[1],\n      b02 = b[2];\n  var b10 = b[3],\n      b11 = b[4],\n      b12 = b[5];\n  var b20 = b[6],\n      b21 = b[7],\n      b22 = b[8];\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\n  return out;\n}\n/**\n * Translate a mat3 by the given vector\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to translate\n * @param {ReadonlyVec2} v vector to translate by\n * @returns {mat3} out\n */\n\nexport function translate(out, a, v) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      x = v[0],\n      y = v[1];\n  out[0] = a00;\n  out[1] = a01;\n  out[2] = a02;\n  out[3] = a10;\n  out[4] = a11;\n  out[5] = a12;\n  out[6] = x * a00 + y * a10 + a20;\n  out[7] = x * a01 + y * a11 + a21;\n  out[8] = x * a02 + y * a12 + a22;\n  return out;\n}\n/**\n * Rotates a mat3 by the given angle\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\n\nexport function rotate(out, a, rad) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a10 = a[3],\n      a11 = a[4],\n      a12 = a[5],\n      a20 = a[6],\n      a21 = a[7],\n      a22 = a[8],\n      s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c * a00 + s * a10;\n  out[1] = c * a01 + s * a11;\n  out[2] = c * a02 + s * a12;\n  out[3] = c * a10 - s * a00;\n  out[4] = c * a11 - s * a01;\n  out[5] = c * a12 - s * a02;\n  out[6] = a20;\n  out[7] = a21;\n  out[8] = a22;\n  return out;\n}\n/**\n * Scales the mat3 by the dimensions in the given vec2\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to rotate\n * @param {ReadonlyVec2} v the vec2 to scale the matrix by\n * @returns {mat3} out\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1];\n  out[0] = x * a[0];\n  out[1] = x * a[1];\n  out[2] = x * a[2];\n  out[3] = y * a[3];\n  out[4] = y * a[4];\n  out[5] = y * a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.translate(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyVec2} v Translation vector\n * @returns {mat3} out\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 1;\n  out[5] = 0;\n  out[6] = v[0];\n  out[7] = v[1];\n  out[8] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.rotate(dest, dest, rad);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat3} out\n */\n\nexport function fromRotation(out, rad) {\n  var s = Math.sin(rad),\n      c = Math.cos(rad);\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = -s;\n  out[4] = c;\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat3.identity(dest);\n *     mat3.scale(dest, dest, vec);\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyVec2} v Scaling vector\n * @returns {mat3} out\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = v[1];\n  out[5] = 0;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 1;\n  return out;\n}\n/**\n * Copies the values from a mat2d into a mat3\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat2d} a the matrix to copy\n * @returns {mat3} out\n **/\n\nexport function fromMat2d(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = 0;\n  out[3] = a[2];\n  out[4] = a[3];\n  out[5] = 0;\n  out[6] = a[4];\n  out[7] = a[5];\n  out[8] = 1;\n  return out;\n}\n/**\n * Calculates a 3x3 matrix from the given quaternion\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat3} out\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[3] = yx - wz;\n  out[6] = zx + wy;\n  out[1] = yx + wz;\n  out[4] = 1 - xx - zz;\n  out[7] = zy - wx;\n  out[2] = zx - wy;\n  out[5] = zy + wx;\n  out[8] = 1 - xx - yy;\n  return out;\n}\n/**\n * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\n *\n * @param {mat3} out mat3 receiving operation result\n * @param {ReadonlyMat4} a Mat4 to derive the normal matrix from\n *\n * @returns {mat3} out\n */\n\nexport function normalFromMat4(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  return out;\n}\n/**\n * Generates a 2D projection matrix with the given bounds\n *\n * @param {mat3} out mat3 frustum matrix will be written into\n * @param {number} width Width of your gl context\n * @param {number} height Height of gl context\n * @returns {mat3} out\n */\n\nexport function projection(out, width, height) {\n  out[0] = 2 / width;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -2 / height;\n  out[5] = 0;\n  out[6] = -1;\n  out[7] = 1;\n  out[8] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat3\n *\n * @param {ReadonlyMat3} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nexport function str(a) {\n  return \"mat3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat3\n *\n * @param {ReadonlyMat3} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);\n}\n/**\n * Adds two mat3's\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @returns {mat3} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat3} out the receiving matrix\n * @param {ReadonlyMat3} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat3} out\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  return out;\n}\n/**\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat3} out the receiving vector\n * @param {ReadonlyMat3} a the first operand\n * @param {ReadonlyMat3} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat3} out\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat3} a The first matrix.\n * @param {ReadonlyMat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat3} a The first matrix.\n * @param {ReadonlyMat3} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3],\n      a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7],\n      a8 = a[8];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3],\n      b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7],\n      b8 = b[8];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));\n}\n/**\n * Alias for {@link mat3.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link mat3.subtract}\n * @function\n */\n\nexport var sub = subtract;", "// Copyright (c) 2017 Uber Technologies, Inc.\n// MIT License\nimport Matrix from './base/matrix';\nimport {checkVector} from '../lib/validators';\n/* eslint-disable camelcase */\nimport {vec4_transformMat3} from '../lib/gl-matrix-extras';\nimport * as mat3 from 'gl-matrix/mat3';\nimport * as vec2 from 'gl-matrix/vec2';\nimport * as vec3 from 'gl-matrix/vec3';\nimport {NumericArray} from '@math.gl/types';\n\nenum INDICES {\n  COL0ROW0 = 0,\n  COL0ROW1 = 1,\n  COL0ROW2 = 2,\n  COL1ROW0 = 3,\n  COL1ROW1 = 4,\n  COL1ROW2 = 5,\n  COL2ROW0 = 6,\n  COL2ROW1 = 7,\n  COL2ROW2 = 8\n}\n\nconst IDENTITY_MATRIX = Object.freeze([1, 0, 0, 0, 1, 0, 0, 0, 1]);\n\nexport default class Matrix3 extends Matrix {\n  static get IDENTITY(): Readonly<Matrix3> {\n    return getIdentityMatrix();\n  }\n\n  static get ZERO(): Readonly<Matrix3> {\n    return getZeroMatrix();\n  }\n\n  get ELEMENTS(): number {\n    return 9;\n  }\n\n  get RANK(): number {\n    return 3;\n  }\n\n  get INDICES(): typeof INDICES {\n    return INDICES;\n  }\n\n  constructor(array?: Readonly<NumericArray>);\n  /** @deprecated */\n  constructor(...args: number[]);\n\n  constructor(array?: number | Readonly<NumericArray>, ...args: number[]) {\n    // PERF NOTE: initialize elements as double precision numbers\n    super(-0, -0, -0, -0, -0, -0, -0, -0, -0);\n    if (arguments.length === 1 && Array.isArray(array)) {\n      this.copy(array);\n    } else if (args.length > 0) {\n      this.copy([array as number, ...args]);\n    } else {\n      this.identity();\n    }\n  }\n\n  copy(array: Readonly<NumericArray>): this {\n    // Element wise copy for performance\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    this[3] = array[3];\n    this[4] = array[4];\n    this[5] = array[5];\n    this[6] = array[6];\n    this[7] = array[7];\n    this[8] = array[8];\n    return this.check();\n  }\n\n  // Constructors\n\n  identity(): this {\n    return this.copy(IDENTITY_MATRIX);\n  }\n\n  /**\n   *\n   * @param object\n   * @returns self\n   */\n  fromObject(object: {[key: string]: any}): this {\n    return this.check();\n  }\n\n  // Calculates a 3x3 matrix from the given quaternion\n  // q quat  Quaternion to create matrix from\n  fromQuaternion(q: Readonly<NumericArray>): this {\n    mat3.fromQuat(this, q);\n    return this.check();\n  }\n\n  /**\n   * accepts column major order, stores in column major order\n   */\n  // eslint-disable-next-line max-params\n  set(\n    m00: number,\n    m10: number,\n    m20: number,\n    m01: number,\n    m11: number,\n    m21: number,\n    m02: number,\n    m12: number,\n    m22: number\n  ): this {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m01;\n    this[4] = m11;\n    this[5] = m21;\n    this[6] = m02;\n    this[7] = m12;\n    this[8] = m22;\n    return this.check();\n  }\n\n  /**\n   * accepts row major order, stores as column major\n   */\n  // eslint-disable-next-line max-params\n  setRowMajor(\n    m00: number,\n    m01: number,\n    m02: number,\n    m10: number,\n    m11: number,\n    m12: number,\n    m20: number,\n    m21: number,\n    m22: number\n  ): this {\n    this[0] = m00;\n    this[1] = m10;\n    this[2] = m20;\n    this[3] = m01;\n    this[4] = m11;\n    this[5] = m21;\n    this[6] = m02;\n    this[7] = m12;\n    this[8] = m22;\n    return this.check();\n  }\n\n  // Accessors\n\n  determinant(): number {\n    return mat3.determinant(this);\n  }\n\n  // Modifiers\n  transpose(): this {\n    mat3.transpose(this, this);\n    return this.check();\n  }\n\n  /** Invert a matrix. Note that this can fail if the matrix is not invertible */\n  invert(): this {\n    mat3.invert(this, this);\n    return this.check();\n  }\n\n  // Operations\n  multiplyLeft(a: NumericArray): this {\n    mat3.multiply(this, a, this);\n    return this.check();\n  }\n\n  multiplyRight(a: NumericArray): this {\n    mat3.multiply(this, this, a);\n    return this.check();\n  }\n\n  rotate(radians: number): NumericArray {\n    mat3.rotate(this, this, radians);\n    return this.check();\n  }\n\n  scale(factor: NumericArray | number): this {\n    if (Array.isArray(factor)) {\n      mat3.scale(this, this, factor);\n    } else {\n      mat3.scale(this, this, [factor as number, factor as number]);\n    }\n    return this.check();\n  }\n\n  translate(vec: NumericArray): this {\n    mat3.translate(this, this, vec);\n    return this.check();\n  }\n\n  // Transforms\n  transform(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    let out: NumericArray;\n    switch (vector.length) {\n      case 2:\n        out = vec2.transformMat3(result || [-0, -0], vector, this);\n        break;\n      case 3:\n        out = vec3.transformMat3(result || [-0, -0, -0], vector, this);\n        break;\n      case 4:\n        out = vec4_transformMat3(result || [-0, -0, -0, -0], vector, this);\n        break;\n      default:\n        throw new Error('Illegal vector');\n    }\n    checkVector(out, vector.length);\n    return out;\n  }\n\n  /** @deprecated */\n  transformVector(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    return this.transform(vector, result);\n  }\n\n  /** @deprecated */\n  transformVector2(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    return this.transform(vector, result);\n  }\n\n  /** @deprecated */\n  transformVector3(vector: Readonly<NumericArray>, result?: NumericArray): NumericArray {\n    return this.transform(vector, result);\n  }\n}\n\nlet ZERO_MATRIX3;\nlet IDENTITY_MATRIX3;\n\nfunction getZeroMatrix(): Readonly<Matrix3> {\n  if (!ZERO_MATRIX3) {\n    ZERO_MATRIX3 = new Matrix3([0, 0, 0, 0, 0, 0, 0, 0, 0]);\n    Object.freeze(ZERO_MATRIX3);\n  }\n  return ZERO_MATRIX3;\n}\n\nfunction getIdentityMatrix(): Matrix3 {\n  if (!IDENTITY_MATRIX3) {\n    IDENTITY_MATRIX3 = new Matrix3();\n    Object.freeze(IDENTITY_MATRIX3);\n  }\n  return IDENTITY_MATRIX3;\n}\n", "import * as glMatrix from \"./common.js\";\nimport * as mat3 from \"./mat3.js\";\nimport * as vec3 from \"./vec3.js\";\nimport * as vec4 from \"./vec4.js\";\n/**\n * Quaternion\n * @module quat\n */\n\n/**\n * Creates a new identity quat\n *\n * @returns {quat} a new quaternion\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  out[3] = 1;\n  return out;\n}\n/**\n * Set a quat to the identity quaternion\n *\n * @param {quat} out the receiving quaternion\n * @returns {quat} out\n */\n\nexport function identity(out) {\n  out[0] = 0;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 1;\n  return out;\n}\n/**\n * Sets a quat from the given angle and rotation axis,\n * then returns it.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyVec3} axis the axis around which to rotate\n * @param {Number} rad the angle in radians\n * @returns {quat} out\n **/\n\nexport function setAxisAngle(out, axis, rad) {\n  rad = rad * 0.5;\n  var s = Math.sin(rad);\n  out[0] = s * axis[0];\n  out[1] = s * axis[1];\n  out[2] = s * axis[2];\n  out[3] = Math.cos(rad);\n  return out;\n}\n/**\n * Gets the rotation axis and angle for a given\n *  quaternion. If a quaternion is created with\n *  setAxisAngle, this method will return the same\n *  values as providied in the original parameter list\n *  OR functionally equivalent values.\n * Example: The quaternion formed by axis [0, 0, 1] and\n *  angle -90 is the same as the quaternion formed by\n *  [0, 0, 1] and 270. This method favors the latter.\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\n * @param  {ReadonlyQuat} q     Quaternion to be decomposed\n * @return {Number}     Angle, in radians, of the rotation\n */\n\nexport function getAxisAngle(out_axis, q) {\n  var rad = Math.acos(q[3]) * 2.0;\n  var s = Math.sin(rad / 2.0);\n\n  if (s > glMatrix.EPSILON) {\n    out_axis[0] = q[0] / s;\n    out_axis[1] = q[1] / s;\n    out_axis[2] = q[2] / s;\n  } else {\n    // If s is zero, return any axis (no rotation - axis does not matter)\n    out_axis[0] = 1;\n    out_axis[1] = 0;\n    out_axis[2] = 0;\n  }\n\n  return rad;\n}\n/**\n * Gets the angular distance between two unit quaternions\n *\n * @param  {ReadonlyQuat} a     Origin unit quaternion\n * @param  {ReadonlyQuat} b     Destination unit quaternion\n * @return {Number}     Angle, in radians, between the two quaternions\n */\n\nexport function getAngle(a, b) {\n  var dotproduct = dot(a, b);\n  return Math.acos(2 * dotproduct * dotproduct - 1);\n}\n/**\n * Multiplies two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {quat} out\n */\n\nexport function multiply(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\n  return out;\n}\n/**\n * Rotates a quaternion by the given angle about the X axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\n\nexport function rotateX(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + aw * bx;\n  out[1] = ay * bw + az * bx;\n  out[2] = az * bw - ay * bx;\n  out[3] = aw * bw - ax * bx;\n  return out;\n}\n/**\n * Rotates a quaternion by the given angle about the Y axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\n\nexport function rotateY(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var by = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw - az * by;\n  out[1] = ay * bw + aw * by;\n  out[2] = az * bw + ax * by;\n  out[3] = aw * bw - ay * by;\n  return out;\n}\n/**\n * Rotates a quaternion by the given angle about the Z axis\n *\n * @param {quat} out quat receiving operation result\n * @param {ReadonlyQuat} a quat to rotate\n * @param {number} rad angle (in radians) to rotate\n * @returns {quat} out\n */\n\nexport function rotateZ(out, a, rad) {\n  rad *= 0.5;\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bz = Math.sin(rad),\n      bw = Math.cos(rad);\n  out[0] = ax * bw + ay * bz;\n  out[1] = ay * bw - ax * bz;\n  out[2] = az * bw + aw * bz;\n  out[3] = aw * bw - az * bz;\n  return out;\n}\n/**\n * Calculates the W component of a quat from the X, Y, and Z components.\n * Assumes that quaternion is 1 unit in length.\n * Any existing W component will be ignored.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate W component of\n * @returns {quat} out\n */\n\nexport function calculateW(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\n  return out;\n}\n/**\n * Calculate the exponential of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @returns {quat} out\n */\n\nexport function exp(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var et = Math.exp(w);\n  var s = r > 0 ? et * Math.sin(r) / r : 0;\n  out[0] = x * s;\n  out[1] = y * s;\n  out[2] = z * s;\n  out[3] = et * Math.cos(r);\n  return out;\n}\n/**\n * Calculate the natural logarithm of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @returns {quat} out\n */\n\nexport function ln(out, a) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  var r = Math.sqrt(x * x + y * y + z * z);\n  var t = r > 0 ? Math.atan2(r, w) / r : 0;\n  out[0] = x * t;\n  out[1] = y * t;\n  out[2] = z * t;\n  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);\n  return out;\n}\n/**\n * Calculate the scalar power of a unit quaternion.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate the exponential of\n * @param {Number} b amount to scale the quaternion by\n * @returns {quat} out\n */\n\nexport function pow(out, a, b) {\n  ln(out, a);\n  scale(out, out, b);\n  exp(out, out);\n  return out;\n}\n/**\n * Performs a spherical linear interpolation between two quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n */\n\nexport function slerp(out, a, b, t) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      aw = a[3];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2],\n      bw = b[3];\n  var omega, cosom, sinom, scale0, scale1; // calc cosine\n\n  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)\n\n  if (cosom < 0.0) {\n    cosom = -cosom;\n    bx = -bx;\n    by = -by;\n    bz = -bz;\n    bw = -bw;\n  } // calculate coefficients\n\n\n  if (1.0 - cosom > glMatrix.EPSILON) {\n    // standard case (slerp)\n    omega = Math.acos(cosom);\n    sinom = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  } // calculate final values\n\n\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n  return out;\n}\n/**\n * Generates a random unit quaternion\n *\n * @param {quat} out the receiving quaternion\n * @returns {quat} out\n */\n\nexport function random(out) {\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\n  // TODO: Calling random 3 times is probably not the fastest solution\n  var u1 = glMatrix.RANDOM();\n  var u2 = glMatrix.RANDOM();\n  var u3 = glMatrix.RANDOM();\n  var sqrt1MinusU1 = Math.sqrt(1 - u1);\n  var sqrtU1 = Math.sqrt(u1);\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\n  return out;\n}\n/**\n * Calculates the inverse of a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate inverse of\n * @returns {quat} out\n */\n\nexport function invert(out, a) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;\n  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\n\n  out[0] = -a0 * invDot;\n  out[1] = -a1 * invDot;\n  out[2] = -a2 * invDot;\n  out[3] = a3 * invDot;\n  return out;\n}\n/**\n * Calculates the conjugate of a quat\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quat to calculate conjugate of\n * @returns {quat} out\n */\n\nexport function conjugate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Creates a quaternion from the given 3x3 rotation matrix.\n *\n * NOTE: The resultant quaternion is not normalized, so you should be sure\n * to renormalize the quaternion yourself where necessary.\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyMat3} m rotation matrix\n * @returns {quat} out\n * @function\n */\n\nexport function fromMat3(out, m) {\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\n  // article \"Quaternion Calculus and Fast Animation\".\n  var fTrace = m[0] + m[4] + m[8];\n  var fRoot;\n\n  if (fTrace > 0.0) {\n    // |w| > 1/2, may as well choose w > 1/2\n    fRoot = Math.sqrt(fTrace + 1.0); // 2w\n\n    out[3] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot; // 1/(4w)\n\n    out[0] = (m[5] - m[7]) * fRoot;\n    out[1] = (m[6] - m[2]) * fRoot;\n    out[2] = (m[1] - m[3]) * fRoot;\n  } else {\n    // |w| <= 1/2\n    var i = 0;\n    if (m[4] > m[0]) i = 1;\n    if (m[8] > m[i * 3 + i]) i = 2;\n    var j = (i + 1) % 3;\n    var k = (i + 2) % 3;\n    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);\n    out[i] = 0.5 * fRoot;\n    fRoot = 0.5 / fRoot;\n    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;\n    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;\n    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;\n  }\n\n  return out;\n}\n/**\n * Creates a quaternion from the given euler angle x, y, z.\n *\n * @param {quat} out the receiving quaternion\n * @param {x} Angle to rotate around X axis in degrees.\n * @param {y} Angle to rotate around Y axis in degrees.\n * @param {z} Angle to rotate around Z axis in degrees.\n * @returns {quat} out\n * @function\n */\n\nexport function fromEuler(out, x, y, z) {\n  var halfToRad = 0.5 * Math.PI / 180.0;\n  x *= halfToRad;\n  y *= halfToRad;\n  z *= halfToRad;\n  var sx = Math.sin(x);\n  var cx = Math.cos(x);\n  var sy = Math.sin(y);\n  var cy = Math.cos(y);\n  var sz = Math.sin(z);\n  var cz = Math.cos(z);\n  out[0] = sx * cy * cz - cx * sy * sz;\n  out[1] = cx * sy * cz + sx * cy * sz;\n  out[2] = cx * cy * sz - sx * sy * cz;\n  out[3] = cx * cy * cz + sx * sy * sz;\n  return out;\n}\n/**\n * Returns a string representation of a quatenion\n *\n * @param {ReadonlyQuat} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"quat(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\n * Creates a new quat initialized with values from an existing quaternion\n *\n * @param {ReadonlyQuat} a quaternion to clone\n * @returns {quat} a new quaternion\n * @function\n */\n\nexport var clone = vec4.clone;\n/**\n * Creates a new quat initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} a new quaternion\n * @function\n */\n\nexport var fromValues = vec4.fromValues;\n/**\n * Copy the values from one quat to another\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the source quaternion\n * @returns {quat} out\n * @function\n */\n\nexport var copy = vec4.copy;\n/**\n * Set the components of a quat to the given values\n *\n * @param {quat} out the receiving quaternion\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {quat} out\n * @function\n */\n\nexport var set = vec4.set;\n/**\n * Adds two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {quat} out\n * @function\n */\n\nexport var add = vec4.add;\n/**\n * Alias for {@link quat.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Scales a quat by a scalar number\n *\n * @param {quat} out the receiving vector\n * @param {ReadonlyQuat} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {quat} out\n * @function\n */\n\nexport var scale = vec4.scale;\n/**\n * Calculates the dot product of two quat's\n *\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @returns {Number} dot product of a and b\n * @function\n */\n\nexport var dot = vec4.dot;\n/**\n * Performs a linear interpolation between two quat's\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n * @function\n */\n\nexport var lerp = vec4.lerp;\n/**\n * Calculates the length of a quat\n *\n * @param {ReadonlyQuat} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport var length = vec4.length;\n/**\n * Alias for {@link quat.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Calculates the squared length of a quat\n *\n * @param {ReadonlyQuat} a vector to calculate squared length of\n * @returns {Number} squared length of a\n * @function\n */\n\nexport var squaredLength = vec4.squaredLength;\n/**\n * Alias for {@link quat.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Normalize a quat\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a quaternion to normalize\n * @returns {quat} out\n * @function\n */\n\nexport var normalize = vec4.normalize;\n/**\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyQuat} a The first quaternion.\n * @param {ReadonlyQuat} b The second quaternion.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport var exactEquals = vec4.exactEquals;\n/**\n * Returns whether or not the quaternions have approximately the same elements in the same position.\n *\n * @param {ReadonlyQuat} a The first vector.\n * @param {ReadonlyQuat} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport var equals = vec4.equals;\n/**\n * Sets a quaternion to represent the shortest rotation from one\n * vector to another.\n *\n * Both vectors are assumed to be unit length.\n *\n * @param {quat} out the receiving quaternion.\n * @param {ReadonlyVec3} a the initial vector\n * @param {ReadonlyVec3} b the destination vector\n * @returns {quat} out\n */\n\nexport var rotationTo = function () {\n  var tmpvec3 = vec3.create();\n  var xUnitVec3 = vec3.fromValues(1, 0, 0);\n  var yUnitVec3 = vec3.fromValues(0, 1, 0);\n  return function (out, a, b) {\n    var dot = vec3.dot(a, b);\n\n    if (dot < -0.999999) {\n      vec3.cross(tmpvec3, xUnitVec3, a);\n      if (vec3.len(tmpvec3) < 0.000001) vec3.cross(tmpvec3, yUnitVec3, a);\n      vec3.normalize(tmpvec3, tmpvec3);\n      setAxisAngle(out, tmpvec3, Math.PI);\n      return out;\n    } else if (dot > 0.999999) {\n      out[0] = 0;\n      out[1] = 0;\n      out[2] = 0;\n      out[3] = 1;\n      return out;\n    } else {\n      vec3.cross(tmpvec3, a, b);\n      out[0] = tmpvec3[0];\n      out[1] = tmpvec3[1];\n      out[2] = tmpvec3[2];\n      out[3] = 1 + dot;\n      return normalize(out, out);\n    }\n  };\n}();\n/**\n * Performs a spherical linear interpolation with two control points\n *\n * @param {quat} out the receiving quaternion\n * @param {ReadonlyQuat} a the first operand\n * @param {ReadonlyQuat} b the second operand\n * @param {ReadonlyQuat} c the third operand\n * @param {ReadonlyQuat} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {quat} out\n */\n\nexport var sqlerp = function () {\n  var temp1 = create();\n  var temp2 = create();\n  return function (out, a, b, c, d, t) {\n    slerp(temp1, a, d, t);\n    slerp(temp2, b, c, t);\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\n    return out;\n  };\n}();\n/**\n * Sets the specified quaternion with values corresponding to the given\n * axes. Each axis is a vec3 and is expected to be unit length and\n * perpendicular to all other specified axes.\n *\n * @param {ReadonlyVec3} view  the vector representing the viewing direction\n * @param {ReadonlyVec3} right the vector representing the local \"right\" direction\n * @param {ReadonlyVec3} up    the vector representing the local \"up\" direction\n * @returns {quat} out\n */\n\nexport var setAxes = function () {\n  var matr = mat3.create();\n  return function (out, view, right, up) {\n    matr[0] = right[0];\n    matr[3] = right[1];\n    matr[6] = right[2];\n    matr[1] = up[0];\n    matr[4] = up[1];\n    matr[7] = up[2];\n    matr[2] = -view[0];\n    matr[5] = -view[1];\n    matr[8] = -view[2];\n    return normalize(out, fromMat3(out, matr));\n  };\n}();", "// Copyright (c) 2017 Uber Technologies, Inc.\n// MIT License\nimport MathArray from './base/math-array';\nimport {checkNumber, checkVector} from '../lib/validators';\nimport Vector4 from './vector4';\nimport * as quat from 'gl-matrix/quat';\nimport * as vec4 from 'gl-matrix/vec4';\nimport {NumericArray} from '@math.gl/types';\n\nconst IDENTITY_QUATERNION = [0, 0, 0, 1] as const;\n\nexport default class Quaternion extends MathArray {\n  constructor(x: number | Readonly<NumericArray> = 0, y = 0, z = 0, w = 1) {\n    // PERF NOTE: initialize elements as double precision numbers\n    super(-0, -0, -0, -0);\n    // eslint-disable-next-line prefer-rest-params\n    if (Array.isArray(x) && arguments.length === 1) {\n      this.copy(x);\n    } else {\n      this.set(x as number, y, z, w);\n    }\n  }\n\n  copy(array: Readonly<NumericArray>): this {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    this[3] = array[3];\n    return this.check();\n  }\n\n  set(x: number, y: number, z: number, w: number): this {\n    this[0] = x;\n    this[1] = y;\n    this[2] = z;\n    this[3] = w;\n    return this.check();\n  }\n\n  fromObject(object: {x: number; y: number; z: number; w: number}): this {\n    this[0] = object.x;\n    this[1] = object.y;\n    this[2] = object.z;\n    this[3] = object.w;\n    return this.check();\n  }\n\n  /**\n   * Creates a quaternion from the given 3x3 rotation matrix.\n   * NOTE: The resultant quaternion is not normalized, so you should\n   * be sure to renormalize the quaternion yourself where necessary.\n   * @param m\n   * @returns\n   */\n  fromMatrix3(m: Readonly<NumericArray>): this {\n    quat.fromMat3(this, m);\n    return this.check();\n  }\n\n  fromAxisRotation(axis: Readonly<NumericArray>, rad: number): this {\n    quat.setAxisAngle(this, axis, rad);\n    return this.check();\n  }\n\n  /** Set a quat to the identity quaternion */\n  identity(): this {\n    quat.identity(this);\n    return this.check();\n  }\n\n  // Set the components of a quat to the given values\n  // set(i, j, k, l) {\n  //   quat.set(this, i, j, k, l);\n  //   return this.check();\n  // }\n\n  // Sets a quat from the given angle and rotation axis, then returns it.\n  setAxisAngle(axis: Readonly<NumericArray>, rad: number): this {\n    return this.fromAxisRotation(axis, rad);\n  }\n\n  // Getters/setters\n  get ELEMENTS(): number {\n    return 4;\n  }\n\n  get x(): number {\n    return this[0];\n  }\n  set x(value: number) {\n    this[0] = checkNumber(value);\n  }\n\n  get y(): number {\n    return this[1];\n  }\n  set y(value: number) {\n    this[1] = checkNumber(value);\n  }\n\n  get z(): number {\n    return this[2];\n  }\n  set z(value: number) {\n    this[2] = checkNumber(value);\n  }\n\n  get w(): number {\n    return this[3];\n  }\n  set w(value: number) {\n    this[3] = checkNumber(value);\n  }\n\n  // Calculates the length of a quat\n  len(): number {\n    return quat.length(this);\n  }\n\n  // Calculates the squared length of a quat\n  lengthSquared(): number {\n    return quat.squaredLength(this);\n  }\n\n  // Calculates the dot product of two quat's\n  // @return {Number}\n  dot(a: Readonly<NumericArray>): number {\n    return quat.dot(this, a);\n  }\n\n  // Gets the rotation axis and angle for a given quaternion.\n  // If a quaternion is created with setAxisAngle, this method will\n  // return the same values as providied in the original parameter\n  // list OR functionally equivalent values.\n  // Example: The quaternion formed by axis [0, 0, 1] and angle -90\n  // is the same as the quaternion formed by [0, 0, 1] and 270.\n  // This method favors the latter.\n  // @return {{[x,y,z], Number}}\n  // getAxisAngle() {\n  //   const axis = [];\n  //   const angle = quat.getAxisAngle(axis, this);\n  //   return {axis, angle};\n  // }\n  // MODIFIERS\n  // Sets a quaternion to represent the shortest rotation from one vector\n  // to another. Both vectors are assumed to be unit length.\n  rotationTo(vectorA: NumericArray, vectorB: NumericArray): this {\n    quat.rotationTo(this, vectorA, vectorB);\n    return this.check();\n  }\n\n  // Sets the specified quaternion with values corresponding to the given axes.\n  // Each axis is a vec3 and is expected to be unit length and perpendicular\n  // to all other specified axes.\n  // setAxes() {\n  //   Number\n  // }\n  // Performs a spherical linear interpolation with two control points\n  // sqlerp() {\n  //   Number;\n  // }\n  // Adds two quat's\n  add(a: Readonly<NumericArray>): this {\n    quat.add(this, this, a);\n    return this.check();\n  }\n\n  // Calculates the W component of a quat from the X, Y, and Z components.\n  // Any existing W component will be ignored.\n  calculateW(): this {\n    quat.calculateW(this, this);\n    return this.check();\n  }\n\n  // Calculates the conjugate of a quat If the quaternion is normalized,\n  // this function is faster than quat.inverse and produces the same result.\n  conjugate(): this {\n    quat.conjugate(this, this);\n    return this.check();\n  }\n\n  // Calculates the inverse of a quat\n  invert(): this {\n    quat.invert(this, this);\n    return this.check();\n  }\n\n  // Performs a linear interpolation between two quat's\n  lerp(a: Readonly<NumericArray>, b: Readonly<NumericArray> | number, t?: number): this {\n    if (t === undefined) {\n      return this.lerp(this, a, b as number);\n    }\n    quat.lerp(this, a, b as NumericArray, t);\n    return this.check();\n  }\n\n  // Multiplies two quat's\n  multiplyRight(a: Readonly<NumericArray>): this {\n    quat.multiply(this, this, a);\n    return this.check();\n  }\n\n  multiplyLeft(a: Readonly<NumericArray>): this {\n    quat.multiply(this, a, this);\n    return this.check();\n  }\n\n  // Normalize a quat\n  normalize(): this {\n    // Handle 0 case\n    const length = this.len();\n    const l = length > 0 ? 1 / length : 0;\n    this[0] = this[0] * l;\n    this[1] = this[1] * l;\n    this[2] = this[2] * l;\n    this[3] = this[3] * l;\n    // Set to [0, 0, 0, 1] if length is 0\n    if (length === 0) {\n      this[3] = 1;\n    }\n    return this.check();\n  }\n\n  // Rotates a quaternion by the given angle about the X axis\n  rotateX(rad: number): this {\n    quat.rotateX(this, this, rad);\n    return this.check();\n  }\n\n  // Rotates a quaternion by the given angle about the Y axis\n  rotateY(rad: number): this {\n    quat.rotateY(this, this, rad);\n    return this.check();\n  }\n\n  // Rotates a quaternion by the given angle about the Z axis\n  rotateZ(rad: number): this {\n    quat.rotateZ(this, this, rad);\n    return this.check();\n  }\n\n  // Scales a quat by a scalar number\n  scale(b: number): this {\n    quat.scale(this, this, b);\n    return this.check();\n  }\n\n  slerp(target: Readonly<NumericArray>, ratio: number): this;\n  slerp(start: Readonly<NumericArray>, target: Readonly<NumericArray>, ratio: number): this;\n  slerp(params: {\n    start: Readonly<NumericArray>;\n    target: Readonly<NumericArray>;\n    ratio: number;\n  }): this;\n\n  // Performs a spherical linear interpolation between two quat\n  slerp(\n    arg0:\n      | Readonly<NumericArray>\n      | {\n          start: Readonly<NumericArray>;\n          target: Readonly<NumericArray>;\n          ratio: number;\n        },\n    arg1?: Readonly<NumericArray> | number,\n    arg2?: number\n  ): this {\n    let start: Readonly<NumericArray>;\n    let target: Readonly<NumericArray>;\n    let ratio: number;\n    // eslint-disable-next-line prefer-rest-params\n    switch (arguments.length) {\n      case 1: // Deprecated signature ({start, target, ratio})\n        // eslint-disable-next-line prefer-rest-params\n        ({\n          start = IDENTITY_QUATERNION,\n          target,\n          ratio\n        } = arg0 as {\n          start: Readonly<NumericArray>;\n          target: Readonly<NumericArray>;\n          ratio: number;\n        });\n        break;\n      case 2: // THREE.js compatibility signature (target, ration)\n        start = this; // eslint-disable-line\n        target = arg0 as Readonly<NumericArray>;\n        ratio = arg1 as number;\n        break;\n      default:\n        // Default signature: (start, target, ratio)\n        start = arg0 as Readonly<NumericArray>;\n        target = arg1 as Readonly<NumericArray>;\n        ratio = arg2;\n    }\n    quat.slerp(this, start, target, ratio);\n    return this.check();\n  }\n\n  transformVector4(\n    vector: Readonly<NumericArray>,\n    result: NumericArray = new Vector4()\n  ): NumericArray {\n    vec4.transformQuat(result, vector, this);\n    return checkVector(result, 4);\n  }\n\n  // THREE.js Math API compatibility\n  lengthSq(): number {\n    return this.lengthSquared();\n  }\n\n  setFromAxisAngle(axis: Readonly<NumericArray>, rad: number): this {\n    return this.setAxisAngle(axis, rad);\n  }\n\n  premultiply(a: Readonly<NumericArray>): this {\n    return this.multiplyLeft(a);\n  }\n\n  multiply(a: Readonly<NumericArray>): this {\n    return this.multiplyRight(a);\n  }\n}\n", "// Copyright (c) 2017 Uber Technologies, Inc.\n// MIT License\nimport MathArray from './base/math-array';\nimport Quaternion from './quaternion';\nimport {NumericArray} from '@math.gl/types';\n\nimport {clamp} from '../lib/common';\nimport {checkNumber} from '../lib/validators';\n\n// Internal constants\nconst ERR_UNKNOWN_ORDER = 'Unknown Euler angle order';\nconst ALMOST_ONE = 0.99999;\n\nenum RotationOrder {\n  ZYX = 0,\n  YXZ = 1,\n  XZY = 2,\n  ZXY = 3,\n  YZX = 4,\n  XYZ = 5\n}\n\nexport default class Euler extends MathArray {\n  // Constants\n  static get ZYX(): RotationOrder {\n    return RotationOrder.ZYX;\n  }\n  static get YXZ(): RotationOrder {\n    return RotationOrder.YXZ;\n  }\n  static get XZY(): RotationOrder {\n    return RotationOrder.XZY;\n  }\n  static get ZXY(): RotationOrder {\n    return RotationOrder.ZXY;\n  }\n  static get YZX(): RotationOrder {\n    return RotationOrder.YZX;\n  }\n  static get XYZ(): RotationOrder {\n    return RotationOrder.XYZ;\n  }\n  static get RollPitchYaw(): RotationOrder {\n    return RotationOrder.ZYX;\n  }\n  static get DefaultOrder(): RotationOrder {\n    return RotationOrder.ZYX;\n  }\n  static get RotationOrders(): typeof RotationOrder {\n    return RotationOrder;\n  }\n  static rotationOrder(order: RotationOrder): string {\n    return RotationOrder[order];\n  }\n  get ELEMENTS(): number {\n    return 4;\n  }\n\n  /**\n   * @class\n   * @param {Number | Number[]} x\n   * @param {Number=} [y]\n   * @param {Number=} [z]\n   * @param {Number=} [order]\n   */\n  constructor(x = 0, y = 0, z = 0, order = Euler.DefaultOrder) {\n    // PERF NOTE: initialize elements as double precision numbers\n    super(-0, -0, -0, -0);\n    // eslint-disable-next-line prefer-rest-params\n    if (arguments.length > 0 && Array.isArray(arguments[0])) {\n      // eslint-disable-next-line prefer-rest-params\n      // @ts-expect-error\n      this.fromVector3(...arguments);\n    } else {\n      this.set(x, y, z, order);\n    }\n  }\n\n  fromQuaternion(quaternion: Readonly<NumericArray>): this {\n    const [x, y, z, w] = quaternion;\n    const ysqr = y * y;\n    const t0 = -2 * (ysqr + z * z) + 1;\n    const t1 = +2 * (x * y + w * z);\n    let t2 = -2 * (x * z - w * y);\n    const t3 = +2 * (y * z + w * x);\n    const t4 = -2 * (x * x + ysqr) + 1;\n    t2 = t2 > 1 ? 1 : t2;\n    t2 = t2 < -1 ? -1 : t2;\n    const roll = Math.atan2(t3, t4);\n    const pitch = Math.asin(t2);\n    const yaw = Math.atan2(t1, t0);\n    return this.set(roll, pitch, yaw, Euler.RollPitchYaw);\n  }\n\n  fromObject(object: object): this {\n    throw new Error('not implemented');\n    //  return this.set(object.x, object.y, object.z, object.order);\n  }\n\n  // fromQuaternion(q, order) {\n  //   this._fromRotationMat[-0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0];\n  //   return this.check();\n  // }\n  // If copied array does contain fourth element, preserves currently set order\n  copy(array: Readonly<NumericArray>): this {\n    this[0] = array[0];\n    this[1] = array[1];\n    this[2] = array[2];\n    // @ts-expect-error\n    this[3] = Number.isFinite(array[3]) || this.order;\n    return this.check();\n  }\n\n  // Sets the three angles, and optionally sets the rotation order\n  // If order is not specified, preserves currently set order\n  set(x = 0, y = 0, z = 0, order: RotationOrder): this {\n    this[0] = x;\n    this[1] = y;\n    this[2] = z;\n    this[3] = Number.isFinite(order) ? order : this[3];\n    return this.check();\n  }\n\n  validate(): boolean {\n    return (\n      validateOrder(this[3]) &&\n      Number.isFinite(this[0]) &&\n      Number.isFinite(this[1]) &&\n      Number.isFinite(this[2])\n    );\n  }\n\n  // Does not copy the orientation element\n  toArray(array: NumericArray = [], offset: number = 0): NumericArray {\n    array[offset] = this[0];\n    array[offset + 1] = this[1];\n    array[offset + 2] = this[2];\n    return array;\n  }\n\n  // Copies the orientation element\n  toArray4(array: NumericArray = [], offset: number = 0): NumericArray {\n    array[offset] = this[0];\n    array[offset + 1] = this[1];\n    array[offset + 2] = this[2];\n    array[offset + 3] = this[3];\n    return array;\n  }\n\n  toVector3(result: NumericArray = [-0, -0, -0]): NumericArray {\n    result[0] = this[0];\n    result[1] = this[1];\n    result[2] = this[2];\n    return result;\n  }\n  /* eslint-disable no-multi-spaces, brace-style, no-return-assign */\n  // x, y, z angle notation (note: only corresponds to axis in XYZ orientation)\n\n  get x(): number {\n    return this[0];\n  }\n  set x(value: number) {\n    this[0] = checkNumber(value);\n  }\n\n  get y(): number {\n    return this[1];\n  }\n  set y(value: number) {\n    this[1] = checkNumber(value);\n  }\n\n  get z(): number {\n    return this[2];\n  }\n  set z(value: number) {\n    this[2] = checkNumber(value);\n  }\n  // alpha, beta, gamma angle notation\n  get alpha(): number {\n    return this[0];\n  }\n  set alpha(value: number) {\n    this[0] = checkNumber(value);\n  }\n\n  get beta(): number {\n    return this[1];\n  }\n  set beta(value: number) {\n    this[1] = checkNumber(value);\n  }\n\n  get gamma(): number {\n    return this[2];\n  }\n  set gamma(value: number) {\n    this[2] = checkNumber(value);\n  }\n\n  // phi, theta, psi angle notation\n  get phi(): number {\n    return this[0];\n  }\n  set phi(value: number) {\n    this[0] = checkNumber(value);\n  }\n\n  get theta(): number {\n    return this[1];\n  }\n  set theta(value: number) {\n    this[1] = checkNumber(value);\n  }\n\n  get psi(): number {\n    return this[2];\n  }\n  set psi(value: number) {\n    this[2] = checkNumber(value);\n  }\n  // roll, pitch, yaw angle notation\n\n  get roll(): number {\n    return this[0];\n  }\n  set roll(value: number) {\n    this[0] = checkNumber(value);\n  }\n\n  get pitch(): number {\n    return this[1];\n  }\n  set pitch(value: number) {\n    this[1] = checkNumber(value);\n  }\n\n  get yaw(): number {\n    return this[2];\n  }\n  set yaw(value: number) {\n    this[2] = checkNumber(value);\n  }\n\n  // rotation order, in all three angle notations\n  get order(): RotationOrder {\n    return this[3];\n  }\n  set order(value: RotationOrder) {\n    this[3] = checkOrder(value);\n  }\n\n  // Constructors\n  fromVector3(v: Readonly<NumericArray>, order: RotationOrder): this {\n    return this.set(v[0], v[1], v[2], Number.isFinite(order) ? order : this[3]);\n  }\n\n  // TODO - with and without 4th element\n  fromArray(array: Readonly<NumericArray>, offset: number = 0): this {\n    this[0] = array[0 + offset];\n    this[1] = array[1 + offset];\n    this[2] = array[2 + offset];\n    if (array[3] !== undefined) {\n      this[3] = array[3];\n    }\n    return this.check();\n  }\n\n  // Common ZYX rotation order\n  fromRollPitchYaw(roll: number, pitch: number, yaw: number): this {\n    return this.set(roll, pitch, yaw, RotationOrder.ZYX);\n  }\n\n  fromRotationMatrix(m: Readonly<NumericArray>, order: RotationOrder = Euler.DefaultOrder): this {\n    this._fromRotationMatrix(m, order);\n    return this.check();\n  }\n\n  // ACCESSORS\n\n  getRotationMatrix(m: NumericArray): NumericArray {\n    return this._getRotationMatrix(m);\n  }\n\n  // TODO - move to Quaternion\n  getQuaternion(): Quaternion {\n    const q = new Quaternion();\n    switch (this[4]) {\n      case RotationOrder.XYZ:\n        return q.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);\n      case RotationOrder.YXZ:\n        return q.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);\n      case RotationOrder.ZXY:\n        return q.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);\n      case RotationOrder.ZYX:\n        return q.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);\n      case RotationOrder.YZX:\n        return q.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);\n      case RotationOrder.XZY:\n        return q.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);\n      default:\n        throw new Error(ERR_UNKNOWN_ORDER);\n    }\n  }\n\n  // INTERNAL METHODS\n  // Conversion from Euler to rotation matrix and from matrix to Euler\n  // Adapted from three.js under MIT license\n  // // WARNING: this discards revolution information -bhouston\n  // reorder(newOrder) {\n  //   const q = new Quaternion().setFromEuler(this);\n  //   return this.setFromQuaternion(q, newOrder);\n  /* eslint-disable complexity, max-statements, one-var */\n  _fromRotationMatrix(m: Readonly<NumericArray>, order = Euler.DefaultOrder): this {\n    // assumes the upper 3x3 of m is a pure rotation matrix (i.e, unscaled)\n    const m11 = m[0],\n      m12 = m[4],\n      m13 = m[8];\n    const m21 = m[1],\n      m22 = m[5],\n      m23 = m[9];\n    const m31 = m[2],\n      m32 = m[6],\n      m33 = m[10];\n    order = order || this[3];\n    switch (order) {\n      case Euler.XYZ:\n        this[1] = Math.asin(clamp(m13, -1, 1));\n        if (Math.abs(m13) < ALMOST_ONE) {\n          this[0] = Math.atan2(-m23, m33);\n          this[2] = Math.atan2(-m12, m11);\n        } else {\n          this[0] = Math.atan2(m32, m22);\n          this[2] = 0;\n        }\n        break;\n      case Euler.YXZ:\n        this[0] = Math.asin(-clamp(m23, -1, 1));\n        if (Math.abs(m23) < ALMOST_ONE) {\n          this[1] = Math.atan2(m13, m33);\n          this[2] = Math.atan2(m21, m22);\n        } else {\n          this[1] = Math.atan2(-m31, m11);\n          this[2] = 0;\n        }\n        break;\n      case Euler.ZXY:\n        this[0] = Math.asin(clamp(m32, -1, 1));\n        if (Math.abs(m32) < ALMOST_ONE) {\n          this[1] = Math.atan2(-m31, m33);\n          this[2] = Math.atan2(-m12, m22);\n        } else {\n          this[1] = 0;\n          this[2] = Math.atan2(m21, m11);\n        }\n        break;\n      case Euler.ZYX:\n        this[1] = Math.asin(-clamp(m31, -1, 1));\n        if (Math.abs(m31) < ALMOST_ONE) {\n          this[0] = Math.atan2(m32, m33);\n          this[2] = Math.atan2(m21, m11);\n        } else {\n          this[0] = 0;\n          this[2] = Math.atan2(-m12, m22);\n        }\n        break;\n      case Euler.YZX:\n        this[2] = Math.asin(clamp(m21, -1, 1));\n        if (Math.abs(m21) < ALMOST_ONE) {\n          this[0] = Math.atan2(-m23, m22);\n          this[1] = Math.atan2(-m31, m11);\n        } else {\n          this[0] = 0;\n          this[1] = Math.atan2(m13, m33);\n        }\n        break;\n      case Euler.XZY:\n        this[2] = Math.asin(-clamp(m12, -1, 1));\n        if (Math.abs(m12) < ALMOST_ONE) {\n          this[0] = Math.atan2(m32, m22);\n          this[1] = Math.atan2(m13, m11);\n        } else {\n          this[0] = Math.atan2(-m23, m33);\n          this[1] = 0;\n        }\n        break;\n      default:\n        throw new Error(ERR_UNKNOWN_ORDER);\n    }\n    this[3] = order;\n    return this;\n  }\n\n  _getRotationMatrix(result: NumericArray): NumericArray {\n    const te = result || [-0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0, -0];\n    const x = this.x,\n      y = this.y,\n      z = this.z;\n    const a = Math.cos(x);\n    const c = Math.cos(y);\n    const e = Math.cos(z);\n    const b = Math.sin(x);\n    const d = Math.sin(y);\n    const f = Math.sin(z);\n    switch (this[3]) {\n      case Euler.XYZ: {\n        const ae = a * e,\n          af = a * f,\n          be = b * e,\n          bf = b * f;\n        te[0] = c * e;\n        te[4] = -c * f;\n        te[8] = d;\n        te[1] = af + be * d;\n        te[5] = ae - bf * d;\n        te[9] = -b * c;\n        te[2] = bf - ae * d;\n        te[6] = be + af * d;\n        te[10] = a * c;\n        break;\n      }\n      case Euler.YXZ: {\n        const ce = c * e,\n          cf = c * f,\n          de = d * e,\n          df = d * f;\n        te[0] = ce + df * b;\n        te[4] = de * b - cf;\n        te[8] = a * d;\n        te[1] = a * f;\n        te[5] = a * e;\n        te[9] = -b;\n        te[2] = cf * b - de;\n        te[6] = df + ce * b;\n        te[10] = a * c;\n        break;\n      }\n      case Euler.ZXY: {\n        const ce = c * e,\n          cf = c * f,\n          de = d * e,\n          df = d * f;\n        te[0] = ce - df * b;\n        te[4] = -a * f;\n        te[8] = de + cf * b;\n        te[1] = cf + de * b;\n        te[5] = a * e;\n        te[9] = df - ce * b;\n        te[2] = -a * d;\n        te[6] = b;\n        te[10] = a * c;\n        break;\n      }\n      case Euler.ZYX: {\n        const ae = a * e,\n          af = a * f,\n          be = b * e,\n          bf = b * f;\n        te[0] = c * e;\n        te[4] = be * d - af;\n        te[8] = ae * d + bf;\n        te[1] = c * f;\n        te[5] = bf * d + ae;\n        te[9] = af * d - be;\n        te[2] = -d;\n        te[6] = b * c;\n        te[10] = a * c;\n        break;\n      }\n      case Euler.YZX: {\n        const ac = a * c,\n          ad = a * d,\n          bc = b * c,\n          bd = b * d;\n        te[0] = c * e;\n        te[4] = bd - ac * f;\n        te[8] = bc * f + ad;\n        te[1] = f;\n        te[5] = a * e;\n        te[9] = -b * e;\n        te[2] = -d * e;\n        te[6] = ad * f + bc;\n        te[10] = ac - bd * f;\n        break;\n      }\n      case Euler.XZY: {\n        const ac = a * c,\n          ad = a * d,\n          bc = b * c,\n          bd = b * d;\n        te[0] = c * e;\n        te[4] = -f;\n        te[8] = d * e;\n        te[1] = ac * f + bd;\n        te[5] = a * e;\n        te[9] = ad * f - bc;\n        te[2] = bc * f - ad;\n        te[6] = b * e;\n        te[10] = bd * f + ac;\n        break;\n      }\n      default:\n        throw new Error(ERR_UNKNOWN_ORDER);\n    }\n    // last column\n    te[3] = 0;\n    te[7] = 0;\n    te[11] = 0;\n    // bottom row\n    te[12] = 0;\n    te[13] = 0;\n    te[14] = 0;\n    te[15] = 1;\n    return te;\n  }\n\n  toQuaternion(): Quaternion {\n    // Abbreviations for the various angular functions\n    const cy = Math.cos(this.yaw * 0.5);\n    const sy = Math.sin(this.yaw * 0.5);\n    const cr = Math.cos(this.roll * 0.5);\n    const sr = Math.sin(this.roll * 0.5);\n    const cp = Math.cos(this.pitch * 0.5);\n    const sp = Math.sin(this.pitch * 0.5);\n    const w = cy * cr * cp + sy * sr * sp;\n    const x = cy * sr * cp - sy * cr * sp;\n    const y = cy * cr * sp + sy * sr * cp;\n    const z = sy * cr * cp - cy * sr * sp;\n    return new Quaternion(x, y, z, w);\n  }\n}\n\n// HELPER FUNCTIONS\n\nfunction validateOrder(value: number): boolean {\n  return value >= 0 && value < 6;\n}\n\nfunction checkOrder(value: number) {\n  if (value < 0 && value >= 6) {\n    throw new Error(ERR_UNKNOWN_ORDER);\n  }\n  return value;\n}\n", "// NOTE: Added to make Cesium-derived test cases work\n// TODO: Determine if/how to keep\nexport default {\n  EPSILON1: 1e-1,\n  EPSILON2: 1e-2,\n  EPSILON3: 1e-3,\n  EPSILON4: 1e-4,\n  EPSILON5: 1e-5,\n  EPSILON6: 1e-6,\n  EPSILON7: 1e-7,\n  EPSILON8: 1e-8,\n  EPSILON9: 1e-9,\n  EPSILON10: 1e-10,\n  EPSILON11: 1e-11,\n  EPSILON12: 1e-12,\n  EPSILON13: 1e-13,\n  EPSILON14: 1e-14,\n  EPSILON15: 1e-15,\n  EPSILON16: 1e-16,\n  EPSILON17: 1e-17,\n  EPSILON18: 1e-18,\n  EPSILON19: 1e-19,\n  EPSILON20: 1e-20,\n\n  PI_OVER_TWO: Math.PI / 2,\n  PI_OVER_FOUR: Math.PI / 4,\n  PI_OVER_SIX: Math.PI / 6,\n\n  TWO_PI: Math.PI * 2\n};\n"],
  "mappings": "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",
  "names": ["assert", "condition", "message", "Error", "obj", "timestamp", "window", "performance", "now", "process", "hrtime", "timeParts", "Date", "Stat", "constructor", "name", "type", "sampleSize", "time", "count", "samples", "lastTiming", "lastSampleTime", "lastSampleCount", "_count", "_time", "_samples", "_startTime", "_timerPending", "reset", "setSampleSize", "incrementCount", "addCount", "decrementCount", "subtractCount", "value", "_checkSampling", "addTime", "timeStart", "getHiResTimestamp", "timeEnd", "getSampleAverageCount", "getSampleAverageTime", "getSampleHz", "getAverageCount", "getAverageTime", "getHz", "Stats", "constructor", "options", "id", "stats", "_initializeStats", "Object", "seal", "get", "name", "type", "_getOrCreate", "size", "keys", "length", "reset", "stat", "values", "forEach", "fn", "getTable", "table", "time", "count", "average", "getAverageTime", "hz", "getHz", "result", "Stat", "STAT_QUEUED_REQUESTS", "STAT_ACTIVE_REQUESTS", "STAT_CANCELLED_REQUESTS", "STAT_QUEUED_REQUESTS_EVER", "STAT_ACTIVE_REQUESTS_EVER", "DEFAULT_PROPS", "id", "throttleRequests", "maxRequests", "RequestScheduler", "constructor", "props", "arguments", "length", "undefined", "_defineProperty", "Map", "stats", "Stats", "get", "scheduleRequest", "handle", "getPriority", "Promise", "resolve", "done", "requestMap", "has", "request", "priority", "promise", "requestQueue", "push", "set", "_issueNewRequests", "_issueRequest", "isDone", "delete", "activeRequestCount", "deferredUpdate", "setTimeout", "_issueNewRequestsAsync", "freeSlots", "Math", "max", "_updateAllRequests", "i", "shift", "_updateRequest", "splice", "sort", "a", "b", "getCWD", "_window$location", "process", "cwd", "pathname", "window", "location", "slice", "lastIndexOf", "filename", "url", "slashIndex", "lastIndexOf", "substr", "dirname", "join", "_len", "arguments", "length", "parts", "Array", "_key", "separator", "map", "part", "index", "replace", "RegExp", "concat", "resolve", "paths", "_i", "undefined", "resolvedPath", "resolvedAbsolute", "cwd", "i", "path", "getCWD", "charCodeAt", "SLASH", "normalizeStringPosix", "DOT", "allowAboveRoot", "res", "lastSlash", "dots", "code", "isAboveRoot", "start", "j", "slice", "globals", "self", "window", "global", "document", "self_", "window_", "global_", "document_", "isBrowser", "Boolean", "process", "String", "browser", "matches", "process", "version", "exec", "nodeVersion", "parseFloat", "mergeLoaderOptions", "baseOptions", "newOptions", "options", "key", "newValue", "Object", "entries", "assign", "VERSION", "DEFAULT_VERSION", "console", "error", "assert", "condition", "message", "Error", "globals", "self", "window", "global", "document", "self_", "window_", "global_", "document_", "isBrowser", "process", "String", "browser", "isWorker", "importScripts", "isMobile", "window", "orientation", "matches", "version", "exec", "nodeVersion", "parseFloat", "WorkerJob", "constructor", "jobName", "workerThread", "_defineProperty", "name", "result", "Promise", "resolve", "reject", "_resolve", "_reject", "postMessage", "type", "payload", "source", "done", "value", "assert", "isRunning", "error", "Worker", "terminate", "workerURLCache", "Map", "getLoadableWorkerURL", "props", "assert", "source", "url", "workerURL", "get", "getLoadableWorkerURLFromURL", "set", "getLoadableWorkerURLFromSource", "startsWith", "workerSource", "buildScriptSource", "blob", "Blob", "type", "URL", "createObjectURL", "workerUrl", "concat", "getTransferList", "object", "recursive", "arguments", "length", "undefined", "transfers", "transfersSet", "Set", "isTransferable", "add", "buffer", "ArrayBuffer", "isView", "key", "Array", "from", "MessagePort", "ImageBitmap", "OffscreenCanvas", "NOOP", "WorkerThread", "isSupported", "Worker", "isBrowser", "NodeWorker", "constructor", "props", "_defineProperty", "name", "source", "url", "assert", "onMessage", "onError", "error", "console", "log", "worker", "_createBrowserWorker", "_createNodeWorker", "destroy", "terminate", "terminated", "isRunning", "Boolean", "postMessage", "data", "transferList", "getTransferList", "_getErrorFromErrorEvent", "event", "message", "concat", "lineno", "colno", "Error", "_loadableURL", "getLoadableWorkerURL", "onmessage", "onerror", "onmessageerror", "absolute", "includes", "startsWith", "eval", "on", "code", "WorkerPool", "isSupported", "WorkerThread", "constructor", "props", "_defineProperty", "source", "url", "setProps", "destroy", "idleQueue", "forEach", "worker", "isDestroyed", "name", "undefined", "maxConcurrency", "maxMobileConcurrency", "reuseWorkers", "onDebug", "startJob", "onMessage", "arguments", "length", "job", "type", "data", "done", "onError", "error", "startPromise", "Promise", "onStart", "jobQueue", "push", "_startQueuedJob", "workerThread", "_getAvailableWorker", "queuedJob", "shift", "message", "backlog", "WorkerJob", "payload", "result", "returnWorkerToQueue", "shouldDestroyWorker", "count", "_getMaxConcurrency", "concat", "toLowerCase", "isMobile", "DEFAULT_PROPS", "maxConcurrency", "maxMobileConcurrency", "reuseWorkers", "onDebug", "WorkerFarm", "isSupported", "WorkerThread", "getWorkerFarm", "props", "arguments", "length", "undefined", "_workerFarm", "setProps", "constructor", "_defineProperty", "Map", "workerPools", "destroy", "workerPool", "values", "_getWorkerPoolProps", "getWorkerPool", "options", "name", "source", "url", "get", "WorkerPool", "set", "getParentPort", "parentPort", "eval", "globalThis", "onMessageWrapperMap", "Map", "WorkerBody", "inWorkerThread", "self", "Boolean", "onmessage", "onMessage", "handleMessage", "message", "type", "payload", "data", "on", "console", "debug", "addEventListener", "onMessageWrapper", "get", "isKnownMessage", "error", "removeEventListener", "delete", "postMessage", "source", "transferList", "getTransferList", "startsWith", "NPM_TAG", "getWorkerURL", "worker", "options", "arguments", "length", "undefined", "workerOptions", "id", "workerFile", "concat", "url", "workerUrl", "_workerType", "module", "version", "NPM_TAG", "versionTag", "assert", "Symbol", "asyncIterator", "AsyncQueue", "constructor", "_defineProperty", "_values", "_settlers", "_closed", "_Symbol$asyncIterator", "push", "value", "enqueue", "Error", "length", "settler", "shift", "reject", "resolve", "close", "done", "next", "Promise", "undefined", "validateWorkerVersion", "worker", "coreVersion", "arguments", "length", "undefined", "VERSION", "assert", "workerVersion", "version", "VERSION", "LATEST", "loadLibraryPromises", "loadLibrary", "libraryUrl", "moduleName", "arguments", "length", "undefined", "options", "getLibraryUrl", "loadLibraryFromFile", "library", "startsWith", "modules", "isBrowser", "concat", "CDN", "assert", "isWorker", "endsWith", "response", "fetch", "arrayBuffer", "node", "requireFromFile", "importScripts", "scriptSource", "text", "loadLibraryFromString", "id", "requireFromString", "eval", "call", "global", "script", "document", "createElement", "appendChild", "createTextNode", "e", "body", "canParseWithWorker", "loader", "options", "WorkerFarm", "isSupported", "isBrowser", "_nodeWorkers", "worker", "parseWithWorker", "data", "context", "parseOnMainThread", "name", "id", "url", "getWorkerURL", "workerFarm", "getWorkerFarm", "workerPool", "getWorkerPool", "JSON", "parse", "stringify", "job", "startJob", "onMessage", "bind", "postMessage", "input", "result", "type", "payload", "done", "error", "Error", "message", "console", "warn", "concat", "getFirstCharacters", "data", "length", "arguments", "undefined", "slice", "ArrayBuffer", "isView", "getMagicString", "buffer", "byteOffset", "arrayBuffer", "byteLength", "dataView", "DataView", "magic", "i", "String", "fromCharCode", "getUint8", "parseJSON", "string", "JSON", "parse", "_", "Error", "concat", "getFirstCharacters", "compareArrayBuffers", "arrayBuffer1", "arrayBuffer2", "byteLength", "array1", "Uint8Array", "array2", "i", "length", "concatenateArrayBuffers", "_len", "arguments", "sources", "Array", "_key", "sourceArrays", "map", "source2", "ArrayBuffer", "reduce", "typedArray", "result", "offset", "sourceArray", "set", "buffer", "concatenateTypedArrays", "_len2", "typedArrays", "_key2", "arrays", "TypedArrayConstructor", "constructor", "Error", "sumLength", "acc", "value", "array", "sliceArrayBuffer", "arrayBuffer", "byteOffset", "subArray", "undefined", "subarray", "arrayCopy", "padToNBytes", "byteLength", "padding", "assert", "copyToArray", "source", "target", "targetOffset", "sourceArray", "ArrayBuffer", "Uint8Array", "srcByteOffset", "byteOffset", "srcByteLength", "byteLength", "buffer", "arrayBuffer", "set", "padToNBytes", "padStringToByteAlignment", "string", "byteAlignment", "length", "paddedLength", "Math", "ceil", "padding", "whitespace", "i", "copyStringToDataView", "dataView", "byteOffset", "byteLength", "setUint8", "charCodeAt", "copyBinaryToDataView", "binary", "copyPaddedArrayBufferToDataView", "sourceBuffer", "padToNBytes", "padLength", "targetArray", "Uint8Array", "buffer", "sourceArray", "set", "copyPaddedStringToDataView", "textEncoder", "TextEncoder", "stringBuffer", "encode", "concatenateArrayBuffersAsync", "asyncIterator", "arrayBuffers", "chunk", "push", "concatenateArrayBuffers", "pathPrefix", "fileAliases", "resolvePath", "filename", "alias", "fileAliases", "startsWith", "replacement", "replace", "concat", "pathPrefix", "toArrayBuffer", "buffer", "isBuffer", "value", "toArrayBuffer", "data", "isBuffer", "ArrayBuffer", "isView", "byteOffset", "byteLength", "buffer", "slice", "text", "uint8Array", "TextEncoder", "encode", "_toArrayBuffer", "Error", "promisify2", "fn", "arg1", "arg2", "Promise", "resolve", "reject", "error", "callbackArgs", "promisify3", "arg3", "readdir", "stat", "readFile", "readFileSync", "writeFile", "writeFileSync", "open", "close", "read", "fstat", "createWriteStream", "isSupported", "Boolean", "fs", "promisify2", "promisify3", "fd", "Promise", "resolve", "reject", "err", "Transform", "isSupported", "Boolean", "stream", "isBoolean", "x", "isFunction", "isObject", "isPureObject", "constructor", "isIterable", "x", "Symbol", "iterator", "isAsyncIterable", "asyncIterator", "isResponse", "x", "Response", "arrayBuffer", "text", "json", "isBlob", "x", "Blob", "isBuffer", "isReadableDOMStream", "x", "ReadableStream", "isObject", "isFunction", "tee", "cancel", "getReader", "isReadableNodeStream", "x", "isObject", "isFunction", "read", "pipe", "isBoolean", "readable", "isReadableStream", "isReadableDOMStream", "DATA_URL_PATTERN", "MIME_TYPE_PATTERN", "parseMIMEType", "mimeString", "matches", "exec", "parseMIMETypeFromURL", "url", "QUERY_STRING_PATTERN", "extractQueryString", "url", "matches", "match", "stripQueryString", "replace", "getResourceUrl", "resource", "isResponse", "response", "url", "isBlob", "blob", "name", "getResourceMIMEType", "contentTypeHeader", "headers", "get", "noQueryUrl", "stripQueryString", "parseMIMEType", "parseMIMETypeFromURL", "type", "getResourceContentLength", "size", "length", "ArrayBuffer", "byteLength", "isView", "makeResponse", "resource", "isResponse", "headers", "contentLength", "getResourceContentLength", "String", "url", "getResourceUrl", "type", "getResourceMIMEType", "initialDataUrl", "getInitialDataUrl", "TextEncoder", "encode", "response", "Response", "Object", "defineProperty", "value", "checkResponse", "ok", "message", "getResponseError", "Error", "getResponseError", "response", "message", "concat", "url", "status", "contentType", "headers", "get", "text", "statusText", "includes", "length", "slice", "error", "getInitialDataUrl", "resource", "INITIAL_DATA_LENGTH", "Blob", "blobSlice", "Promise", "resolve", "reader", "FileReader", "onload", "event", "_event$target", "target", "result", "readAsDataURL", "ArrayBuffer", "base64", "arrayBufferToBase64", "buffer", "binary", "bytes", "Uint8Array", "i", "byteLength", "String", "fromCharCode", "btoa", "fetchFile", "url", "options", "resolvePath", "fetchOptions", "fetch", "makeResponse", "isLoaderObject", "loader", "_loader", "Array", "isArray", "hasExtensions", "extensions", "normalizeLoader", "_loader2", "_loader3", "assert", "options", "parseTextSync", "parseText", "text", "binary", "mockUserAgent", "window", "process", "type", "versions", "Boolean", "realUserAgent", "navigator", "userAgent", "indexOf", "isBrowser", "isNode", "process", "String", "browser", "isElectron", "self_", "globalThis", "self", "window", "global", "window_", "document_", "document", "process_", "process", "console_", "console", "navigator_", "navigator", "VERSION", "__VERSION__", "isBrowser", "checkIfBrowser", "getStorage", "type", "storage", "window", "x", "setItem", "removeItem", "e", "LocalStorage", "constructor", "id", "defaultConfig", "config", "_loadConfiguration", "getConfiguration", "setConfiguration", "configuration", "Object", "assign", "serialized", "JSON", "stringify", "serializedConfiguration", "getItem", "parse", "formatTime", "ms", "formatted", "toFixed", "leftPad", "string", "length", "padLength", "Math", "max", "repeat", "formatImage", "image", "message", "scale", "maxWidth", "imageUrl", "src", "replace", "width", "Math", "min", "height", "style", "floor", "join", "COLOR", "BACKGROUND_INCREMENT", "getColor", "color", "toUpperCase", "WHITE", "addColor", "string", "background", "isBrowser", "colorCode", "autobind", "obj", "predefined", "proto", "Object", "getPrototypeOf", "propNames", "getOwnPropertyNames", "object", "key", "value", "find", "name", "bind", "assert", "condition", "message", "Error", "getHiResTimestamp", "timestamp", "isBrowser", "window", "performance", "now", "process", "timeParts", "hrtime", "Date", "originalConsole", "debug", "isBrowser", "console", "log", "info", "warn", "error", "DEFAULT_LOG_CONFIGURATION", "enabled", "level", "noop", "cache", "ONCE", "once", "Log", "constructor", "id", "VERSION", "_startTs", "getHiResTimestamp", "_deltaTs", "_storage", "userData", "LOG_THROTTLE_TIMEOUT", "LocalStorage", "timeStamp", "autobind", "Object", "seal", "newLevel", "setLevel", "getLevel", "isEnabled", "config", "getTotal", "Number", "toPrecision", "getDelta", "priority", "newPriority", "getPriority", "enable", "setConfiguration", "get", "setting", "set", "value", "settings", "table", "assert", "condition", "message", "_getLogFunction", "arguments", "deprecated", "oldUsage", "newUsage", "removed", "probe", "logLevel", "time", "columns", "tag", "getTableHeader", "image", "scale", "_shouldLog", "logImageInBrowser", "logImageInNode", "timeEnd", "group", "opts", "collapsed", "options", "normalizeArguments", "method", "groupCollapsed", "assign", "groupEnd", "withGroup", "func", "trace", "normalizeLogLevel", "args", "total", "delta", "decorateMessage", "bind", "resolvedLevel", "isFinite", "Array", "from", "length", "shift", "undefined", "unshift", "messageType", "leftPad", "formatTime", "addColor", "color", "background", "img", "Image", "onload", "formatImage", "src", "element", "nodeName", "toLowerCase", "toDataURL", "key", "title", "globalThis", "probe", "Log", "id", "probeLog", "Log", "id", "NullLog", "log", "info", "warn", "error", "ConsoleLog", "constructor", "_defineProperty", "console", "_len", "arguments", "length", "args", "Array", "_key", "bind", "_len2", "_key2", "_len3", "_key3", "_len4", "_key4", "DEFAULT_LOADER_OPTIONS", "fetch", "mimeType", "undefined", "nothrow", "log", "ConsoleLog", "CDN", "worker", "maxConcurrency", "maxMobileConcurrency", "reuseWorkers", "isBrowser", "_nodeWorkers", "_workerType", "limit", "_limitMB", "batchSize", "batchDebounceMs", "metadata", "transforms", "REMOVED_LOADER_OPTIONS", "throws", "dataType", "uri", "method", "headers", "body", "mode", "credentials", "cache", "redirect", "referrer", "referrerPolicy", "integrity", "keepalive", "signal", "getGlobalLoaderState", "globalThis", "loaders", "_state", "getGlobalLoaderOptions", "state", "globalOptions", "DEFAULT_LOADER_OPTIONS", "normalizeOptions", "options", "loader", "loaders", "url", "Array", "isArray", "validateOptions", "normalizeOptionsInternal", "validateOptionsObject", "DEFAULT_LOADER_OPTIONS", "REMOVED_LOADER_OPTIONS", "idOptions", "id", "loaderOptions", "deprecatedOptions", "defaultOptions", "loaderName", "prefix", "concat", "key", "isSubOptions", "isObject", "isBaseUriOption", "isWorkerUrlOption", "probeLog", "warn", "suggestion", "findSimilarOption", "optionKey", "lowerCaseOptionKey", "toLowerCase", "bestSuggestion", "lowerCaseKey", "isPartialMatch", "startsWith", "loaderDefaultOptions", "mergedOptions", "addUrlOptions", "log", "NullLog", "mergeNestedFields", "getGlobalLoaderOptions", "value", "isPureObject", "baseUri", "getGlobalLoaderRegistry", "state", "getGlobalLoaderState", "loaderRegistry", "registerLoaders", "loaders", "Array", "isArray", "loader", "normalizedLoader", "normalizeLoader", "find", "registeredLoader", "unshift", "getRegisteredLoaders", "getFetchFunction", "options", "context", "globalOptions", "getGlobalLoaderOptions", "fetchOptions", "fetch", "isObject", "url", "fetchFile", "DEFAULT_CHUNK_SIZE", "makeStringIterator", "string", "options", "chunkSize", "offset", "textEncoder", "TextEncoder", "length", "chunkLength", "Math", "min", "chunk", "slice", "encode", "DEFAULT_CHUNK_SIZE", "makeArrayBufferIterator", "arrayBuffer", "options", "arguments", "length", "undefined", "chunkSize", "byteOffset", "byteLength", "chunkByteLength", "Math", "min", "chunk", "ArrayBuffer", "sourceArray", "Uint8Array", "chunkArray", "set", "DEFAULT_CHUNK_SIZE", "makeBlobIterator", "blob", "options", "chunkSize", "offset", "size", "end", "chunk", "slice", "arrayBuffer", "makeStreamIterator", "stream", "options", "isBrowser", "makeBrowserStreamIterator", "makeNodeStreamIterator", "reader", "getReader", "nextBatchPromise", "currentBatchPromise", "read", "_streamReadAhead", "done", "value", "toArrayBuffer", "error", "releaseLock", "chunk", "makeIterator", "data", "options", "makeStringIterator", "ArrayBuffer", "makeArrayBufferIterator", "isBlob", "makeBlobIterator", "isReadableStream", "makeStreamIterator", "isResponse", "response", "body", "Error", "ERR_DATA", "getArrayBufferOrStringFromDataSync", "data", "loader", "options", "text", "isBuffer", "buffer", "ArrayBuffer", "arrayBuffer", "binary", "textDecoder", "TextDecoder", "decode", "isView", "byteLength", "length", "byteOffset", "slice", "Error", "getArrayBufferOrStringFromData", "isArrayBuffer", "isBlob", "makeResponse", "isResponse", "response", "checkResponse", "isReadableStream", "makeIterator", "isIterable", "isAsyncIterable", "concatenateArrayBuffersAsync", "getLoaderContext", "context", "options", "parentContext", "newContext", "fetch", "getFetchFunction", "url", "baseUrl", "stripQueryString", "queryString", "extractQueryString", "filename", "path", "dirname", "Array", "isArray", "loaders", "getLoadersFromContext", "candidateLoaders", "contextLoaders", "length", "log", "Log", "id", "EXT_PATTERN", "selectLoader", "data", "loaders", "arguments", "length", "undefined", "options", "context", "validHTTPResponse", "loader", "selectLoaderSync", "nothrow", "isBlob", "slice", "arrayBuffer", "Error", "getNoValidLoaderMessage", "Array", "isArray", "normalizeLoader", "candidateLoaders", "concat", "ignoreRegisteredLoaders", "push", "getRegisteredLoaders", "normalizeLoaders", "selectLoaderInternal", "url", "getResourceUrl", "type", "getResourceMIMEType", "testUrl", "stripQueryString", "reason", "mimeType", "findLoaderByMIMEType", "findLoaderByUrl", "findLoaderByInitialBytes", "getFirstCharacters", "fallbackMimeType", "_loader", "log", "name", "Response", "status", "message", "path", "filename", "firstCharacters", "match", "exec", "extension", "findLoaderByExtension", "toLowerCase", "loaderExtension", "extensions", "mimeTypes", "includes", "id", "testDataAgainstText", "ArrayBuffer", "isView", "testDataAgainstBinary", "buffer", "byteOffset", "testText", "tests", "some", "test", "startsWith", "testBinary", "compareArrayBuffers", "byteLength", "magic", "getMagicString", "dataView", "DataView", "i", "String", "fromCharCode", "getUint8", "parse", "data", "loaders", "options", "context", "assert", "Array", "isArray", "isLoaderObject", "undefined", "url", "getResourceUrl", "typedLoaders", "candidateLoaders", "getLoadersFromContext", "loader", "selectLoader", "normalizeOptions", "getLoaderContext", "parseWithLoader", "validateWorkerVersion", "isResponse", "response", "ok", "redirected", "status", "statusText", "type", "headers", "Object", "fromEntries", "entries", "getArrayBufferOrStringFromData", "parseTextSync", "dataType", "canParseWithWorker", "parseWithWorker", "parseText", "parseSync", "Error", "concat", "id", "load", "url", "loaders", "options", "context", "Array", "isArray", "isLoaderObject", "undefined", "fetch", "getFetchFunction", "data", "isBlob", "parse", "VERSION", "_parseImageNode", "globalThis", "IMAGE_SUPPORTED", "Image", "IMAGE_BITMAP_SUPPORTED", "ImageBitmap", "NODE_IMAGE_SUPPORTED", "Boolean", "DATA_SUPPORTED", "isBrowser", "isImageTypeSupported", "type", "Error", "concat", "getDefaultImageType", "getImageType", "image", "format", "getImageTypeOrNull", "Error", "getImageData", "image", "getImageType", "canvas", "document", "createElement", "context", "getContext", "Error", "width", "height", "drawImage", "getImageTypeOrNull", "ImageBitmap", "Image", "data", "SVG_DATA_URL_PATTERN", "SVG_URL_PATTERN", "isSVG", "url", "test", "getBlobOrSVGDataUrl", "arrayBuffer", "textDecoder", "TextDecoder", "xmlText", "decode", "unescape", "encodeURIComponent", "error", "Error", "message", "src", "concat", "btoa", "getBlob", "Blob", "Uint8Array", "arrayBuffer", "options", "url", "blobOrDataUrl", "getBlobOrSVGDataUrl", "URL", "self", "webkitURL", "objectUrl", "createObjectURL", "loadToImage", "revokeObjectURL", "image", "Image", "src", "decode", "Promise", "resolve", "reject", "onload", "onerror", "err", "Error", "concat", "error", "EMPTY_OBJECT", "imagebitmapOptionsSupported", "arrayBuffer", "options", "url", "blob", "isSVG", "image", "parseToImage", "getBlob", "imagebitmapOptions", "imagebitmap", "safeCreateImageBitmap", "arguments", "length", "undefined", "isEmptyObject", "createImageBitmap", "error", "console", "warn", "object", "key", "getISOBMFFMediaType", "buffer", "checkString", "decodeMajorBrand", "brandMajor", "getUTF8String", "replace", "trim", "extension", "mimeType", "array", "start", "end", "String", "fromCharCode", "slice", "stringToBytes", "string", "map", "character", "charCodeAt", "header", "offset", "arguments", "length", "undefined", "headerBytes", "i", "BIG_ENDIAN", "LITTLE_ENDIAN", "getBinaryImageMetadata", "binaryData", "dataView", "toDataView", "getPngMetadata", "getJpegMetadata", "getGifMetadata", "getBmpMetadata", "getISOBMFFMetadata", "buffer", "Uint8Array", "DataView", "mediaType", "getISOBMFFMediaType", "mimeType", "width", "height", "isPng", "byteLength", "getUint32", "isGif", "getUint16", "isBmp", "isJpeg", "getUint8", "tableMarkers", "sofMarkers", "getJpegMarkers", "i", "marker", "has", "Set", "add", "data", "ArrayBuffer", "isView", "Error", "arrayBuffer", "options", "mimeType", "getBinaryImageMetadata", "_parseImageNode", "globalThis", "assert", "arrayBuffer", "options", "context", "imageOptions", "image", "imageType", "type", "url", "loadType", "getLoadableImageType", "parseToImageBitmap", "parseToImage", "parseToNodeImage", "assert", "getImageData", "getDefaultImageType", "isImageTypeSupported", "EXTENSIONS", "MIME_TYPES", "DEFAULT_IMAGE_LOADER_OPTIONS", "image", "type", "decode", "ImageLoader", "id", "module", "name", "version", "VERSION", "mimeTypes", "extensions", "parse", "parseImage", "tests", "arrayBuffer", "Boolean", "getBinaryImageMetadata", "DataView", "options", "_encodeImageNode", "globalThis", "mimeTypeSupportedSync", "isImageFormatSupported", "mimeType", "undefined", "supported", "isBrowser", "checkBrowserImageFormatSupport", "checkNodeImageFormatSupport", "NODE_FORMAT_SUPPORT", "_parseImageNode", "_imageFormatsNode", "globalThis", "Boolean", "includes", "testBrowserImageFormatSupport", "testBrowserImageFormatSupport", "mimeType", "element", "document", "createElement", "dataURL", "toDataURL", "indexOf", "concat", "assert", "condition", "message", "Error", "RADIANS_TO_DEGREES", "Math", "PI", "DEGREES_TO_RADIANS", "config", "EPSILON", "debug", "precision", "printTypes", "printDegrees", "printRowMajor", "formatValue", "value", "precision", "config", "round", "parseFloat", "toPrecision", "isArray", "Array", "ArrayBuffer", "isView", "DataView", "toRadians", "degrees", "radians", "toDegrees", "result", "map", "DEGREES_TO_RADIANS", "RADIANS_TO_DEGREES", "clamp", "value", "min", "max", "map", "Math", "lerp", "a", "b", "t", "isArray", "ai", "i", "equals", "epsilon", "oldEpsilon", "config", "EPSILON", "length", "abs", "round", "value", "Math", "config", "EPSILON", "duplicateArray", "array", "clone", "Array", "length", "map", "func", "result", "isArray", "i", "lerp", "forEach", "create", "length", "subtract", "negate", "len", "lerp", "transformMat4", "transformMat3", "sub", "subtract", "length", "forEach", "create", "MathArray", "Array", "clone", "constructor", "copy", "fromArray", "array", "offset", "i", "ELEMENTS", "check", "toArray", "targetArray", "from", "arrayOrObject", "isArray", "fromObject", "to", "toObject", "toTarget", "target", "toFloat32Array", "Float32Array", "toString", "formatString", "config", "opts", "string", "formatValue", "printTypes", "name", "equals", "length", "exactEquals", "negate", "lerp", "a", "b", "t", "undefined", "ai", "min", "vector", "Math", "max", "clamp", "minVector", "maxVector", "add", "vectors", "subtract", "scale", "multiplyByScalar", "scalar", "debug", "validate", "Error", "valid", "Number", "isFinite", "sub", "setScalar", "addScalar", "subScalar", "multiplyScalar", "divideScalar", "clampScalar", "elements", "validateVector", "v", "length", "i", "Number", "isFinite", "checkNumber", "value", "Error", "checkVector", "callerName", "config", "debug", "Vector", "MathArray", "x", "value", "checkNumber", "y", "len", "Math", "sqrt", "lengthSquared", "magnitude", "length", "i", "ELEMENTS", "magnitudeSquared", "distance", "mathArray", "distanceSquared", "dist", "dot", "product", "normalize", "check", "multiply", "vectors", "vector", "divide", "lengthSq", "distanceTo", "distanceToSquared", "getComponent", "assert", "setComponent", "addVectors", "a", "b", "copy", "add", "subVectors", "subtract", "multiplyVectors", "addScaledVector", "constructor", "multiplyScalar", "vec2_transformMat4AsVector", "out", "a", "m", "x", "y", "w", "vec3_transformMat4AsVector", "z", "vec3_transformMat2", "vec4_transformMat2", "vec4_transformMat3", "ORIGIN", "ZERO", "Vector3", "Vector", "Object", "freeze", "constructor", "x", "y", "z", "arguments", "length", "isArray", "copy", "config", "debug", "checkNumber", "set", "check", "array", "fromObject", "object", "toObject", "ELEMENTS", "value", "angle", "vector", "cross", "vec3", "rotateX", "radians", "origin", "rotateY", "rotateZ", "transform", "matrix4", "transformAsPoint", "transformMat4", "transformAsVector", "vec3_transformMat4AsVector", "transformByMatrix3", "matrix3", "transformMat3", "transformByMatrix2", "matrix2", "vec3_transformMat2", "transformByQuaternion", "quaternion", "transformQuat", "scale", "len", "rotateX", "rotateY", "rotateZ", "len", "create", "add", "scale", "length", "squaredLength", "normalize", "len", "dot", "lerp", "transformMat4", "transformQuat", "forEach", "create", "Matrix", "MathArray", "toString", "string", "config", "printRowMajor", "row", "RANK", "col", "i", "ELEMENTS", "getElementIndex", "getElement", "setElement", "value", "checkNumber", "getColumn", "columnIndex", "result", "Array", "fill", "firstIndex", "setColumn", "columnVector", "INDICES", "DEFAULT_FOVY", "Math", "PI", "DEFAULT_ASPECT", "DEFAULT_NEAR", "DEFAULT_FAR", "IDENTITY_MATRIX", "Object", "freeze", "Matrix4", "Matrix", "IDENTITY", "getIdentityMatrix", "ZERO", "getZeroMatrix", "ELEMENTS", "RANK", "constructor", "array", "arguments", "length", "Array", "isArray", "copy", "identity", "check", "set", "m00", "m10", "m20", "m30", "m01", "m11", "m21", "m31", "m02", "m12", "m22", "m32", "m03", "m13", "m23", "m33", "setRowMajor", "toRowMajor", "result", "fromObject", "object", "fromQuaternion", "quaternion", "mat4", "fromQuat", "frustum", "view", "left", "right", "bottom", "top", "near", "far", "Infinity", "computeInfinitePerspectiveOffCenter", "lookAt", "eye", "center", "up", "ortho", "orthographic", "fovy", "aspect", "focalDistance", "checkRadians", "halfY", "tan", "perspective", "determinant", "getScale", "sqrt", "getTranslation", "getRotation", "scaleResult", "scale", "inverseScale0", "inverseScale1", "inverseScale2", "getRotationMatrix3", "transpose", "invert", "multiplyLeft", "a", "multiply", "multiplyRight", "rotateX", "radians", "rotateY", "rotateZ", "rotateXYZ", "angleXYZ", "rotateAxis", "axis", "rotate", "factor", "translate", "vector", "transform", "transformMat4", "checkVector", "transformAsPoint", "out", "Error", "transformAsVector", "vec2_transformMat4AsVector", "vec3_transformMat4AsVector", "transformPoint", "transformVector", "transformDirection", "makeRotationX", "makeTranslation", "x", "y", "z", "possiblyDegrees", "column0Row0", "column1Row1", "column2Row0", "column2Row1", "column2Row2", "column2Row3", "column3Row2", "EPSILON", "EARTH_RADIUS_METERS", "SphericalCoordinates", "constructor", "phi", "theta", "radius", "bearing", "pitch", "altitude", "radiusScale", "undefined", "check", "toString", "formatString", "config", "printTypes", "f", "formatValue", "equals", "other", "exactEquals", "degrees", "v", "Math", "PI", "radians", "longitude", "latitude", "lng", "lat", "z", "set", "clone", "copy", "fromLngLatZ", "fromVector3", "length", "atan2", "acos", "clamp", "toVector3", "Vector3", "rotateX", "rotateZ", "makeSafe", "max", "min", "Number", "isFinite", "Error", "Vector2", "Vector", "constructor", "x", "y", "isArray", "arguments", "length", "copy", "config", "debug", "checkNumber", "set", "check", "array", "fromObject", "object", "toObject", "ELEMENTS", "horizontalAngle", "Math", "atan2", "verticalAngle", "transform", "matrix4", "transformAsPoint", "vec2", "transformMat4", "transformAsVector", "vec2_transformMat4AsVector", "transformByMatrix3", "matrix3", "transformMat3", "transformByMatrix2x3", "matrix2x3", "transformMat2d", "transformByMatrix2", "matrix2", "transformMat2", "ZERO", "Vector4", "Vector", "Object", "freeze", "constructor", "x", "y", "z", "w", "isArray", "arguments", "length", "copy", "config", "debug", "checkNumber", "set", "check", "array", "fromObject", "object", "toObject", "ELEMENTS", "value", "transform", "matrix4", "vec4", "transformMat4", "transformByMatrix3", "matrix3", "vec4_transformMat3", "transformByMatrix2", "matrix2", "vec4_transformMat2", "transformByQuaternion", "quaternion", "transformQuat", "applyMatrix4", "m", "create", "transpose", "invert", "determinant", "multiply", "translate", "rotate", "scale", "fromQuat", "INDICES", "IDENTITY_MATRIX", "Object", "freeze", "Matrix3", "Matrix", "IDENTITY", "getIdentityMatrix", "ZERO", "getZeroMatrix", "ELEMENTS", "RANK", "constructor", "array", "args", "arguments", "length", "Array", "isArray", "copy", "identity", "check", "fromObject", "object", "fromQuaternion", "q", "mat3", "fromQuat", "set", "m00", "m10", "m20", "m01", "m11", "m21", "m02", "m12", "m22", "setRowMajor", "determinant", "transpose", "invert", "multiplyLeft", "a", "multiply", "multiplyRight", "rotate", "radians", "scale", "factor", "translate", "vec", "transform", "vector", "result", "out", "transformMat3", "vec4_transformMat3", "Error", "checkVector", "transformVector", "transformVector2", "transformVector3", "ZERO_MATRIX3", "IDENTITY_MATRIX3", "create", "identity", "multiply", "rotateX", "rotateY", "rotateZ", "invert", "dot", "add", "scale", "dot", "lerp", "length", "squaredLength", "normalize", "create", "dot", "normalize", "IDENTITY_QUATERNION", "Quaternion", "MathArray", "constructor", "x", "y", "z", "w", "Array", "isArray", "arguments", "length", "copy", "set", "array", "check", "fromObject", "object", "fromMatrix3", "m", "quat", "fromMat3", "fromAxisRotation", "axis", "rad", "setAxisAngle", "identity", "ELEMENTS", "value", "checkNumber", "len", "lengthSquared", "squaredLength", "dot", "a", "rotationTo", "vectorA", "vectorB", "add", "calculateW", "conjugate", "invert", "lerp", "b", "t", "undefined", "multiplyRight", "multiply", "multiplyLeft", "normalize", "l", "rotateX", "rotateY", "rotateZ", "scale", "slerp", "arg0", "arg1", "arg2", "start", "target", "ratio", "transformVector4", "vector", "result", "Vector4", "vec4", "transformQuat", "checkVector", "lengthSq", "setFromAxisAngle", "premultiply", "RotationOrder", "EPSILON1", "EPSILON2", "EPSILON3", "EPSILON4", "EPSILON5", "EPSILON6", "EPSILON7", "EPSILON8", "EPSILON9", "EPSILON10", "EPSILON11", "EPSILON12", "EPSILON13", "EPSILON14", "EPSILON15", "EPSILON16", "EPSILON17", "EPSILON18", "EPSILON19", "EPSILON20", "PI_OVER_TWO", "Math", "PI", "PI_OVER_FOUR", "PI_OVER_SIX", "TWO_PI"]
}
